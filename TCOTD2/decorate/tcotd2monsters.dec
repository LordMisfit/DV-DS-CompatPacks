ACTOR ApprenticeNew : ApprenticeofDsparil replaces ApprenticeofDsparil 30000
{
  //$Angled
  //$Color 12
  //$Category "TCOTD:A Monsters/Raven Style"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel; var int user_legendaryevolved;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; var int user_canusecrisisatk; // For checking if a monster has been given Skill/Map inventory items yet.
  Health 1250
  DamageFactor "Normal", 0.334
  DamageFactor "Magic", 0.334
  OBITUARY "%o was spooked by an Apprentice of Darkmoon."

  PainChance 100
  Painchance "Fist", 150 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 250 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 150 // Fist attacks have a +50% chance of stunning an enemy

  states
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    APDP A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    APDP AB 10 A_Look
    goto Spawn+1
  See:
    APDP A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
    APDP A 0 A_SetTranslucent(1,0)
    APDP AABB 3
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(2); }
	 A_Chase;
	}
    Loop
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    APDP C 2 A_SetTranslucent(0.5,0)
    APDP C 2 A_SetTranslucent(1.0,0)
    APDP C 2 A_SetTranslucent(0.5,0)
    APDP C 2 A_SetTranslucent(1.0,0)
    APDP C 2 A_SetTranslucent(0.5,0)
    APDP C 2 A_SetTranslucent(1.0,0)
    APDP C 2 A_SetTranslucent(0.5,0)
    APDP C 2 A_SetTranslucent(1.0,0)
    APDP C 0 A_Jump(128,"Missile2")
    APDP C 0 A_Jump(64,"Missile3")
    APDP D 6
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(5); }
	 A_FaceTarget;
	 A_PlaySound("wizard/attack");
     A_CustomMissile("FireBlast",30,-10,-4);
     A_CustomMissile("FireBlast",30,0,0);
     A_CustomMissile("FireBlast",30,10,4);
    }
    Goto See
  Missile2:
    APDP D 1 A_SetTranslucent(0.9,0)
    APDP D 1 A_SetTranslucent(0.8,0)
    APDP D 1 A_SetTranslucent(0.7,0)
    APDP D 1 A_SetTranslucent(0.6,0)
    APDP D 1 A_SetTranslucent(0.5,0)
    APDP D 1 A_SetTranslucent(0.4,0)
    APDP D 1 A_SetTranslucent(0.3,0)
    APDP D 1 A_SetTranslucent(0.2,0)
    APDP D 1 A_SetTranslucent(0.1,0)
    APDP D 1 A_SetTranslucent(0.01,0)
    APDP D 0 A_SetInvulnerable
    APDP DDDDDDDDDDDDDDDD 2 A_Wander
    APDP D 6
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(5); }
	 A_FaceTarget;
	 A_PlaySound("wizard/attack");
     A_CustomMissile("FireBlast",30,-10,-4);
     A_CustomMissile("FireBlast",30,0,0);
     A_CustomMissile("FireBlast",30,10,4);
    }
    APDP DDDDDDDDDDDDDDDD 2 A_Wander
    APDP D 6
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(5); }
	 A_FaceTarget;
	 A_PlaySound("wizard/attack");
     A_CustomMissile("FireBlast",30,-10,-4);
     A_CustomMissile("FireBlast",30,0,0);
     A_CustomMissile("FireBlast",30,10,4);
    }
    APDP DDDDDDDDDDDDDDDD 2 A_Wander
    APDP D 6
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(5); }
	 A_FaceTarget;
	 A_PlaySound("wizard/attack");
     A_CustomMissile("FireBlast",30,-10,-4);
     A_CustomMissile("FireBlast",30,0,0);
     A_CustomMissile("FireBlast",30,10,4);
    }
    APDP DDDDDDDDDDDDDDDD 2 A_Wander
    APDP D 6
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(5); }
	 A_FaceTarget;
	 A_PlaySound("wizard/attack");
     A_CustomMissile("FireBlast",30,-10,-4);
     A_CustomMissile("FireBlast",30,0,0);
     A_CustomMissile("FireBlast",30,10,4);
    }
    APDP DDDDDDDDDDDDDDDD 2 A_Wander
    APDP D 1 A_SetTranslucent(0.1,0)
    APDP D 1 A_SetTranslucent(0.2,0)
    APDP D 1 A_SetTranslucent(0.3,0)
    APDP D 1 A_SetTranslucent(0.4,0)
    APDP D 1 A_SetTranslucent(0.5,0)
    APDP D 1 A_SetTranslucent(0.6,0)
    APDP D 1 A_SetTranslucent(0.7,0)
    APDP D 1 A_SetTranslucent(0.8,0)
    APDP D 1 A_SetTranslucent(0.9,0)
    APDP D 1 A_UnsetInvulnerable
    APDP D 1 A_SetTranslucent(1.0,0)
    Goto See
  Missile3:
    APDP C 0 A_FaceTarget
    APDP C 0 A_PlaySound("wizard/attack")
    APDP D 4 A_CustomMissile("SuperFireBlast",15,0,0)
    Goto See
  Pain:
    APDP E 0 A_SetTranslucent(1,0)
    APDP E 2
    APDP E 2 A_Pain
    Goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    APDP E 0 A_SetTranslucent(1,0)
    APDP E 4
    APDP F 4
    APDP G 3 A_Scream
    APDP H 3 A_CustomMissile("AoDGhost",8,0,0)
    APDP I 3 A_Fall
    APDP JKL 2
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    APDP M -1
    Stop
  Raise:
    APDP M 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    APDP L 8 
    APDP KJI 6 
    Goto See
  XDeath:
    goto Death
  }
}


ACTOR MiniSpiderNew : MiniSpider replaces MiniSpider 22290
{
  //$Angled
  //$Color 12
  //$Category "TCOTD:A Monsters/Blood Style"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel; var int user_legendaryevolved;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; var int user_canusecrisisatk; // For checking if a monster has been given Skill/Map inventory items yet.
  health 38 // 15
  
  States
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    MNTR A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    MNTR AB 10 A_Look
    goto Spawn+1
  See:
    MNTR A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
    MNTR ABCD 4
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_SetTics(3); }
	 A_Chase;
	}
    Loop
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    MNTR VW 5 A_FaceTarget
    MNTR X 5 A_MeleeAttack
    Goto See

  Pain:
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  XDeath:
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    MNTS F 5
    MNTS E 5 A_Scream
    MNTS D 5
    MNTS C 5 A_NoBlocking
    MNTS B 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    MNTS A -1 A_BossDeath
    Stop
  }
}

ACTOR LargeSpiderNew : LargeSpider replaces LargeSpider 22291
{
  //$Angled
  //$Color 12
  //$Category "TCOTD:A Monsters/Blood Style"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel; var int user_legendaryevolved;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; var int user_canusecrisisatk; // For checking if a monster has been given Skill/Map inventory items yet.
  Health 525 // 150
  DamageFactor "Normal", 0.75

  States
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    MNTR A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    MNTR AB 10 A_Look
    goto Spawn+1
  See:
    MNTR A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
    MNTR ABCD 4
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_SetTics(3); }
	 A_Chase;
	}
    Loop
  Missile:
    MNTR A 10 A_FaceTarget
    MNTR A 0 A_SkullAttack
    MNTR ABCD 2
    Goto Missile+2
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    MNTR VW 5 A_FaceTarget
    MNTR X 5 A_MeleeAttack
    Goto See

  Pain:
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    MNTS F 5
    MNTS E 5 A_Scream
    MNTS D 5
    MNTS C 5 A_NoBlocking
    MNTS B 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    MNTS A -1 A_BossDeath
    Stop
  }
}

ACTOR TommyGunCultistNew : ShotgunCultist replaces ShotgunCultist 29011
{
  //$Angled
  //$Color 12
  //$Category "TCOTD:A Monsters/Blood Style"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel; var int user_legendaryevolved;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; var int user_canusecrisisatk; // For checking if a monster has been given Skill/Map inventory items yet.
  var int user_pelletsfired; var int user_currenttracer;
  var float user_shotaccuracy; var float user_shotaccuracy1; var float user_shotaccuracy2;
  var float user_shotzaccuracy; var float user_shotzaccuracy1; var float user_shotzaccuracy2;

  health 125 // 40,60,80,100,125
  painchance 170
  PainChance "Shock", 255
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy
  obituary "%o was made hole-y by a Fanatic"

  states
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:  
    XFAN G 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
	XFAN G 5 A_Look
    goto Spawn+1
	XFAN AAABBBCCCDDDFFFGGG 1 A_wander
	XFAN B 5 A_Look
    goto Spawn+1
  See:
    XFAN A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
    XFAN A 0 A_ChangeFlag("DROPOFF",random(0,1))
    XFAN AABBCCDDFF 1
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
	 A_Chase;
	}
    XFAN A 0 A_Jump(8,"Shout")
	loop
  Shout:
  	XFAN A 0 A_AlertMonsters(256)
  	XFAN A 0 A_PlaySound("fanatic/sight")
	Goto See
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    XFAN G 0 A_PlaySound("fanatic/attack", CHAN_WEAPON)
    XFAN GH 4 bright
	{
     A_FaceTarget;
	 if (ACS_NamedExecuteWithResult("CheckHitscanType") == 0)
	 {
	  A_SetUserVar("user_canusecrisisatk",0);
	  //if(health <= user_HPLowRange) { if(health <= user_HPCritRange) { A_SetUserVar("user_canusecrisisatk",1); } else { if (random(1,4) == 4) { A_SetUserVar("user_canusecrisisatk",1);	} } }
      //if(GetCVar("dvds_monstercrisisattacks") == 0) { A_SetUserVar("user_canusecrisisatk",0); }
	  if(user_canusecrisisatk == 1)
	  {
       A_PlaySound("crisisattack",6);
       A_PlaySound("crisisattack2",7);
       A_CustomBulletAttack(10, 5.6, 1, ((random(1,5)*3) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "BulletPuff2", 0, CBAF_NORANDOM);
	  }
	  else
	  {
	   A_CustomBulletAttack(10, 5.6, 1, random(1,5)*3, "BulletPuff2", 0, CBAF_NORANDOM);
	  }
	 }
	 else
	 {
	  A_SetUserVar("user_canusecrisisatk",0);
	  if(health <= user_HPLowRange) { if(health <= user_HPCritRange) { A_SetUserVar("user_canusecrisisatk",1); } else { if (random(1,4) == 4) { A_SetUserVar("user_canusecrisisatk",1);	} } }
      if(GetCVar("dvds_monstercrisisattacks") == 0) { A_SetUserVar("user_canusecrisisatk",0); }
	  if(user_canusecrisisatk == 1)
	  {
       A_PlaySound("crisisattack",6);
       A_PlaySound("crisisattack2",7);
       A_CustomMissile("ZombieBulletTracerCrisis", 32, 12, frandom(-5.0,5.0), CMF_OFFSETPITCH, frandom(-2.8,2.8));
	  }
	  else
	  {
       A_CustomMissile("ZombieBulletTracer", 32, 12, frandom(-5.0,5.0), CMF_OFFSETPITCH, frandom(-2.8,2.8));
	  }
     }
	}
    XFAN H 1 A_FaceTarget
    XFAN E 0 A_SentinelRefire
    goto Missile

  Frightened:
    XFAN A 0 A_ChangeFlag("Frightened", 1)
    XFAN AABBCCDDEEFF 3 A_Chase
    loop
  Pain.Shock:
	7ZAP AAAAAAAAAAAAAAAAAAAAAAAA 1 A_SpawnItemEx("ShockHuman",random(-1,1),random(-1,1),random(0,3))
	7ZAP A 4 A_Pain
	7ZAP A 0 A_JumpIfHealthLower(20,2)
	7ZAP A 0 A_Jump(192,"See")
	7ZAP AAAAAAAAAAAAAAAAAAAAAAAA 1 A_SpawnItemEx("ShockHuman",random(-1,1),random(-1,1),random(0,3))
	Goto See
  Pain:
    XFAN I 3
    XFAN I 3 A_Pain
    goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    XFAN J 5 ThrustThingZ(0,10,0,0)
    XFAN K 5 A_Scream
    XFAN L 5 A_Fall
    XFAN MNO 5
    XFAN P 140
	XFAN Q 0 A_Jump(192,"Twitch")
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    XFAN Q -1
    stop
  Twitch:
    XFAN PQPQ 5
	XFAN P 70 A_Jump(80,"Twitch")
	XFAN Q 70 A_Jump(80,"Twitch")
	XFAN P 70 A_Jump(80,"Twitch")
	XFAN Q -1
	Stop
  Gib:
	XFAN J 5 ThrustThingZ(0,70,0,0)
	XFAN K 5 A_Scream 
	XFAN L 5 
	XFAN M 5 A_Fall
	XFAN N 5
	XFAN NO 5
    XFAN P 5 A_PLAYSOUND("PODDIE")
    XFAN P 0 
    //PZSS AAAAAAA 0 A_SpawnDebris("BLOODDEBRIS")
    PZSS P 0 A_Jump(92,2)
    //PZSS PPP 0 A_SpawnDebris ("BLOODEBRIS")
    PZSS P 0 A_Jump(92,2)
    //PZSS PP 0 A_SpawnDebris ("BLOODEBRIS")
    PZSS P 0 A_Jump(92,2)
    //PZSS PP 0 A_SpawnDebris ("BLOODEBRIS")
    PZSS PPPPPPPP 0 A_SpawnDebris("FlyingBlood")
    PZSS P 0
    PZSS Q 0
    PZSS RST 0
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    PZSS U -1
	Stop
  Raise:
    E12D N 0 A_UnHideThing
    E12D N 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    E12D GHNFD 5 
    goto See
  }
}

ACTOR ShotgunCultistNew : TommyGunCultistNew replaces ChainGunCultist 29010
{
  //$Angled
  //$Color 12
  //$Category "TCOTD:A Monsters/Blood Style"
  Health 125 // 40,60,80,100,125
  painchance 170
  PainChance "Shock", 255
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy

  states
  {
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    XFAN G 20
	{
	 A_FaceTarget;
	 A_SetUserVar("user_shotaccuracy",22.5);
	 A_SetUserVar("user_shotzaccuracy",0.0);
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(14); A_SetUserVar("user_shotaccuracy",((user_shotaccuracy*13)/19)); A_SetUserVar("user_shotzaccuracy",((user_shotzaccuracy*13)/19)); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 100) { A_SetTics(15); A_SetUserVar("user_shotaccuracy",((user_shotaccuracy*14)/19)); A_SetUserVar("user_shotzaccuracy",((user_shotzaccuracy*14)/19)); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 80) { A_SetTics(16); A_SetUserVar("user_shotaccuracy",((user_shotaccuracy*15)/19)); A_SetUserVar("user_shotzaccuracy",((user_shotzaccuracy*15)/19)); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_SetTics(17); A_SetUserVar("user_shotaccuracy",((user_shotaccuracy*16)/19)); A_SetUserVar("user_shotzaccuracy",((user_shotzaccuracy*16)/19)); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 40) { A_SetTics(18); A_SetUserVar("user_shotaccuracy",((user_shotaccuracy*17)/19)); A_SetUserVar("user_shotzaccuracy",((user_shotzaccuracy*17)/19)); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 20) { A_SetTics(19); A_SetUserVar("user_shotaccuracy",((user_shotaccuracy*18)/19)); A_SetUserVar("user_shotzaccuracy",((user_shotzaccuracy*18)/19)); }
	 A_SetUserVar("user_shotaccuracy1",user_shotaccuracy/-2); A_SetUserVar("user_shotaccuracy2",user_shotaccuracy/2);
	 A_SetUserVar("user_shotzaccuracy1",user_shotzaccuracy/-2); A_SetUserVar("user_shotzaccuracy2",user_shotzaccuracy/2);
	}
    XFAN H 10 BRIGHT 
	{
	 A_FaceTarget;
     A_PlaySound("shotguy/attack");
	 if (ACS_NamedExecuteWithResult("CheckShotgunnerSpreads") == 0) { A_SetUserVar("user_pelletsfired",3); } else { A_SetUserVar("user_pelletsfired",7); }

	 A_SetUserVar("user_canusecrisisatk",0);
	 if(user_canusecrisisatk == 1)
	 {
      A_PlaySound("crisisattack",6);
      A_PlaySound("crisisattack2",7);
	  if (ACS_NamedExecuteWithResult("CheckHitscanType") == 0) // Hitscan
	  {
	   A_CustomBulletAttack (user_shotaccuracy, user_shotzaccuracy, 3, ((random(1,5) * 3) * ACS_NamedExecuteWithResult("CrisisMultiplier")), "BulletPuff", 0, 1);
	  }
	  else
	  {
       for (A_SetUserVar(user_currenttracer, 0); user_currenttracer < user_pelletsfired; A_SetUserVar(user_currenttracer, user_currenttracer + 1))
       {
        A_CustomMissile("ZombieBulletTracerCrisis", 32, 12, frandom(user_shotaccuracy1,user_shotaccuracy2), CMF_OFFSETPITCH, frandom(user_shotzaccuracy1,user_shotzaccuracy2));       
       }	   
	  }
	 }
	 else
	 {
	  if (ACS_NamedExecuteWithResult("CheckHitscanType") == 0) // Hitscan
	  {
	   A_CustomBulletAttack (user_shotaccuracy, user_shotzaccuracy, 3, random(1,5) * 3, "BulletPuff", 0, 1);
	  }
	  else
	  {
       for (A_SetUserVar(user_currenttracer, 0); user_currenttracer < user_pelletsfired; A_SetUserVar(user_currenttracer, user_currenttracer + 1))
       {
        A_CustomMissile("ZombieBulletTracer", 32, 12, frandom(user_shotaccuracy1,user_shotaccuracy2), CMF_OFFSETPITCH, frandom(user_shotzaccuracy1,user_shotzaccuracy2));       
	   }	   
	  }
	 }
	}
    XFAN G 10
	{
	 A_FaceTarget;
	}
    Goto See
  }
}

ACTOR HellHoundNew : HotDog replaces HotDog 30121
{ 
  //$Angled
  //$Color 12
  //$Category "TCOTD:A Monsters/Blood Style"
  health 750
  DamageFactor "Normal", 0.875
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel; var int user_legendaryevolved;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; var int user_canusecrisisatk; // For checking if a monster has been given Skill/Map inventory items yet.

  PainChance 128
  Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 192 // Fist attacks have a +50% chance of stunning an enemy

  states 
  { 
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  ResetLevel:
    HDOG A 1 A_Look
    HDOG A 1 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    HDOG A 1 A_SetUserVar("user_ressurrectstr",user_ressurrectstr+random(10,20))
    HDOG A 1 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
	goto Spawn+1
  Spawn: 
    HDOG A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HDOG AA 10 A_Look 
    goto Spawn+1
  See: 
    HDOG A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
    HDOG AAAABBBBCCCCDDDDEEEEFFFF 1
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
	 A_Chase;
	}
    Loop 
  Melee: 
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    HDOG GH 6
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(5); }
	 A_FaceTarget;
	}
    HDOG I 6 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(5); }
	 A_FaceTarget;
	 A_MeleeAttack;
	}
    Goto See
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    HDOG G 0 A_JumpIfCloser(256,2)
    HDOG G 0
    Goto See
    HDOG G 10
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(6); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(7); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_SetTics(8); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 30) { A_SetTics(9); }
	 A_FaceTarget;
	}
    HDOG H 1 
	{
	 A_FaceTarget;
	 A_CustomMissile ("DogFire",28,0,0,0,0);
	}
    HDOG H 1 
	{
	 A_FaceTarget;
	 A_CustomMissile ("DogFire",28,0,0,0,0);
	}
    HDOG H 1 
	{
	 A_FaceTarget;
	 A_CustomMissile ("DogFire",28,0,0,0,0);
	}
    HDOG H 1 
	{
	 A_FaceTarget;
	 A_CustomMissile ("DogFire",28,0,0,0,0);
	}
    HDOG H 1 
	{
	 A_FaceTarget;
	 A_CustomMissile ("DogFire",28,0,0,0,0);
	}
    HDOG H 1 
	{
	 A_FaceTarget;
	 A_CustomMissile ("DogFire",28,0,0,0,0);
	}
    HDOG H 1 
	{
	 A_FaceTarget;
	 A_CustomMissile ("DogFire",28,0,0,0,0);
	}
    HDOG H 1 
	{
	 A_FaceTarget;
	 A_CustomMissile ("DogFire",28,0,0,0,0);
	}
    HDOG H 1 
	{
	 A_FaceTarget;
	 A_CustomMissile ("DogFire",28,0,0,0,0);
	}
    HDOG H 1 
	{
	 A_FaceTarget;
	 A_CustomMissile ("DogFire",28,0,0,0,0);
	}
    HDOG H 1 
	{
	 A_FaceTarget;
	 A_CustomMissile ("DogFire",28,0,0,0,0);
	}
    HDOG H 1 
	{
	 A_FaceTarget;
	 A_CustomMissile ("DogFire",28,0,0,0,0);
	}
    HDOG I 6 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(5); }
	 A_FaceTarget;
	}
    Goto See
  Pain: 
    HDOG J 2 
    HDOG J 2 A_Pain 
    Goto See 

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    HDOG K 8 
    HDOG L 8 A_Scream 
    HDOG M 4 
    HDOG N 4 A_NoBlocking 
    HDOG OP 4 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    HDOG Q -1 
    Stop 
  Raise: 
    HDOG Q 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HDOG PONMLK 5 
    Goto See 
  } 
}

// Magic Using Cultist
ACTOR ThrallNew : Thrall replaces Thrall 30119
{ 
  //$Angled
  //$Color 12
  //$Category "TCOTD:A Monsters/Raven Style"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel; var int user_legendaryevolved;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; var int user_canusecrisisatk; // For checking if a monster has been given Skill/Map inventory items yet.
  health 125 // 40,60,80,100,125
  DamageFactor "Magic", 0.75
  
  PainChance 200
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy

  states 
  { 
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn: 
    CULT A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CULT AB 10 A_Look 
    goto Spawn+1
  See: 
    CULT A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
    CULT AABBCCDD 2
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(1); }
	 A_Chase;
	}
    CULT A 0 A_Jump(8,"Shout")
	loop
  Shout:
  	CULT A 0 A_AlertMonsters(256)
  	CULT A 0 A_PlaySound("fanatic/sight")
	Goto See
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    CULT EE 5 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(3); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_SetTics(4); }
	 A_FaceTarget;
	}
    CULT F 8 BRIGHT 
	{
	 A_FaceTarget;
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(5); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 80) { A_SetTics(6); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 40) { A_SetTics(7); }
	 A_PlaySound("monster/culatk");
     A_CustomMissile("ThrallShot1",42,-6,0,1,0);
     A_CustomMissile("ThrallShot1",42,6,0,1,0);
	}
    Goto See
  Pain: 
    CULT G 2 
    CULT G 2 A_Pain 
    Goto See 

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    CULT H 8 
    CULT I 8 A_Scream 
    CULT J 4 
    CULT K 4 A_NoBlocking 
    CULT L 4 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    CULT M -1 
    Stop

  XDeath:
    Goto Death

  Raise: 
    CULT M 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CULT LKJHI 5
    Goto See 
   } 
}

ACTOR NightmareNew : KDiZDNightmare replaces KDiZDNightmare 26000
{
  //$Angled
  //$Color 12
  //$Category "TCOTD:A Monsters/Doom Style"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel; var int user_legendaryevolved;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; var int user_canusecrisisatk; // For checking if a monster has been given Skill/Map inventory items yet.
  health 175 // 100
  PainChance 144
  Painchance "Fist", 216 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 216 // Fist attacks have a +50% chance of stunning an enemy
  Radius 20
  Height 56
  Speed 15
  MONSTER 
  +FLOORCLIP
  +STEALTH
  RenderStyle Add
  Alpha 0.4
  SeeSound "nightmare/sight"
  PainSound "nightmare/pain"
  DeathSound "nightmare/death"
  ActiveSound "nightmare/active"
  MeleeSound "nightmare/melee"
  HitObituary "%o was tormented by a nightmare."
  MeleeDamage 4

  states
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    NMRE A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    NMRE AB 10 A_Look
    goto Spawn+1
  See:
    NMRE A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
    NMRE A 0 A_UnSetShootable
    NMRE AABBCCDD 3
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(2); }
	 A_Chase;
	}
    NMRE D 0 A_Jump(32,1)
    Loop
    NMRE D 0 A_CustomMissile("NightmareWisp",0,0,0) 
    Loop
  Melee:
    TNT1 A 0 
	{
	 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1); // makes a Stealth Monster become more visible
     A_SetShootable;
	}
    NMRE EF 9 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_SetTics(5); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 135) { A_SetTics(6); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(7); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 45) { A_SetTics(8); }
	 A_FaceTarget;
	}
    NMRE G 9 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_SetTics(5); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 135) { A_SetTics(6); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(7); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 45) { A_SetTics(8); }
	 A_FaceTarget;
	 A_MeleeAttack;
	}
    Goto See
  Pain:
    NMRE H 2 A_SetShootable
    NMRE H 10 A_Pain
    Goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    NMRE I 3 A_ScreamAndUnblock
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    NMRE JKLMNO 3 
    Stop
  }
}

ACTOR SirenNightmareNew : NightmareNew replaces SirenNightmare 31111
{
  //$Angled
  //$Color 12
  //$Category "TCOTD:A Monsters/Doom Style"
  health 525
  PainChance 48
  Painchance "Fist", 72 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 120 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 72 // Fist attacks have a +50% chance of stunning an enemy
  Radius 12 // 10
  Height 36 // 30
  Speed 30
  Scale 1.2
  MeleeDamage 40
  -FloorClip
  +ActivateMCross
  SEESOUND "nightmare2/sight"
  PAINSOUND "nightmare2/pain"
  DEATHSOUND "nightmare2/death"
  ACTIVESOUND "nightmare2/active"
  MELEESOUND "nightmare2/melee"
  HitObituary "%o should've heeded the sirens"
  states
  {
  See:
    NMRE A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
    NMRE A 0 A_UnSetShootable
    NMRE AABBCCDD 3
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_SetTics(2); }
	 A_Chase;
	}
    NMRE D 0 A_Jump(96,1)
    Loop
    NMRE D 0 A_CustomMissile("NightmareWisp",0,0,0) 
    Loop
  Melee:
    TNT1 A 0 
	{
	 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1); // makes a Stealth Monster become more visible
     A_SetShootable;
	}
    NMRE EF 9 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_SetTics(3); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(5); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(6); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_SetTics(7); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 30) { A_SetTics(8); }
	 A_FaceTarget;
	}
    NMRE G 9 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_SetTics(3); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(5); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(6); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_SetTics(7); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 30) { A_SetTics(8); }
	 A_FaceTarget;
	 A_MeleeAttack;
	}
    Goto See
  }

}

ACTOR VulgarShotNew
{
  var int user_random; var int user_ailment1; var int user_ailmentmaxchance;
  Radius 8
  Height 16
  Speed 10
  Damage 4
  RENDERSTYLE ADD
  ALPHA 0.67
  PROJECTILE
  //+THRUGHOST
  +HITMASTER
  Seesound "poly/stmdr1"
  DeathSound "weapons/bloodx"
  States
  {
  Spawn:
    FVUL AAABBB 1 Bright 
    loop
  Death:
    TNT1 A 0 Bright
	{
	 if (IsPointerEqual(AAPTR_MASTER, AAPTR_PLAYER1) == TRUE) 
	 {
	  A_SetUserVar("user_ailmentmaxchance",4);
	  if (CallACS("GetBuffTimer",7) > 0) { A_SetUserVar("user_ailmentmaxchance",user_ailmentmaxchance*4); }
	  if (CountInv("EvadeAnAttack",AAPTR_PLAYER1) > 0) { return state("Death2"); }
	  if (CountInv("InvulnerabilitySpell",AAPTR_PLAYER1) > 0) { return state("Death2"); }
	  if (random(1,user_ailmentmaxchance) <= 3)
	  {
	   ACS_NamedExecuteAlways("BuffTimer",0,8,16,random(140,210)); // Poison for 4-6 seconds [tics] (do not ignore God/Invuln/Mercy-Invuln)
	  }
	 }
	 return state("");
	}
  Death2:
    FVUL CDEF 4 Bright
    stop
  }
}

actor VulgarNew : Vulgar replaces Vulgar
{
  //$Angled
  //$Color 12
  //$Category "TCOTD:A Monsters/Doom Style"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel; var int user_legendaryevolved;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; var int user_canusecrisisatk; // For checking if a monster has been given Skill/Map inventory items yet.
  health 135 // 100
  
  painchance 120
  Painchance "Fist", 180 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 180 // Fist attacks have a +50% chance of stunning an enemy

  obituary "%o was poisoned by a vulgar."
  hitobituary "A Vulgar had %o for lunch."
  radius 20
  height 56
  mass 120
  speed 8
  MeleeDamage 4
  +DONTHURTSPECIES
  seesound "monster/vulsit"
  painsound "monster/vulpai"
  deathsound "monster/vuldth"
  activesound "monster/vulact"
  meleesound "monster/vulhit"
  DropItem "Heart" 128
  MONSTER
  +FLOORCLIP

  states
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    VULG A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    VULG AB 10 A_Look
    goto Spawn+1
  See:
    VULG A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
    VULG AABBCCDD 3
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(2); }
	 A_Chase;
	}
    loop
  Melee:
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    VULG E 8 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_SetTics(5); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(6); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_SetTics(7); }
	 A_FaceTarget;
	}
    VULG F 8
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_SetTics(5); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(6); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_SetTics(7); }
	 A_FaceTarget;
	 A_PlaySound("monster/vulswg");
	}
    VULG G 6 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(5); }
	 A_FaceTarget;
	 A_BasicAttack(4, "imp/melee", "VulgarShotNew", 37); // A_CustomMissile("VulgarShotNew",37,0,0,0,0);
	}
    goto See
  Pain:
    VULG H 2
    VULG H 2 A_Pain
    goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    VULG I 8
    VULG J 8 A_Scream
    VULG KL 6
    VULG M 6 A_NoBlocking
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    VULG N -1
    stop

  XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    VULG O 5
    VULG P 5 A_XScream
    VULG Q 5
    VULG R 5 A_NoBlocking
    VULG STU 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    VULG V -1
    stop
  Raise:
    VULG M 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    VULG L 8 
    VULG KJI 6 
    goto See
  }
}

Actor ClayDevilNew : ClayDevil replaces ClayDevil
{
  //$Angled
  //$Color 12
  //$Category "TCOTD:A Monsters/Others"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel; var int user_legendaryevolved;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; var int user_canusecrisisatk; // For checking if a monster has been given Skill/Map inventory items yet.
  var int user_autorestimer;
  
  painchance 48
  Painchance "Fist", 72 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 120 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 72 // Fist attacks have a +50% chance of stunning an enemy

  Mass 1250
  health 160 // Double Health
  DamageFactor "Normal", 0.5 // Double Resistance to most
  DamageFactor "Magic", 0.5 // Double Resistance to most
  DamageFactor "Fire", 2
  DamageFactor "Ice", 0.75
  DamageFactor "Thunder", 0.75
  DamageFactor "Shock", 0.75
  +NOTARGETSWITCH
  +AVOIDMELEE
  +NOTARGET
  +NOINFIGHTING
  +DONTMORPH
  +DONTSQUASH
  +NOICEDEATH
  +DONTGIB
  
  states
  {
  Pain.Charm: Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See
  Spawn:
    N00B A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    N00B A 0 Thing_ChangeTID(0,3334)
    N00B E 2 A_Look
    goto Spawn+1
  See:
    N00B A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
    N00B A 0 Thing_ChangeTID(0,3334)
    N00B A 0 Thing_Hate(0,1001,4)
    N00B AABBCCDD 2
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(1); }
	 A_ExtChase(256,128);
	}
    loop
  Missile:
    BYBR E 0 A_Jump(104,"Missile1","Missile2")
    goto see
  Missile1:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    N00B EF 3 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(2); }
	 A_FaceTarget;
	}
    N00B GH 3 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(2); }
	 A_FaceTarget;
	}
    N00B III 3 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(2); }
	 A_CustomMissile("ClayDevilMissile",32,0);
	 A_FaceTarget;
	}
    goto See
  Missile2:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    N00B EF 3
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(2); }
	 A_FaceTarget;
	}
    N00B GH 2
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(1); }
	 A_FaceTarget;
	}
    N00B I 3 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(2); }
	 A_CustomMissile("sonicfireball",32,0);
	 A_FaceTarget;
	}
    goto See

  Pain.Shock:
  Pain:
    N00B J 6 A_Pain
    goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death

  Death: // Clay Devils reconsitute themselves after a while like Death Incarnates [but without a way to 'Overkill' them, making them effectively immortal]
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,40,0,1) // Gives a flat base of 40 so you can't grind off of them very effectively.
    N00B K 5
    N00B K 5
    N00B L 4 A_Scream
    N00B MNO 5 A_CustomMissile("WHSMOKE",32,0)
    N00B P 4 A_NoBlocking
	N00B P 0 A_SetSolid // No "nesting" these guys to prevent respawns :V
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)

    N00B V 0
	{
	 if (random(1,256) <= 128) { A_SetUserVar("user_autorestimer",random(200,250)); }
	 else
	 {
	  if (random(1,256) <= 128) { A_SetUserVar("user_autorestimer",random(150,200)); }
	  else
	  {
	   if (random(1,256) <= 128) { A_SetUserVar("user_autorestimer",random(100,150)); }
	   else
	   {
	    A_SetUserVar("user_autorestimer",random(50,100));
	   }	   
	  }
	 }
	}
    N00B V 250 
	{
	 A_SetTics(user_autorestimer);
	}
  RegenCycle:
    N00B V 0 CanRaise Thing_Raise(0)       
    N00B V 5 
    loop

  DeathFireCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 
    goto Death.Fire+1
  Death.Fire: // Dying from Fire puts it down for a longer time, but it will still get up eventually
    TNT1 A 0 A_Jump(1, "DeathFireCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,40,0,1) // Gives a flat base of 40 so you can't grind off of them very effectively.
    N00B K 5
    N00B K 5
    N00B L 4 A_Scream
    N00B MNO 5 A_CustomMissile("WHSMOKE",32,0)
    N00B P 4 A_NoBlocking
	N00B P 0 A_SetSolid // No "nesting" these guys to prevent respawns :V
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)

    N00B V 0
	{
	 if (random(1,256) <= 128) { A_SetUserVar("user_autorestimer",random(600,750)); }
	 else
	 {
	  if (random(1,256) <= 128) { A_SetUserVar("user_autorestimer",random(450,600)); }
	  else
	  {
	   if (random(1,256) <= 128) { A_SetUserVar("user_autorestimer",random(300,450)); }
	   else
	   {
	    A_SetUserVar("user_autorestimer",random(150,300));
	   }	   
	  }
	 }
	}
    N00B V 750 
	{
	 A_SetTics(user_autorestimer);
	}
  RegenFireCycle:
    N00B V 0 CanRaise Thing_Raise(0)       
    N00B V 5 
    loop

  DeathFinalCheck:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 A_SpawnItemEx("TheOneRing",0,0,0,0,0,0,0,0,254)    
    TNT1 A 0 
    goto Death.Final+1
  Death.Final: // Dying and staying dead for good
    TNT1 A 0 A_Jump(1, "DeathFinalCheck")
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    N00B K 5
    N00B K 5
    N00B L 4 A_Scream
    N00B MNO 5 A_CustomMissile("WHSMOKE",32,0)
    N00B P 4 A_NoBlocking
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    N00B V -1
    stop
  Raise:
    TNT1 A 0 Thing_ChangeTID(0,3334)
    TNT1 A 0 A_SetUserVar("user_ressurrectstr",user_ressurrectstr+random(1,3))
    N00B V 0 A_Scream
    N00B V 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    N00B VPONMLK 4
    N00B K 0 Thing_Hate(0,1001,4)
    goto See
  }   
}

ACTOR ShadowNew : Shadow replaces Shadow 3126
{
  //$Angled
  //$Color 12
  //$Category "TCOTD:A Monsters/Doom Style"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel; var int user_legendaryevolved;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; var int user_canusecrisisatk; // For checking if a monster has been given Skill/Map inventory items yet.
  OBITUARY "%o was assassinated by a shadow."
  Health 750

  PainChance 200
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy

  states
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  ResetLevel:
    TROX A 1 A_Look
    TROX A 1 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    TROX A 1 A_SetUserVar("user_ressurrectstr",user_ressurrectstr+random(10,20))
    TROX A 1 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
	goto Spawn+1
  Spawn:
    TROX A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
  See:
    TROX A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
	TROX A 15
    TROX AAA 1
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
	 A_Chase;
	}
	TROX A 0 A_CustomMissile("ShadowGhostA", 0, 0, 0)
	TROX BBB 1
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
	 A_Chase;
	}
	TROX B 0 A_CustomMissile("ShadowGhostB", 0, 0, 0)
	TROX CCC 1
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
	 A_Chase;
	}
	TROX C 0 A_CustomMissile("ShadowGhostC", 0, 0, 0)
	TROX DDD 1
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
	 A_Chase;
	}
	TROX D 0 A_CustomMissile("ShadowGhostD", 0, 0, 0)
    TROX AAA 1
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
	 A_Chase;
	}
	TROX A 0 A_CustomMissile("ShadowGhostA", 0, 0, 0)
	TROX BBB 1
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
	 A_Chase;
	}
	TROX B 0 A_CustomMissile("ShadowGhostB", 0, 0, 0)
	TROX CCC 1
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
	 A_Chase;
	}
	TROX C 0 A_CustomMissile("ShadowGhostC", 0, 0, 0)
	TROX DDD 1
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
	 A_Chase;
	}
	TROX D 0 A_CustomMissile("ShadowGhostD", 0, 0, 0)
	Goto See+2
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
	SHDW E 12 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_SetTics(8); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 135) { A_SetTics(9); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(10); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 45) { A_SetTics(11); }
	 A_FaceTarget;
	}
	SHDW F 0 A_SpidRefire
  MissileFire:
	SHDW F 5
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_SetTics(3); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(4); }
	}
	SHDW G 5 BRIGHT
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_SetTics(3); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(4); }
	 A_MissileAttack;
	}
	SHDW F 5
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_SetTics(3); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(4); }
	}
	SHDW E 20
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_SetTics(12); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 157) { A_SetTics(13); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 135) { A_SetTics(14); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 112) { A_SetTics(15); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(16); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 67) { A_SetTics(17); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 45) { A_SetTics(18); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 22) { A_SetTics(19); }
	 A_FaceTarget;
	}
	SHDW E 1
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(0); }
	}
	SHDW E 0 A_SpidRefire
	Goto Missile+1      
  Pain:
	TROX H 4
	TROX H 4 A_Pain
	Goto See+2

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
	TROX I 6 A_Scream
	TROX J 5
	TROX K 5 A_CustomMissile("Shadowtorso", 0, 0, 0)
	TROX L 5 A_Fall
	TROX MNO 6 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
	TROX P -1
	Stop

  XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
	TROX W 5
	TROX X 4 A_XScream
	TROX Y 4 
	TROX Z 4 A_Fall
 	TROX ] 4
 	TROX [ 4
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
	TROX \ -1
	Stop

  Raise:
	TROX M 8 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
	TROX KLJI 8 
	Goto See
  }
}

ACTOR SoulHarvesterNew : SoulHarvester replaces SoulHarvester 3117
{
  //$Angled
  //$Color 12
  //$Category "TCOTD:A Monsters/Doom Style"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel; var int user_legendaryevolved;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; var int user_canusecrisisatk; // For checking if a monster has been given Skill/Map inventory items yet.
  Health 175 // 120

  PainChance 120
  Painchance "Fist", 180 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 180 // Fist attacks have a +50% chance of stunning an enemy

  states
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    SLHV A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SLHV AB 10 A_Look
    goto Spawn+1
  See:
    SLHV A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
    SLHV AABBCCDD 3
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(2); }
	 A_Chase;
	}
    Loop
  Melee:
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    SLHV EFG 4
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_SetTics(2); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(3); }
	 A_FaceTarget;
	}
    SLHV HIJK 5 BRIGHT
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(3); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(4); }
	 A_FaceTarget;
	}
    SLHV L 8 BRIGHT 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 135) { A_SetTics(5); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(6); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 45) { A_SetTics(7); }
	 A_FaceTarget;
	 A_MissileAttack;
	}
    SLHV M 10
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(6); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 112) { A_SetTics(7); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(8); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 37) { A_SetTics(9); }
	 A_FaceTarget;
	}
    Goto See
  Pain:
 	SLHV N 3
   	SLHV N 3 A_Pain
   	Goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SLHV O 7 A_Scream
    SLHV PQR 7 
    SLHV S 6 A_CustomMissile("SoulHarvesterGhost", 32, 0, 0)
    SLHV T 5 A_Fall
    SLHV UV 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SLHV W -1
    Stop

  XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    SLHV X 6 A_XScream
    SLHV Y 6 A_CustomMissile("SoulHarvesterGhost", 32, 0, 0)
    SLHV Z 6
    SLHV [ 6 A_Fall
    SLHV ] 6
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SLHW A -1
    Stop
  Raise:
    SLHV W 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SLHV VUTSRQPO 5 
    Goto See
  }
}

ACTOR ESoulNew : ESoul replaces ESoul 29012
{ 
  //$Angled
  //$Color 12
  //$Category "TCOTD:A Monsters/Doom Style"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel; var int user_legendaryevolved;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; var int user_canusecrisisatk; // For checking if a monster has been given Skill/Map inventory items yet.
  health 230 // 150
  DamageFactor "Holy", 1.75
  
  painchance 128
  Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 192 // Fist attacks have a +50% chance of stunning an enemy

  states
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    ETHS A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    ETHS ABCD 10 bright A_Look
    goto Spawn+1
  See:
    ETHS A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
    ETHS AABBCCDD 3 bright
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(2); }
	 A_Chase;
	}
    loop
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    ETHS C 0 bright A_Jump(128,"Missile2")
    ETHS C 6 bright 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(5); }
     A_FaceTarget;
	}
    ETHS EFEF 4 bright
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_SetTics(2); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(3); }
	 A_SkullAttack;
     A_FaceTarget;
	}
    goto See
  Missile2:
    ETHS P 3 bright
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_SetTics(1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(2); }
     A_FaceTarget;
	}
    ETHS Q 4 bright
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_SetTics(2); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(3); }
     A_FaceTarget;
	}
    ETHS R 5 bright 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_SetTics(5); }
     A_FaceTarget;
	 A_CustomMissile("ShadowBall", 0, 0, 0);
	}
    ETHS E 4 bright
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_SetTics(2); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(3); }
     A_FaceTarget;
	}
    goto See
  Pain:
    ETHS G 3 bright
    ETHS G 3 bright A_Pain
    goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    ETHS F 3 bright
    ETHS H 3 bright A_ScreamAndUnblock
    ETHS IJKLMNO 3 bright
    stop
  }
}

ACTOR DEWraithNew : DEWraith replaces DEWraith 30106
{ 
  //$Angled
  //$Color 12
  //$Category "TCOTD:A Monsters/Raven Style"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel; var int user_legendaryevolved;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; var int user_canusecrisisatk; // For checking if a monster has been given Skill/Map inventory items yet.
  Health 80 // 50
  DamageFactor "Holy", 1.75

  PainChance 64 
  Painchance "Fist", 96 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 160 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 96 // Fist attacks have a +50% chance of stunning an enemy

  states 
  { 
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn: 
    WRAI A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    WRAI AB 10 A_Look 
    goto Spawn+1
  See: 
    WRAI A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
    WRAI AABB 3 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(2); }
	 A_VileChase;
	}
    Loop 
  Missile: 
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    WRAI A 10
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(6); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(7); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_SetTics(8); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 30) { A_SetTics(9); }
	 A_FaceTarget;
	}
    WRAI B 4
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(2); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(3); }
	 A_SkullAttack;
	}
    WRAI AB 4 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(2); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(3); }
	 A_FaceTarget;
	}
    Goto Missile+2
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    WRAI A 5 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(3); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_SetTics(4); }
	 A_FaceTarget;
	}
    WRAI B 5 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(3); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_SetTics(4); }
	 A_FaceTarget;
	 A_MeleeAttack;
	}
    Goto See
  Heal:
    WRAI AB 3
    Goto Death 
  Pain: 
    WRAI A 3  
    WRAI A 3 A_Pain 
    Goto See 

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    WRAI E 4 A_NoBlocking
    WRAI F 5 A_Scream 
    WRAI GHIJ 4  
    Stop 
  } 
}

ACTOR ButcherZombieNew : Fatty replaces Fatty 25010
{
  //$Angled
  //$Color 12
  //$Category "TCOTD:A Monsters/Blood Style"
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel; var int user_legendaryevolved;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; var int user_canusecrisisatk; // For checking if a monster has been given Skill/Map inventory items yet.
  Health 1090 // 308,436,630,850,1090
  DamageFactor "Normal", 0.75
  DamageFactor "Fire", 2
  DamageFactor "Holy", 1.5
  
  painchance 96
  Painchance "Fist", 144 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 240 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 144 // Fist attacks have a +50% chance of stunning an enemy

  states
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    E15W A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    E15W A 10 A_Look
    goto Spawn+1
  See:
    E15W A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
    E15W AAAAAABBBBBBCCCCCCDDDDDDEEEEEEFFFFFF 1
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
	 A_Chase;
	}
    TNT1 A 0 A_Jump(100,"See2")
    loop
  See2:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
    E15W A 3 A_Chase
    E15W A 3 A_ExtChase(0,0,0,0)
    E15W A 3 A_Chase
    E15W A 2 A_ExtChase(0,0,0,0)
    E15W A 2 A_Chase
    E15W A 2 A_ExtChase(0,0,0,0)
    E15W B 2 A_Chase
    E15W B 3 A_ExtChase(0,0,0,0)
    TNT1 A 0
    TNT1 A 0 A_Jump(100,"See")
    loop
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    E15A B 6
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(5); }
	 A_SkelWhoosh;
	 A_FaceTarget;
	}
    E15A C 6
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(5); }
	 A_FaceTarget;
	}
    E15A D 6 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(5); }
	 A_FaceTarget;
	 A_SkelFist;
	}
    E15A EF 6
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(5); }
	 A_FaceTarget;
	}
    goto See
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    BYBR E 0 A_Jump(75,"Missile1")
    BYBR E 0 A_Jump(150,"Missile2")
    goto see
  Missile1:
    E15A G 0 A_JumpIfCloser(320, 9)
    E15A B 6 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(5); }
	 A_SkelWhoosh;
	 A_FaceTarget;
	}
    E15A CDEF 6
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(5); }
	 A_FaceTarget;
	}
    E15A I 0 A_CustomMissile ("Cleaver",30,7,0,1,0)
    goto See
  Missile2:
    E15W J 0 A_FaceTarget
    E15A GH 6
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(5); }
	 A_FaceTarget;
	}
    E15A I 6 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(4); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(5); }
	 A_FaceTarget;
	 A_CustomMissile ("butcherbarf",30,0,0,1,0);
	}
    E15A JIH 5 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(3); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_SetTics(4); }
	 A_FaceTarget;
	}
    goto See
  Pain:
    E15A A 3
    E15A A 6 A_Pain
    E15A A 3
    goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    E15D A 7
    E15D B 7
    E15D C 7 A_Scream
    E15D D 7 A_NoBlocking
    E15D D 2  A_playsound("DSTHUUD")
    E15D EFFFFFFFF 7
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    E15D G -1
    stop
  Death1:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    BBT2 M 7 A_Scream
    BBT2 L 0 A_Fall
    BBT2 M 5 A_XScream
    BBT2 LLLL 0 A_SpawnDebris ("OrganDebris")
    BBT2 LLL 0 A_SpawnDebris ("Bloodliver")
    BBT2 L 0 A_SpawnDebris ("Hand1")
	BBT2 L 0 A_SpawnItemEx("EyeGuts",random(-8,8),random(-8,8),random(random(0,16),random(32,48)),random(-3,3),random(-2,2),random(-2,2))
    BBT2 M 5 A_SpawnItemEx("FlyingBlood",random(-8,8),random(-8,8),random(random(0,16),random(32,48)),random(-3,3),random(-2,2),random(-2,2))
    BBT2 N 5 A_SpawnItemEx("FlyingBlood",random(-8,8),random(-8,8),random(random(0,16),random(32,48)),random(-3,3),random(-2,2),random(-2,2))
    BBT2 O 5  A_playsound("DSTHUUD")
    BBT2 PQRSTUV 5 A_SpawnItemEx("FlyingBlood",random(-8,8),random(-8,8),random(random(0,4),random(16,32)),random(-2,2),random(-2,2),random(-2,2))
    BBT2 VWVWVWVWVVWVWVWVWVVWVWVWVWVVWVWVWVWV 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BBT2 W -1
    Stop
  Raise:
    E15D G 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    E15D FDCBA 5 
    goto See

  XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    E15X A 6 A_Scream
    E15X B 5 A_Fall
    E15X CDEF 4
    E15X G 25
    E15X HIJK 6
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    E15X L -1
    Stop
  PAIN.Shock:
	7ZAP AAAAAAAAAAAAAAAAAAAAAAAA 1 A_SpawnItemEx("ShockHuman",random(-1,1),random(-1,1),random(0,3))
	7ZAP A 4 A_Pain
	7ZAP A 0 A_JumpIfHealthLower(20,2)
	7ZAP A 0 A_Jump(192,"See")
	7ZAP AAAAAAAAAAAAAAAAAAAAAAAA 1 A_SpawnItemEx("ShockHuman",random(-1,1),random(-1,1),random(0,3))
	Goto See
  }
}

actor BloodZombieNew : ZombieBlood replaces ZombieBlood 31002
{
  //$Angled
  //$Color 12
  //$Category "TCOTD:A Monsters/Blood Style"
  obituary "A zombie 'axed' %o a question. :V"

  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel; var int user_legendaryevolved;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; var int user_canusecrisisatk; // For checking if a monster has been given Skill/Map inventory items yet.

  Health 220 // 68,90,130,170,220
  DamageFactor "Normal", 0.75
  DamageFactor "Fire", 2
  DamageFactor "Holy", 1.5

  painchance 40
  Painchance "Fist", 60 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 100 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 60 // Fist attacks have a +50% chance of stunning an enemy
  PainChance "SHOCK", 255

  states
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    BZUM A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BZUM A 10 A_Look
    goto Spawn+1
  See:
    AZUM A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
    AZUM AAABBBCCCDDDEEEFFF 1
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
	 A_Chase;
	}
    loop
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    BZUM AB 5 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(3); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_SetTics(4); }
	 A_FaceTarget;
	}
    BZUM CDE 4
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(2); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(3); }
	 A_FaceTarget;
	}
    BZUM F 4 
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(2); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(3); }
	 A_FaceTarget;
	 A_PlaySound("ZAXE");
	 A_MeleeAttack;
	}
    BZUM G 4
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(2); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(3); }
	 A_FaceTarget;
	}
    goto See

  PAIN.Shock:
	7ZAP AAAAAAAAAAAAAAAAAAAAAAAA 1 A_SpawnItemEx("ShockHuman",random(-1,1),random(-1,1),random(0,3))
	7ZAP A 4 A_Pain
	7ZAP A 0 A_JumpIfHealthLower(20,2)
	7ZAP A 0 A_Jump(192,"See")
	7ZAP AAAAAAAAAAAAAAAAAAAAAAAA 1 A_SpawnItemEx("ShockHuman",random(-1,1),random(-1,1),random(0,3))
	Goto See
  Pain:    
    AZUM G 0 A_Jump (120, 2)
    AZUM G 8 A_Pain    
    goto See
    AZUM H 0 A_Pain
    AZUM HIJKL 5
    AZUM N 0 A_UnSetShootable
    AZUM N 0 A_UnSetSolid
    AZUM L 180
    AZUM L 20 
    AZUM N 0 A_JumpIfCloser(140, 2) 
    AZUM L 2 A_Jump (256, 2)
    AZUM L 2
    goto pain+11
    AZUM L 20 A_RadiusThrust(256,128,0)
    DOTD N 0 A_SetShootable
    DOTD N 0 A_SetSolid
    AZUM MNOPQR 5
    goto See

  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    AZUM H 0 A_JumpIfHealthLower (-12, 7)
    AZUM G 7 // A_SpawnItemEx ("",0,48,0,0,0,0,0,0,128)
    AZUM H 8 A_Scream
    AZUM I 4
    AZUM J 4 A_Fall
    AZUM K 4
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    AZUM L -1
    stop
    DOTD H 0 A_PlaySound("DSBDSPRY")
    TNT1 A 0 A_custommissile("callumzombiehead",4,0,random(-200,200),2,random(10,30))
    AZUM SSS 2 A_ThrowGrenade("FlyingBlood",5,5+random(-3,3),10+random(-4,4),0)
    AZUM T 2 A_ThrowGrenade("FlyingBlood",5,5+random(-3,3),10+random(-4,4),0)
    AZUM U 2 A_ThrowGrenade("FlyingBlood",0,5+random(-3,3),10+random(-4,4),0)
    AZUM H 0 A_Fall
    AZUM V 2 A_ThrowGrenade("FlyingBlood",-5,5+random(-3,3),10+random(-4,4),0)
    AZUM W 2 A_ThrowGrenade("FlyingBlood",-10,5+random(-3,3),10+random(-4,4),0)
    AZUM X 2 A_ThrowGrenade("FlyingBlood",-15,5+random(-3,3),10+random(-4,4),0)
    AZUM Y 2 A_ThrowGrenade("FlyingBlood",-20,5+random(-3,3),10+random(-4,4),0)
    AZUM H 0 A_PlaySound("DSBDSPRY")
    AZUM Z 2 A_ThrowGrenade("FlyingBlood",-20,5+random(-3,3),10+random(-4,4),0)
    AZUM H 0 A_PlaySound("DSBDSPRY")
    AZUM Z 2 A_ThrowGrenade("FlyingBlood",-20,5+random(-3,3),5+random(-4,4),0)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    AZUM Z -1
    stop
    AZUM I 0 A_JumpIfHealthLower (-75, 15)    
    AZUM I 0 A_Pain
    AZUM HIJK 5
    AZUM L 10
    DOTD N 0 A_SpawnItem("BloodZombieBodyDummy",0)
    stop
    DOTD I 0 A_JumpIfHealthLower (111, 2)
    DOTD N 0 A_SpawnItem("BloodZombieBodyDummy",0)
    stop
    DOTD I 0 A_JumpIfHealthLower (74, 2)
    DOTD N 0 A_SpawnItem("BloodZombieBodyDummy",0)
    stop
    DOTD I 0 A_JumpIfHealthLower (37, 2)
    DOTD N 0 A_SpawnItem("BloodZombieBodyDummy",0)
    stop
    //DOTD N 0 A_SpawnItemEX("BloodZombieBodyDummy",0,0,0,0,0,0,0,32)
    stop
    AZUM H 0 A_JumpIfHealthLower (-6, 7)
    AZUM H 8
    AZUM I 8 A_Scream
    AZUM J 4
    AZUM K 4 A_Fall
    AZUM L 4
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    AZUM L -1
    Stop

  XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    XZUM A 0 A_Scream
    XZUM A 6
    XZUM L 0 A_Fall
    XZUM BCDEFGH 3
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    XZUM I -1
    Stop

  Raise:
    AZUM M 5 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    AZUM NOPQR 5 
    goto See
  }
}

actor ThamuzApocalypseDefendMode : PowerProtection
{
 damagefactor "normal", 0.20 
 inventory.icon ""
 Powerup.Duration 2147483646
}

ACTOR ThamuzNew : Thamuz replaces Thamuz 7228
{
  //$Angled
  //$Color 12
  //$Category "TCOTD:A Monsters/Boss"
  Radius 40
  Height 110
  Bloodcolor "00 aa 00"
  Scale 1.1
  Health 32000
  DamageFactor "Normal", 0.375
  Mass 40000
  OBITUARY "%o fell before the might of Thamuz, the Dark God."

  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel; var int user_legendaryevolved;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; var int user_canusecrisisatk; // For checking if a monster has been given Skill/Map inventory items yet.
  var int user_barragecounter; var int user_shotsfired; var int user_shotsfiredmax;

  painchance 35
  Painchance "Fist", 52 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 87 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 52 // Fist attacks have a +50% chance of stunning an enemy

  states
  {
  Pain.Charm: Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See
  ResetLevel:
    DCYB A 1 A_Look
    DCYB A 1 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    DCYB A 1 A_SetUserVar("user_ressurrectstr",user_ressurrectstr+random(30,60))
    DCYB A 1 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
	goto Spawn+1
  Spawn:
    DCYB A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    DCYB A 10 A_Look
    goto Spawn+1
  See:
    DCYB A 0 Thing_ChangeTID(0,1222)
    DCYB A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
    DCYB AA 3
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(2); }
     A_SpawnItem("DarkCyberGhostA",0,0);
	 A_Chase;
	}
    DCYB BB 3
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(2); }
     A_SpawnItem("DarkCyberGhostB",0,0);
	 A_Chase;
	}
    DCYB CC 3
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(2); }
     A_SpawnItem("DarkCyberGhostC",0,0);
	 A_Chase;
	}
    DCYB DD 3
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(2); }
     A_SpawnItem("DarkCyberGhostD",0,0);
	 A_Chase;
	}
    Loop
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
	DCYB A 0 A_Jump(160,"ApocalypseAtk")	//160
    DCYB AEE 5
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(5); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 80) { A_SetTics(6); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 40) { A_SetTics(7); }
	 A_FaceTarget;
	}
    DCYB F 10
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(7); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 80) { A_SetTics(8); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 40) { A_SetTics(9); }
	 A_FaceTarget;
	 A_CustomMissile("DCBMiss1",56,-25,0);
	}
    DCYB E 15
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(9); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 125) { A_SetTics(10); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 100) { A_SetTics(11); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(12); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 50) { A_SetTics(13); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 25) { A_SetTics(14); }
	 A_FaceTarget;
	}
    Goto See
  ApocalypseAtk:
	DCYB A 0 A_Jump(160,"Barrage") //160
    DCYB G 20
 	{
	 A_GiveInventory("ThamuzApocalypseDefendMode",1); // A_SetInvulnerable
	 A_ChangeFlag("NOPAIN",TRUE);
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(14); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 100) { A_SetTics(15); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 80) { A_SetTics(16); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_SetTics(17); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 40) { A_SetTics(18); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 20) { A_SetTics(19); }
     A_PlaySound("Apocalypse/cast");
	 A_CustomMissile("DCBMiss3",50,0,0);
     A_CustomMissile("DCBMiss3",50,0,20);
     A_CustomMissile("DCBMiss3",50,0,40);
     A_CustomMissile("DCBMiss3",50,0,60);
     A_CustomMissile("DCBMiss3",50,0,80);
     A_CustomMissile("DCBMiss3",50,0,100);
     A_CustomMissile("DCBMiss3",50,0,120);
     A_CustomMissile("DCBMiss3",50,0,140);
     A_CustomMissile("DCBMiss3",50,0,160);
     A_CustomMissile("DCBMiss3",50,0,180);
     A_CustomMissile("DCBMiss3",50,0,200);
     A_CustomMissile("DCBMiss3",50,0,220);
     A_CustomMissile("DCBMiss3",50,0,240);
     A_CustomMissile("DCBMiss3",50,0,260);
     A_CustomMissile("DCBMiss3",50,0,280);
     A_CustomMissile("DCBMiss3",50,0,300);
     A_CustomMissile("DCBMiss3",50,0,320);
     A_CustomMissile("DCBMiss3",50,0,340);
    }
    DCYB G 10
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(7); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 80) { A_SetTics(8); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 40) { A_SetTics(9); }
	}
	DCYB G 0 A_Jump(64,5)
	DCYB G 0 A_Jump(64,8)
	DCYB GGGGGGGG 10
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(7); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 80) { A_SetTics(8); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 40) { A_SetTics(9); }
	}
	DCYB G 10
	{
	 A_ChangeFlag("NOPAIN",FALSE);
	 A_TakeInventory("ThamuzApocalypseDefendMode",9999); // A_UnsetInvulnerable
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(7); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 80) { A_SetTics(8); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 40) { A_SetTics(9); }
	}
    Goto See
  Barrage:
    DCYB AE 3
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(2); }
	 A_SetUserVar("user_barragecounter",0);
	 A_SetUserVar("user_shotsfired",0);
	 A_SetUserVar("user_shotsfiredmax",10+(user_monsterlevel/20));
	}
  BarrageStart:
    DCYB EF 4
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 210) { A_SetTics(2); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 105) { A_SetTics(3); }
	 A_FaceTarget;
	 A_SetUserVar("user_barragecounter",user_barragecounter+1);
	 if (user_barragecounter == 2) 
	 {
	  A_CustomMissile("DCBMiss2",56,-25,0); 
	  A_SetUserVar("user_barragecounter",0); 
      A_SetUserVar("user_shotsfired",user_shotsfired+1);
	 }
	}
    DCYB F 0
	{
	 if (user_shotsfired >= user_shotsfiredmax) { return state("See"); }
	 return state("");
	}
    loop

  Pain:
	DCYB A 0 A_TakeInventory("ThamuzApocalypseDefendMode",9999) // A_UnsetInvulnerable
    DCYB G 2
    DCYB G 2 A_Pain
    Goto See

  Pain.GravityHP:
    TNT1 A 0 A_Jump(248,2) // 1/32 chance of working
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    TNT1 A 0 
    Goto See
  Pain.GravityMP:
    TNT1 A 0 A_Jump(248,2) // 1/32 chance of working
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    TNT1 A 0 
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 A_Jump(248,2) // 1/32 chance of working
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    TNT1 A 0 
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    DCYB H 5
    DCYB I 5 A_Scream
    DCYB A 0 A_CustomMissile("BDS",0,0,0)
    DCYB JKLMNO 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    DCYB P -1 A_NoBlocking
    Stop
  }
}

Actor TchernobogNew : ThamuzNew replaces Tchernobog 7258
{
  //$Angled
  //$Color 12
  //$Category "TCOTD:A Monsters/Boss"
  Radius 40
  Height 110
  Health 21333
  DamageFactor "Normal", 0.25
  Mass 80000
  OBITUARY "%o fell before the might of The One That Binds."
  Bloodcolor "aa 00 00"
  states
  {
  Pain.Charm: Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See
  ResetLevel:
    TCHR A 1 A_Look
    TCHR A 1 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    TCHR A 1 A_SetUserVar("user_ressurrectstr",user_ressurrectstr+random(30,60))
    TCHR A 1 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
	goto Spawn+1
  Spawn:
    TCHR A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    TCHR A 10 A_Look
    goto Spawn+1
  See:
    TCHR A 0 Thing_ChangeTID(0,1222)
    TCHR A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,0)
    TCHR AA 3
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(2); }
     A_SpawnItem("TchernoGhostA",0,0);
	 A_Chase;
	}
    TCHR BB 3
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(2); }
     A_SpawnItem("TchernoGhostB",0,0);
	 A_Chase;
	}
    TCHR CC 3
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(2); }
     A_SpawnItem("TchernoGhostC",0,0);
	 A_Chase;
	}
    TCHR DD 3
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 180) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",1); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_ChangeFlag("MISSILEEVENMORE",1); A_ChangeFlag("MISSILEMORE",0); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("MISSILEMORE",1); A_ChangeFlag("MISSILEEVENMORE",0); }
	 else { A_ChangeFlag("MISSILEMORE",0); A_ChangeFlag("MISSILEEVENMORE",0); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_ChangeFlag("AVOIDMELEE",1); }
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(2); }
     A_SpawnItem("TchernoGhostD",0,0);
	 A_Chase;
	}
    Loop
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
	TCHR A 0 A_Jump(160,"ApocalypseAtk")	//160
    TCHR AEE 5
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(5); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 80) { A_SetTics(6); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 40) { A_SetTics(7); }
	 A_FaceTarget;
	}
    TCHR F 10
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(7); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 80) { A_SetTics(8); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 40) { A_SetTics(9); }
	 A_FaceTarget;
	 A_CustomMissile("DCBMiss1",56,-25,0);
	}
    TCHR E 15
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 150) { A_SetTics(9); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 125) { A_SetTics(10); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 100) { A_SetTics(11); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 75) { A_SetTics(12); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 50) { A_SetTics(13); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 25) { A_SetTics(14); }
	 A_FaceTarget;
	}
    Goto See
  ApocalypseAtk:
	TCHR A 0 A_Jump(160,"Barrage") //160
    TCHR G 20
 	{
	 A_GiveInventory("ThamuzApocalypseDefendMode",1); // A_SetInvulnerable
	 A_ChangeFlag("NOPAIN",TRUE);
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(14); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 100) { A_SetTics(15); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 80) { A_SetTics(16); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 60) { A_SetTics(17); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 40) { A_SetTics(18); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 20) { A_SetTics(19); }
     A_PlaySound("Apocalypse/cast");
	 A_CustomMissile("DCBMiss3",50,0,0);
     A_CustomMissile("DCBMiss3",50,0,20);
     A_CustomMissile("DCBMiss3",50,0,40);
     A_CustomMissile("DCBMiss3",50,0,60);
     A_CustomMissile("DCBMiss3",50,0,80);
     A_CustomMissile("DCBMiss3",50,0,100);
     A_CustomMissile("DCBMiss3",50,0,120);
     A_CustomMissile("DCBMiss3",50,0,140);
     A_CustomMissile("DCBMiss3",50,0,160);
     A_CustomMissile("DCBMiss3",50,0,180);
     A_CustomMissile("DCBMiss3",50,0,200);
     A_CustomMissile("DCBMiss3",50,0,220);
     A_CustomMissile("DCBMiss3",50,0,240);
     A_CustomMissile("DCBMiss3",50,0,260);
     A_CustomMissile("DCBMiss3",50,0,280);
     A_CustomMissile("DCBMiss3",50,0,300);
     A_CustomMissile("DCBMiss3",50,0,320);
     A_CustomMissile("DCBMiss3",50,0,340);
    }
	TCHR G 0 A_Jump(64,5)
	TCHR G 0 A_Jump(64,8)
	TCHR GGGGGGGG 10
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(7); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 80) { A_SetTics(8); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 40) { A_SetTics(9); }
	}
	TCHR G 10
	{
	 A_ChangeFlag("NOPAIN",FALSE);
	 A_TakeInventory("ThamuzApocalypseDefendMode",9999); // A_UnsetInvulnerable
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 120) { A_SetTics(7); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 80) { A_SetTics(8); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 40) { A_SetTics(9); }
	}
    Goto See
  Barrage:
    TCHR AE 3
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 90) { A_SetTics(2); }
	 A_SetUserVar("user_barragecounter",0);
	 A_SetUserVar("user_shotsfired",0);
	 A_SetUserVar("user_shotsfiredmax",10+(user_monsterlevel/20));
	}
  BarrageStart:
    TCHR FF 4
	{
     if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 210) { A_SetTics(2); }
     else if (GetCVar("dvds_monsterlevelbehavior") > 0 && user_monsterlevel > 105) { A_SetTics(3); }
	 A_FaceTarget;
	 A_SetUserVar("user_barragecounter",user_barragecounter+1);
	 if (user_barragecounter == 2) 
	 {
	  A_CustomMissile("DCBMiss2",56,0,0); 
	  A_SetUserVar("user_barragecounter",0); 
      A_SetUserVar("user_shotsfired",user_shotsfired+1);
	 }
	}
    TCHR F 0
	{
	 if (user_shotsfired >= user_shotsfiredmax) { return state("See"); }
	 return state("");
	}
    loop
  Pain:
	TCHR A 0 A_TakeInventory("ThamuzApocalypseDefendMode",9999) // A_UnsetInvulnerable
    TCHR G 2
    TCHR G 2 A_Pain
    Goto See

  Pain.GravityHP:
    TNT1 A 0 A_Jump(248,2) // 1/32 chance of working
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    TNT1 A 0 
    Goto See
  Pain.GravityMP:
    TNT1 A 0 A_Jump(248,2) // 1/32 chance of working
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    TNT1 A 0 
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 A_Jump(248,2) // 1/32 chance of working
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    TNT1 A 0 
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,-2,0,1)
    TCHR Q 5
    TCHR Q 5 A_Scream
    TCHR A 0 A_CustomMissile("BDS",0,0,0)
    TCHR QRSTUVWX 5
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    TNT1 A -1 A_NoBlocking
    Stop
  }
}


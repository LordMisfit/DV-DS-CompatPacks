actor BloodNonSolid : Blood
{
  -SOLID
  +CANNOTPUSH
}

// Items
actor RedBalloon replaces Balloon_Red 3112
{
  //$Angled
  //$Color 11
  //$Category "Happy Time Circus/Balloons"

  Radius 12
  Height 40
  HEALTH 2
  Mass 25
  +SHOOTABLE +NOGRAVITY +HEXENBOUNCE +PUSHABLE +FLOATBOB +SPAWNFLOAT
  +NOLIFTDROP +DONTOVERLAP +CANNOTPUSH +NOBLOCKMONST    
  PainSound "pop1"
  DeathSound "pop1"
  States
  {
  SpawnBlue:
    TNT1 A 0 A_SpawnItemEx("BlueBalloon",0,0,0,0,0,0,0,0,0,tid)
    TNT1 A 0 A_FadeOut(1.0)
    stop
  SpawnGreen:
    TNT1 A 0 A_SpawnItemEx("GreenBalloon",0,0,0,0,0,0,0,0,0,tid)
    TNT1 A 0 A_FadeOut(1.0)
    stop
  SpawnYellow:
    TNT1 A 0 A_SpawnItemEx("YellowBalloon",0,0,0,0,0,0,0,0,0,tid)
    TNT1 A 0 A_FadeOut(1.0)
    stop
  Spawn:
    TNT1 A 0 NoDelay A_Jump(16,"SpawnGreen","SpawnBlue","SpawnYellow")
    BOON A 4 A_Look
    goto Spawn+1
  See:
    BOON A 4 A_Chase
    Loop
  Pain:
    BOON A 4
    Goto See
  Drop:
    TNT1 A 0 A_DropItem("RuinousShield",1,1)
    goto Death+2
  Death:
    BOON B 2 A_Scream
    TNT1 A 0 A_Jump(192,"Drop")
    BOON C 2 A_Fall
    BOON D 2 A_CustomMissile("BSplatter", 40, 0, 0, 1)
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    BOON E 2
    BOON F 2
    BOON G 2
    Stop
  }
}
actor RedBalloon2 : RedBalloon replaces Balloon_Red2 3114
{
  //$Angled
  //$Color 11
  //$Category "Happy Time Circus/Balloons"

  +SHOOTABLE -NOGRAVITY -HEXENBOUNCE +PUSHABLE -FLOATBOB -SPAWNFLOAT
  -NOLIFTDROP -DONTOVERLAP +CANNOTPUSH +NOBLOCKMONST +CANPASS +DROPOFF
}

actor YellowBalloon replaces Balloon_Yellow 3113
{
  //$Angled
  //$Color 11
  //$Category "Happy Time Circus/Balloons"

  Radius 12
  Height 40
  HEALTH 2
  Mass 25
  +SHOOTABLE +NOGRAVITY +HEXENBOUNCE +PUSHABLE +FloatBob +SPAWNFLOAT 
  +NOLIFTDROP +NOBLOOD +DONTOVERLAP +CANNOTPUSH +NOBLOCKMONST     

  // Has a tiny chance to drop a weapon
  PainSound "pop1"
  DeathSound "pop1"
  States
  {
  SpawnRed:
    TNT1 A 0 A_SpawnItemEx("RedBalloon",0,0,0,0,0,0,0,0,0,tid)
    TNT1 A 0 A_FadeOut(1.0)
    stop
  SpawnBlue:
    TNT1 A 0 A_SpawnItemEx("BlueBalloon",0,0,0,0,0,0,0,0,0,tid)
    TNT1 A 0 A_FadeOut(1.0)
    stop
  SpawnGreen:
    TNT1 A 0 A_SpawnItemEx("GreenBalloon",0,0,0,0,0,0,0,0,0,tid)
    TNT1 A 0 A_FadeOut(1.0)
    stop
  Spawn:
    TNT1 A 0 NoDelay A_Jump(16,"SpawnGreen","SpawnBlue","SpawnRed")
    BNYL A 4 
    Loop
  See:
    BNYL A 4 
    Loop
  Pain:
    BNYL A 4
    Goto See
  Drop:
    BNYL B 0 A_DropItem("SauronGauntlets",1,1)
    BNYL B 0 A_DropItem("DiarisLongBow",1,1)
    BNYL B 0 A_DropItem("ImpClawCI",1,1)
    BNYL B 0 A_DropItem("DarkImpClawCI",1,1)
    BNYL B 0 A_DropItem("CacodemonEyeCI",1,1)
    BNYL B 0 A_DropItem("CacolanternEyeCI",1,1)
    BNYL B 0 A_DropItem("AbaddonEyeCI",1,1)
    BNYL B 0 A_DropItem("KnightFistCI",1,1)
    BNYL B 0 A_DropItem("BaronFistCI",1,1)
    BNYL B 0 A_DropItem("BelphegorFistCI",1,1)
    BNYL B 0 A_DropItem("BruiserFistCI",1,1)
    BNYL B 0 A_DropItem("ArchonFistCI",1,1)
    BNYL B 0 A_DropItem("PyroFistCI",1,1)
    BNYL B 0 A_DropItem("IncarnateSkullCI",1,1)
    BNYL B 0 A_DropItem("ArchvileHandCI",1,1)
    BNYL B 0 A_DropItem("DiabloistHandCI",1,1)
    BNYL B 0 A_DropItem("BalrogFistCI",1,1)
    BNYL B 0 A_DropItem("Chainsaw",1,1)
    BNYL B 0 A_DropItem("Pistol",1,1)
    BNYL B 0 A_DropItem("Shotgun",1,1)
    BNYL B 0 A_DropItem("SuperShotgun",1,1)
    BNYL B 0 A_DropItem("Chaingun",1,1)
    BNYL B 0 A_DropItem("RocketLauncher",1,1)
    BNYL B 0 A_DropItem("PlasmaRifle",1,1)
    BNYL B 0 A_DropItem("RepeaterChecker",1,1)
    BNYL B 0 A_DropItem("KaraSawaChecker",1,1)
    BNYL B 0 A_DropItem("BFG9000",1,1)
    goto Death+2
  Death:
    BNYL B 2 A_Scream
    BNYL B 0 A_Jump(48,"Drop")
    BNYL C 2 A_Fall
    BNYL DEF 2   
    Stop
  }
}

actor GreenBalloon replaces Balloon_Green 3116
{
  //$Angled
  //$Color 11
  //$Category "Happy Time Circus/Balloons"

  Radius 12
  Height 40
  HEALTH 2
  Mass 25
  +SHOOTABLE 
  +NOGRAVITY
  +HEXENBOUNCE
  +PUSHABLE 
  +FloatBob
  +SPAWNFLOAT 
  +NOLIFTDROP
  +NOBLOOD
  +DONTOVERLAP
  +CANNOTPUSH
  +NOBLOCKMONST 
  DropItem Clip 51
  DropItem Clip 10
  DropItem ClipBox 10
  DropItem ClipBox 2
  DropItem Shell 51
  DropItem Shell 10
  DropItem ShellBox 10
  DropItem ShellBox 2
  DropItem RocketAmmo 51
  DropItem RocketAmmo 10
  DropItem RocketBox 10
  DropItem RocketBox 2
  DropItem Cell 51
  DropItem Cell 10
  DropItem CellPack 10
  DropItem CellPack 2
  DropItem HealthBonus 40
  DropItem HealthBonus 8
  DropItem ArmorBonus 40
  DropItem ArmorBonus 8
  DropItem Berserk 1
  DropItem Medikit 5
  DropItem Medikit 1
  DropItem Stimpack 10
  DropItem Stimpack 2
  DropItem RandomPowerupSpawner 1
  DropItem DiarisLongBow 1
  DropItem DiarisArrow 1
  DropItem DiarisArrowQuiver 1
  DropItem FloraRandomArmor 32
  PainSound "pop1"
  DeathSound "pop1"
  States
  {
  SpawnRed:
    TNT1 A 0 A_SpawnItemEx("RedBalloon",0,0,0,0,0,0,0,0,0,tid)
    TNT1 A 0 A_FadeOut(1.0)
    stop
  SpawnBlue:
    TNT1 A 0 A_SpawnItemEx("BlueBalloon",0,0,0,0,0,0,0,0,0,tid)
    TNT1 A 0 A_FadeOut(1.0)
    stop
  SpawnYellow:
    TNT1 A 0 A_SpawnItemEx("YellowBalloon",0,0,0,0,0,0,0,0,0,tid)
    TNT1 A 0 A_FadeOut(1.0)
    stop
  Spawn:
    TNT1 A 0 NoDelay A_Jump(16,"SpawnBlue","SpawnYellow","SpawnRed")
    GBON A 4 
    goto Spawn+1
  See:
    GBON A 4 
    Loop
  Pain:
    GBON A 4
    Goto See
  Drop:
    GBON B 0 A_DropItem("RandomSeedDropForced",1,1)
    GBON B 0 A_DropItem("SeedOfLife",1,1)
    GBON B 0 A_DropItem("SeedOfMagic",1,1)
    GBON B 0 A_DropItem("SeedOfSkillForced",1,1)
    GBON B 0 A_DropItem("RandomPowerupSpawner",1,1)
    GBON B 0 A_DropItem("RandomArmorSpawner",1,1)
    goto Death+2
  Death:
    GBON B 0 A_Jump(48,"Drop")
    GBON B 2 A_Scream
    GBON C 2 A_Fall
    GBON DEFG 3   
    Stop
  }
}

actor BlueBalloon replaces Balloon_Blue 3193
{
  //$Angled
  //$Color 11
  //$Category "Happy Time Circus/Balloons"

  Radius 12
  Height 40
  HEALTH 2
  Mass 25
  +SHOOTABLE +NOGRAVITY +HEXENBOUNCE +PUSHABLE +FloatBob +SPAWNFLOAT 
  +NOLIFTDROP +NOBLOOD +DONTOVERLAP +CANNOTPUSH +NOBLOCKMONST 
  DropItem HealthBonus 64
  DropItem HealthBonus 64
  DropItem HealthBonus 64
  DropItem HealthBonus 64
  DropItem HealthBonus 64
  DropItem HealthBonus 64
  DropItem HealthBonus 64
  DropItem HealthBonus 64
  DropItem SoulSphere2 8
  DropItem MegaSphere2 8
  DropItem RandomArmorSpawner 8
  DropItem ArmorBonus 64
  DropItem ArmorBonus 64
  DropItem ArmorBonus 64
  DropItem ArmorBonus 64
  DropItem ArmorBonus 64
  DropItem ArmorBonus 64
  DropItem ArmorBonus 64
  DropItem ArmorBonus 64
  DropItem RandomSeedDropForced 8
  DropItem RandomSeedDropForced 8
  DropItem RandomSeedDropForced 8
  DropItem RandomSeedDropForced 8
  DropItem RandomSeedDropForced 8
  DropItem RandomSeedDropForced 8
  DropItem RandomSeedDropForced 8
  DropItem RandomSeedDropForced 8
  DropItem RandomPowerupSpawner 2
  DropItem RandomPowerupSpawner 2
  DropItem RandomPowerupSpawner 2
  DropItem RandomPowerupSpawner 2
  DropItem DiarisArrow 8
  DropItem DiarisArrowQuiver 8
  DropItem DiarisLongBow 4
  DropItem SauronHelmet 1
  DropItem FloraRandomArmor 160

  PainSound "pop1"
  DeathSound "pop1"
  States
  {
  SpawnRed:
    TNT1 A 0 A_SpawnItemEx("RedBalloon",0,0,0,0,0,0,0,0,0,tid)
    TNT1 A 0 A_FadeOut(1.0)
    stop
  SpawnGreen:
    TNT1 A 0 A_SpawnItemEx("GreenBalloon",0,0,0,0,0,0,0,0,0,tid)
    TNT1 A 0 A_FadeOut(1.0)
    stop
  SpawnYellow:
    TNT1 A 0 A_SpawnItemEx("YellowBalloon",0,0,0,0,0,0,0,0,0,tid)
    TNT1 A 0 A_FadeOut(1.0)
    stop
  Spawn:
    TNT1 A 0 NoDelay A_Jump(16,"SpawnGreen","SpawnYellow","SpawnRed")
    BLUB A 4 
    goto Spawn+1
  See:
    BLUB A 4 
    Loop
  Pain:
    BLUB A 4
    Goto See
  Death:
    BLUB B 2 A_Scream
    BLUB C 2 A_Fall
    BLUB DEF 3   
    Stop
  }
}

// Monsters

ACTOR GoreWormNew replaces GoreWorm 30031
{
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Monsters"

  Health 20
  Radius 8
  Height 4
  Speed 3
  Mass 20
  MONSTER 
  +FLOORCLIP +RANDOMIZE 
  scale 0.75
  MELEEDAMAGE 1
  SeeSound "HSEE"
  PainSound "HAND1"
  DeathSound ""
  ActiveSound "HAND1"
  MeleeSound "SKULBITE"
  Obituary "Um... how the hell did %o die?!" 

  PainChance 200
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy

  States
  {
  Spawn:
    WORM A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    WORM A 20 A_UnSetShootable
    WORM A 4 A_SetShootable
    WORM A 4 A_Look
    Goto Spawn+1
  See:   
    WORM A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    WORM ABCB 3 A_Wander
    WORM A 0 A_JumpIfHealthLower (6, 2)
    Loop
    WORM A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    WORM A 0 A_Jump (64,1)
    WORM ABCB 1 A_Wander
    Goto See 
  Melee:
    WORM C 0
    Goto Death
  Pain:
    WORM A 8 A_Pain 
    Goto See 
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    WORM A 5 A_CustomMissile("ZGut2", 0, 0, 30) 
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    WORM B 2 A_PlaySound("splat11")
    WORM B 2 A_TossGib
    WORM B 3 A_Scream 
    WORM C 2 A_TossGib
    WORM C 1 A_CustomMissile("BSplatter", 0, 0, 0, 1)
    WORM C 5 A_CustomMissile("ZGut3", 0, 0, -40)   
    Stop 
  }
}

ACTOR FluffyNew replaces Fluffy2 32120
{
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Monsters"

  dropitem DoomSpellMana2 192 125
  dropitem DoomSpellMana2 192 125
  dropitem GreenArmor 32
  dropitem BlueArmor 32
  dropitem HealthBonus 32
  dropitem HealthBonus 32
  dropitem HealthBonus 32
  dropitem HealthBonus 32
  dropitem HealthBonus 32
  dropitem ArmorBonus 32
  dropitem ArmorBonus 32
  dropitem ArmorBonus 32
  dropitem ArmorBonus 32
  dropitem ArmorBonus 32
  dropitem MaxHealthBonus 16
  dropitem MaxHealthBonus 16
  dropitem MaxHealthBonus 16
  dropitem MaxHealthBonus 16
  dropitem MaxHealthBonus 16
  dropitem RandomPowerupSpawner 1
  dropitem RandomPowerupSpawner 1
  dropitem FloraRandomArmor

  DamageFactor "Holy", 2
  DamageFactor "Magic", 1.25
  Painchance "Holy", 160
  Painchance "Magic", 100

  PainChance 80
  Painchance "Fist", 120 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 200 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 120 // Fist attacks have a +50% chance of stunning an enemy

  Health 1000
  Radius 25
  Height 56
  Speed 40
  Mass 250
  MONSTER
  +FLOORCLIP +NOCLIP
  +NOLIFTDROP
  MELEEDAMAGE 7
  SeeSound "BHIT1"
  PainSound "BHIT5"
  DeathSound "BTALK3"
  ActiveSound "BTALK7"
  MeleeSound "BCHOMP"
  HitObituary "%o was playing with Fluffy!"
  MissileHeight 12
  MissileType SkullSeeker
  States 
  {
  Spawn:
    FLUF A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    FLUF A 2 A_Look
    goto Spawn+1
  See:
    FLUF A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    FLUF ABCBJ 2 A_Chase
    FLUF KL 1   
    FLUF M 1 A_CustomMissile("ZGut", 0, 0, 0,0)
    FLUF M 1 A_PlaySound("SPLAT5")
    FLUF LK 1
    FLUF J 1 A_Jump(124,2) 
    GoTo See
    FLUF K 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    FLUF K 0  
    FLUF K 0 A_CustomMissile("JSkull_Image1", 0, 0, 0,1) 
    GoTo See
  Missile:   
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    FLUF A 0 A_Jump(124,8)
    FLUF A 0 A_Jump(156,2) 
    FLUF A 0 A_Jump(99,10)
    FLUF AB 4 A_FaceTarget 
    FLUF C 6 A_ComboAttack
    Goto See 
    FLUF AB 2 A_FaceTarget
    FLUF C 4 A_CustomMissile("SkullSeeker", 28, -4, 0, 1)
    Goto See 
    FLUF AB 2 A_FaceTarget
    FLUF C 2 A_CustomMissile("SkullSeeker", 28, -12, -60, 1)
    FLUF B 4 A_FaceTarget
    FLUF C 2 A_CustomMissile("SkullSeeker", 28, -4, 60, 1)
    Goto See 
    FLUF AB 2 A_FaceTarget
    FLUF C 4 A_CustomMissile("SkullSeeker", 28, 12, 0, 1)
    Goto See 
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    FLUF ABC 4  
    FLUF B  6 A_MeleeAttack
    Goto See
  Pain:
    FLUF C 2
    FLUF C 3 A_Pain
    Goto See 
  Pain.Holy:
    FLUF C 2
    FLUF C 3 A_Pain
    FLUF C 8
    Goto See 
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,1150,0,1)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    FLUF JKLMN 10 
    FLUF N 100 
    GoTo Raise
  Raise:
    FLUF M 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    FLUF MLKJ 10
    GoTo See
  Ice:
    goto Death
  }
}

ACTOR MiniFluffyNew replaces MiniFluffy 3194
{
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Monsters"

  dropitem DoomSpellMana2 24 125
  dropitem DoomSpellMana2 24 125
  dropitem GreenArmor 2
  dropitem BlueArmor 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem RandomPowerupSpawner 1
  dropitem FloraRandomArmor

  DamageFactor "Holy", 2
  DamageFactor "Magic", 1.25
  Painchance "Holy", 160
  Painchance "Magic", 100

  PainChance 80
  Painchance "Fist", 120 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 200 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 120 // Fist attacks have a +50% chance of stunning an enemy

  Health 60
  Radius 8
  Height 25
  Speed 6
  Mass 40
  MONSTER
  +FLOORCLIP
  MELEEDAMAGE 1
  SeeSound "BHIT1"
  PainSound "BHIT5"
  DeathSound "BTALK3"
  ActiveSound "BTALK7"
  MeleeSound "BCHOMP"
  HitObituary "%o was playing with Fluffy!"
  States 
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    RAIN B 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    RAIN B 5 A_Look
    goto Spawn+1
  See:
    SBUN H 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    SBUN HHHHIIIJJ 3
    SBUN ABCCB 1 A_Chase
    GoTo See + 11
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    SBUN ABC 4  
    SBUN B  6 A_MeleeAttack
    Goto See + 11
  Pain:
    SBUN D 8  A_Pain
    SBUN E 8 A_UnSetShootable
    SBUN F 100 
    SBUN F 0 A_Jump(128,3) 
    SBUN E 8 
    SBUN D 8 A_SetShootable
    Goto See + 11
    SBUN F 8 A_UnSetShootable
    SBUN F 100  
    SBUN E 8 A_SetShootable
    Goto See + 11
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,85,0,1)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    SBUN DEF 8 
    SBUN G -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,85,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    SBUN D 5 A_GenericFreezeDeath
    SBUN D 1 A_FreezeDeathChunks
    wait
  } 
}

ACTOR JumpingSkullNew replaces JumpingSkull 32121
{
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Monsters"

  dropitem DoomSpellMana1 16 50
  dropitem GreenArmor 2
  dropitem BlueArmor 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem RandomPowerupSpawner 1
  dropitem FloraRandomArmor

  DamageFactor "Holy", 2
  DamageFactor "Magic", 1.25
  Painchance "Holy", 180
  Painchance "Magic", 112

  PainChance 90
  Painchance "Fist", 135 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 225 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 135 // Fist attacks have a +50% chance of stunning an enemy

  Health 40
  Radius 8
  Height 20
  Speed 9
  Mass 20
  MONSTER 
  DropItem ClownSouls 10
  +FLOORCLIP +RANDOMIZE +COUNTKILL +CANPASS   
  MELEEDAMAGE 1
  MeleeRange 25
  SeeSound "LAUGH1"
  PainSound "SKULPN2"
  DeathSound "JDIE"
  ActiveSound "LAUGH1"
  MeleeSound "SKULBITE"
  HitObituary "%o was bitten by a bouncing skull."
  States
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    JSKL A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    JSKL A 4 A_Look
    goto Spawn+1
  See:
    JSKL A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    JSKL ABCB 2 A_Chase
    Loop
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    JSKL A 3 A_FaceTarget 
    JSKL B 3 A_FaceTarget 
    JSKL C 4 A_CustomMeleeAttack(random(2,6)*1,"SKULBITE","none")
    JSKL B 3 A_FaceTarget 
    Goto See
  Pain:
    JSKL B 4 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,75,0,1)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    JSKL A 5 A_Scream
    JSKL D 4 A_Fall
    JSKL D 4 A_TossGib
    JSKL D 0 A_TossGib
    JSKL D 0 A_TossGib
    JSKL D 0 A_TossGib
    JSKL D 0 A_TossGib
    JSKL E 8 A_CustomMissile("ZGut2", 0, 0, 30) 
    JSKL F 8 A_CustomMissile("ZGut3", 0, 0, -40) 
    JSKL G 8 A_CustomMissile("ZGut2", 0, 0, 90) 
    JSKL H 8 A_CustomMissile("ZGut3", 0, 0, 180) 
    JSKL I -1 
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,75,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    JSKL B 5 A_GenericFreezeDeath
    JSKL B 1 A_FreezeDeathChunks
    wait
  }
}
ACTOR JumpingSkull2New replaces JumpingSkull2 3646 //spawns skull ghosts
{
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Monsters"

  dropitem DoomSpellMana1 16 50
  dropitem GreenArmor 2
  dropitem BlueArmor 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem RandomPowerupSpawner 1
  dropitem FloraRandomArmor

  DamageFactor "Holy", 2
  DamageFactor "Magic", 1.25
  Painchance "Holy", 180
  Painchance "Magic", 112

  PainChance 70
  Painchance "Fist", 105 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 175 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 105 // Fist attacks have a +50% chance of stunning an enemy

  Health 40
  Speed 10
  Radius 8
  Height 32
  MELEEDAMAGE 1
  MeleeRange 22
  MeleeSound "BCHOMP"
  Scale 1.2
  MONSTER
  RENDERSTYLE Translucent
  ALPHA 0.67
  States
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    JSKL A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    JSKL A 4 A_Look
    goto Spawn+1
  See:
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    JSKL ABCB 2 A_Chase
    JSKL A 0 A_CustomMissile("PennywiseHead2",  8, 0, random(-180, 180), 2, random(0, 30))
    Loop
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    JSKL A 3 A_FaceTarget 
    JSKL B 3 A_FaceTarget 
    JSKL C 4 A_MeleeAttack
    JSKL B 3 A_FaceTarget 
    Goto See
  Pain:
    JSKL B 4 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,random(75,80),0,1)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    JSKL A 5 A_Scream
    JSKL D 4 A_Fall
    JSKL D 4 A_TossGib
    BBLD A 0 A_custommissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
    JSKL D 0 A_TossGib
    JSKL D 0 A_TossGib
    JSKL D 0 A_custommissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
    JSKL D 0 A_custommissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
    JSKL D 0 A_TossGib
    JSKL D 0 A_custommissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
    JSKL D 0 A_TossGib
    JSKL D 0 A_custommissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
    JSKL E 8 A_CustomMissile("ZGut2", 0, 0, 30) 
    JSKL F 8 A_CustomMissile("ZGut3", 0, 0, -40) 
    JSKL G 8 A_CustomMissile("ZGut2", 0, 0, 90) 
    JSKL H 8 A_CustomMissile("ZGut3", 0, 0, 180) 
    JSKL I -1 
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,random(75,80),0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    JSKL B 5 A_GenericFreezeDeath
    JSKL B 1 A_FreezeDeathChunks
    wait
  }
}

ACTOR PossessedBalloonNew replaces PossessedBalloon 3115
{
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Monsters"

  dropitem DoomSpellMana1 8 50
  dropitem GreenArmor 1
  dropitem BlueArmor 1
  dropitem HealthBonus 1
  dropitem HealthBonus 1
  dropitem ArmorBonus 1
  dropitem ArmorBonus 1
  dropitem MaxHealthBonus 1
  dropitem RandomPowerupSpawner 1
  dropitem FloraRandomArmor

  DamageFactor "Magic", 1.5
  Painchance "Magic", 75

  PainChance 50
  Painchance "Fist", 75 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 125 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 75 // Fist attacks have a +50% chance of stunning an enemy

  Health 15
  Radius 15
  Height 40
  Speed 2
  FloatSpeed 3
  Mass 20
  MONSTER 
  +LOOKALLAROUND
  +FLOORCLIP
  +NOGRAVITY
  +FLOAT
  +COUNTKILL
  +CANPASS
  +PUSHABLE
  +FloatBob
  MELEEDAMAGE 1
  MeleeRange 28
  SeeSound ""
  PainSound "BOONBITE"
  DeathSound ""
  ActiveSound "BLOONACT"
  MeleeSound "BOONBITE"
  HitObituary "%o wanted to float with all the pretty balloons."
  States
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    BSTN A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BSTN A 2 A_Look
    goto Spawn+1
  See:
    BSTN A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BSTN A 2 A_Chase
    Loop
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    BSTN BC 4
    BSTN D 4 A_CustomMeleeAttack(random(1,6)*1,"BOONBITE","none")
    BSTN CB 4 
    Goto See
  Pain:
    BSTN B 3 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,24,0,1)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BSTN B 3
    BSTN C 3 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BSTN D 3 A_Scream
    BSTN DDDDDD 0 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BSTN E 3 A_Fall
    BSTN EEEEE 0 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    TNT1 A 0 A_CustomMissile("BSplatter", 40, 0, 0, 1)
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    TNT1 A 0 A_SpawnItemEx("BloodNonSolid", 0, 0, 0, random(-8,8), random(-8,8), random(-8,8))
    BSTN F 3 A_custommissile("BalloonSoul", 28, 0, random(-180, 180), 2, random(-15, 80))
    BSTN GHIJKLM 3
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,24,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    BSTN B 5 A_GenericFreezeDeath
    BSTN B 1 A_FreezeDeathChunks
    wait
  }
}

ACTOR BingoNew replaces Bingo 4110
{ 
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Monsters"

  dropitem DoomSpellMana2 76 125
  dropitem GreenArmor 2
  dropitem BlueArmor 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem RandomPowerupSpawner 1
  dropitem RandomPowerupSpawner 1
  dropitem FloraRandomArmor

  DamageFactor "Holy", 2
  DamageFactor "Magic", 1.25
  Painchance "Holy", 255
  Painchance "Magic", 160

  PainChance 128
  Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 192 // Fist attacks have a +50% chance of stunning an enemy

  Health 400 
  Speed 5 
  Radius 18
  Height 56
  Mass 300
  Meleedamage 1 
  REACTIONTIME 8 
  MONSTER
  DropItem GasRocketLauncher 255
  DropItem ClownSouls 75
  +FLOORCLIP +NOGRAVITY +FLOAT +PUSHABLE +NORADIUSDMG 
  +FloatBob +SPAWNFLOAT 
  scale 0.85
  SeeSound "CHEDSEE"
  PainSound "REVN3"
  DeathSound ""
  ActiveSound "CHEDLAF"
  Obituary "%o got blasted by a freaky clown head." 
  MissileHeight 12
  MissileType RevRocket
  States 
  { 
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    CHED A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CHED A 10 A_Look 
    goto Spawn+1
  See: 
    CHED A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CHED A 2 A_PlaySound("DRONE")
    CHED A 2 A_CustomMissile("RFlame", -8, 0, 0, 1)  
    CHED A 2 A_FastChase
    CHED A 2 A_CustomMissile("RFlame", -8, 0, 0, 1)  
    CHED A 2 A_FastChase
    CHED A 2 A_CustomMissile("RFlame", -8, 0, 0, 1)  
    CHED A 2 A_Chase
    CHED A 2 A_CustomMissile("RFlame", -8, 0, 0, 1)  
    CHED A 2 A_Chase
    Goto See
  Missile:   
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    CHED A 0 A_Jump(104,9)
    CHED A 0 A_Jump(136,2) 
    CHED A 0 A_Jump(88,13)
    CHED A 4 A_FaceTarget 
    CHED A 6 Bright A_ComboAttack
    Goto See 
    CHED A 2 Bright A_FaceTarget
    CHED A 2 Bright A_CustomMissile("RevRocket", 12, -4, 0, 1)
    CHED A 4 
    Goto See 
    CHED A 2 Bright A_FaceTarget
    CHED A 2 Bright A_CustomMissile("RevRocket", 12, -12, -60, 1)
    CHED A 2 Bright A_FaceTarget
    CHED A 2 Bright A_CustomMissile("RevRocket", 12, -4, 60, 1)
    CHED A 4 
    Goto See 
    CHED A 4 Bright A_FaceTarget
    CHED A 2 Bright A_CustomMissile("RevRocket", 12, 12, 0, 1)
    CHED A 4 
    Goto See 
  Pain: 
    CHED A 4 A_Pain 
    Goto See 
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,500,0,1)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    CHED A 1 A_Scream 
    CHED B 6  A_NoBlocking 
    CHED CD 6
    CHED EFGHIJKL 4
    CHED M 4
    Stop 
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,500,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    CHED A 5 A_GenericFreezeDeath
    CHED A 1 A_FreezeDeathChunks
    wait
  } 
} 

ACTOR TinyBingoNew replaces TinyBingo 4179
{ 
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Monsters"

  dropitem DoomSpellMana1 76 50
  dropitem GreenArmor 4
  dropitem BlueArmor 4
  dropitem HealthBonus 4
  dropitem ArmorBonus 4
  dropitem MaxHealthBonus 1
  dropitem RandomPowerupSpawner 1
  dropitem FloraRandomArmor

  DamageFactor "Holy", 2
  DamageFactor "Magic", 1.25
  Painchance "Holy", 255
  Painchance "Magic", 160

  PainChance 128
  Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 192 // Fist attacks have a +50% chance of stunning an enemy

  Health 35 
  Speed 6 
  Radius 9
  Height 24
  Mass 300
  Meleedamage 1 
  REACTIONTIME 8 
  MONSTER
  DropItem ClownSouls 10
  +FLOORCLIP +NOGRAVITY +FLOAT +PUSHABLE 
  +FloatBob +SPAWNFLOAT 
  scale 0.35
  SeeSound "TINY2"
  PainSound "TINYPAIN"
  DeathSound "TINYDIE"
  ActiveSound "TINYACT"
  Obituary "%o got blasted by a freaky clown head." 
  MissileHeight 12
  MissileType MyBall
  States 
  { 
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    CHED A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CHED A 10 A_Look 
    goto Spawn+1
  See: 
    CHED A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CHED A 2 A_Chase
    Goto See
  Missile:   
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    CHED A 4 A_FaceTarget 
    CHED A 2 Bright A_CustomMissile("MyBall", 12, -4, 0, 1)
    CHED A 4 
    Goto See 
  Pain: 
    CHED A 4 A_Pain 
    Goto See 
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,52,0,1)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    CHED A 1 A_Scream 
    CHED B 6 A_NoBlocking 
    CHED CD 6
    CHED EFGHIJKL 4
    CHED M 4     
    Stop    
   Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,52,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    CHED A 5 A_GenericFreezeDeath
    CHED A 1 A_FreezeDeathChunks
    wait
  } 
} 

actor BeefyNew replaces Beefy 4333
{
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Monsters"

  dropitem DoomSpellMana1 24 50
  dropitem DoomSpellMana1 24 50
  dropitem GreenArmor 2
  dropitem BlueArmor 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem RandomPowerupSpawner 1
  dropitem FloraRandomArmor

  DamageFactor "Holy", 2
  DamageFactor "Magic", 1.25
  Painchance "Holy", 255
  Painchance "Magic", 250

  PainChance 200
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy

  Health 120
  Radius 20
  Height 56
  Speed 8
  MONSTER 
  DropItem ClownSouls 20
  +FLOORCLIP
  SeeSound "BEEFSEE"
  PainSound "GHS2PAN"
  DeathSound "GHS2PAN"
  ActiveSound "BEEFY"
  MeleeSound "imp/melee"
  Obituary "%o was killed by beefy the clown."
  HitObituary "%o was scratched by beefy the clown."
  MissileHeight 32
  MissileType MyBall2
  States
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    CIMP A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CIMP AB 10 A_Look
    goto Spawn+1
  See:
    CIMP A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CIMP AABBCCDD 3 A_Chase
    Loop
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    CIMP J 8 A_FaceTarget
    CIMP K 6 A_ComboAttack
    Goto See
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    CIMP J 0 A_Jump(128,4)
    CIMP J 9 A_FaceTarget
    CIMP K 9 A_CustomMissile("MyBall2", 32, 0, 0)
    Goto See
    CIMP J 4 A_FaceTarget
    CIMP J 4 A_FaceTarget
    CIMP K 6 A_CustomMissile("MyBall2", 32, 0, 0)
    CIMP J 8 A_FaceTarget
    CIMP J 0 A_Jump(128,5)
    CIMP J 8 A_FaceTarget
    CIMP K 6 A_CustomMissile("MyBall3", 32, 0, 0)
    CIMP J 8 A_FaceTarget
    Goto See
    CIMP J 4 A_FaceTarget
    CIMP J 4 A_FaceTarget
    CIMP K 9 A_CustomMissile("MyBall3", 32, 0, 0)
    CIMP J 8 A_FaceTarget
    Goto See
  Pain:
    CIMP L 2
    CIMP L 2 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,180,0,1)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    CIMP E 8 A_Scream
    CIMP F 4 A_CustomMissile("Gibb3", 20, -1, -60, 1)
    CIMP F 4 A_TossGib
    CIMP G 1 A_Fall
    CIMP G 1 A_TossGib
    CIMP G 1 A_CustomMissile("Gibb1", 16, -2, -30, 1)
    CIMP G 1 A_TossGib
    CIMP G 1 A_CustomMissile("BSplatter", 2,0,0, 1)
    CIMP G 1 A_TossGib
    CIMP G 1 A_CustomMissile("Gibb2", 14, 2, -10, 1)
    CIMP G 0 A_TossGib
    CIMP G 1 A_PlaySound("splat11")
    CIMP G 1 A_CustomMissile("BSplatter", 14, 0, 0, 1)
    CIMP H 1 A_CustomMissile("Gibb4", 12, 3, 32, 1)
    CIMP H 1 A_TossGib
    CIMP H 1 A_CustomMissile("Gibb5", 10, 3, 0, 1)
    CIMP H 1 A_TossGib
    CIMP H 1 A_CustomMissile("BSplatter", 10, 1, 16, 1)
    CIMP H 1 A_CustomMissile("BeefyHead", -20, 0, 0)
    CIMP H 1 A_TossGib
    CIMP H 1 A_CustomMissile("BSplatter", 16, -1, -16, 1) 
    CIMP H 1 A_TossGib
    CIMP H 2 A_CustomMissile("Gibb3", 4, 3, 0, 1)
    CIMP I -1
    Stop
  XDeath:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,180,0,1)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    CIMP E 4 A_Scream
    CIMP E 4 A_TossGib
    CIMP F 4 A_CustomMissile("Gibb3", 20, 0, -60, 1)
    CIMP F 4 A_TossGib
    CIMP F 1 A_Fall
    CIMP F 1 A_TossGib
    CIMP G 1 A_CustomMissile("Gibb1", 16, 0, -10, 1)
    CIMP G 0 A_TossGib
    CIMP G 1 A_CustomMissile("BSplatter", 38,0,0, 1)
    CIMP G 1 A_TossGib
    CIMP G 1 A_CustomMissile("Gibb2", 14, 0, -30, 1)
    CIMP G 1 A_TossGib
    CIMP G 1 A_PlaySound("splat11")
    CIMP G 0 A_TossGib
    CIMP G 1 A_CustomMissile("BSplatter", 24, 0, 0, 1)
    CIMP H 1 A_TossGib
    CIMP H 1 A_CustomMissile("Gibb4", 12, 0, 32, 1)
    CIMP H 1 A_TossGib
    CIMP H 1 A_CustomMissile("Gibb5", 10, 0, 0, 1)
    CIMP H 0 A_TossGib
    CIMP H 1 A_CustomMissile("BSplatter", 24, 0, 16, 1)
    CIMP H 1 A_CustomMissile("BeefyHead", -20, 0, 0)
    CIMP H 1 A_TossGib
    CIMP H 1 A_CustomMissile("BSplatter", 16, 0, -16, 1) 
    CIMP H 1 A_TossGib
    CIMP H 3 A_CustomMissile("Gibb3", 4, 0, 0, 1)
    CIMP I -1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,180,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    CIMP L 5 A_GenericFreezeDeath
    CIMP L 1 A_FreezeDeathChunks
    wait
  }
}

ACTOR BlackBearNew replaces BlackBear 3191
{
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Monsters"

  dropitem DoomSpellMana1 8 50
  dropitem HealthBonus 1
  dropitem ArmorBonus 1
  dropitem MaxHealthBonus 1
  dropitem RandomPowerupSpawner 1
  dropitem FloraRandomArmor

  HitObituary "%o was exploded to bits by a tiny bear effigy."
  Obituary "%o was exploded to bits by a tiny bear effigy."

  DamageFactor "Holy", 2
  DamageFactor "Magic", 1.25
  Painchance "Holy", 180
  Painchance "Magic", 112

  PainChance 90
  Painchance "Fist", 135 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 225 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 135 // Fist attacks have a +50% chance of stunning an enemy

  Health 8
  Radius 8
  Height 20
  Speed 9
  Mass 20
  MONSTER 
  +FLOORCLIP +NOCLIP +RANDOMIZE +COUNTKILL +CANPASS +DONTOVERLAP 
  Scale 0.75
  MELEEDAMAGE 1
  SeeSound ""
  PainSound ""
  DeathSound ""
  ActiveSound "BLACK"
  MeleeSound ""
  HitObituary "%o was blown up by a demonized teddy bear."
  ExplosionRadius 40
  ExplosionDamage 11
  States
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    BBER A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BBER AB 4 A_Look
    goto Spawn+1
  See:
    BBER A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BBER ABCD 2 A_Chase
    Loop
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    BBER A 1 A_MeleeAttack
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,36,0,1)
    BBER A 1 A_Scream
    BBER A 1 A_Fall
    BBER A 1 A_Explode  
    BBER A 0 A_PlaySound("splat11")
    BBER A 1 A_CustomMissile("BSplatter", 0, 0, 0, 1)
    Stop
  Pain:
    BBER B 4 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,36,0,1)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BBER A 1 A_Scream
    BBER A 1 A_Fall
    BBER A 0 A_Jump(200,2) 
    BBER A 1 A_Explode
    BBER A 0 
    BBER A 0 A_PlaySound("splat11")
    BBER A 0 A_CustomMissile("BSplatter", 0, 0, 0, 1)
    BBER A 0 A_custommissile("BlackSplatter1", 6, 0, random(-180, 180), 2, random(0, 180))
    BBER AAA 0 A_custommissile("BlackSplatter2", 6, 0, random(-180, 180), 2, random(0, 180))		
    BBER A 1
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,36,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    BBER B 5 A_GenericFreezeDeath
    BBER B 1 A_FreezeDeathChunks
    wait
  }
}

actor ClownGhostNew replaces ClownGhost 32128
{ 
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Monsters"

  dropitem DoomSpellMana1 24 50
  dropitem DoomSpellMana1 24 50
  dropitem DoomSpellMana2 24 125
  dropitem DoomSpellMana2 24 125
  dropitem GreenArmor 2
  dropitem BlueArmor 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem RandomPowerupSpawner 1
  dropitem FloraRandomArmor

  DamageFactor "Holy", 3
  DamageFactor "Magic", 1.5
  Painchance "Holy", 255
  Painchance "Magic", 192

  PainChance 128
  Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 192 // Fist attacks have a +50% chance of stunning an enemy

  Health 300 
  Speed 5 
  Radius 16
  Height 48
  Mass 400
  Meleedamage 1 
  gibhealth -400
  REACTIONTIME 8 
  MONSTER
  DropItem ClownSouls 75
  +FLOORCLIP +NOCLIP +NOGRAVITY +FLOAT +FloatBob +DONTHURTSPECIES +NOTARGET
  RENDERSTYLE Translucent
  ALPHA 0.67
  SeeSound ""
  PainSound "GHSTPAIN"
  DeathSound "GHSTDIE"
  ActiveSound "GIDLE"  
  MeleeSound "imp/melee"
  HitObituary "%o got bit by a clown ghost." 
  Obituary "%o got killed by a clown ghost." 
  MissileHeight 12
  MissileType SkullSeeker2 
  States 
  { 
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    GHOS C 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    GHOS C 10 A_Look
    goto Spawn+1
  See: 
    GHOS D 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    GHOS D 10 A_Chase
    GHOS E 10 A_Chase
    GHOS F 10 A_Chase
    GHOS A 0 A_Jump(128,6)
    GHOS A 4 A_Chase
    GHOS A 4 A_Chase
    GHOS A 4 A_Chase
    GHOS A 4 A_Chase
    Goto See+4
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    GHOS B 1 Bright A_Chase
    GHOS B 1 Bright A_Chase
    GHOS B 1 Bright A_Chase
    GHOS B 1 Bright A_Chase
    GHOS B 1 Bright A_Chase
    GHOS B 1 Bright A_Chase
    GHOS B 1 Bright A_Chase
    GHOS B 1 Bright A_Chase
    GHOS B 1 Bright A_Chase
    GHOS B 1 Bright A_Chase
    GHOS B 1 Bright A_Chase
    GHOS B 1 Bright A_Chase
    GHOS B 1 Bright A_Chase
    GHOS B 1 Bright  A_Chase
    GHOS B 1 Bright A_Chase
    Goto See+4
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    GHOS A 4 A_FaceTarget  
    GHOS F 3 A_FaceTarget 
    GHOS G 3 A_MeleeAttack
    GHOS F 3 A_FaceTarget 
    Goto See+4
  Missile: 
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    GHOS F 4 A_Jump(245,3)
    GHOS F 4 A_FaceTarget 
    GHOS G 6 A_ComboAttack
    GHOS F 1 A_Chase
    GHOS G 1 A_Chase 
    GHOS G 1 A_Chase 
    GHOS G 1 A_Chase 
    GHOS G 1 A_Chase 
    GHOS G 1 A_Chase 
    GHOS G 1 A_Chase 
    GHOS F 1 A_Chase 
    Goto See+4
  Pain: 
    GHOS A 4 A_Pain 
    Goto See+4
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,350,0,1)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    GHOS B 1 A_Scream 
    GHOS F 8 A_NoBlocking 
    GHOS E 8 //A_custommissile("ClownSoulFloat1", 8, random(-15, 15), random(-180, 180), 2, random(80, 100))
    GHOS D 8 A_PlaySound("BOONBITE")
    GHOS C 0 A_CustomMissile("Balloon_Black", 8, 0, 0, 1)
    Stop 
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,350,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    GHOS A 5 A_GenericFreezeDeath
    GHOS A 1 A_FreezeDeathChunks
    wait
  } 
}

actor ClownGhost2New replaces ClownGhost2 31211
{ 
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Monsters"

  dropitem DoomSpellMana1 24 50
  dropitem DoomSpellMana2 24 125
  dropitem DoomSpellMana3 24 350
  dropitem GreenArmor 2
  dropitem BlueArmor 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem RandomPowerupSpawner 1
  dropitem FloraRandomArmor

  DamageFactor "Ice", 2
  DamageFactor "Holy", 3
  DamageFactor "Magic", 1.5
  Painchance "Ice", 255
  Painchance "Holy", 255
  Painchance "Magic", 192

  PainChance 128
  Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 192 // Fist attacks have a +50% chance of stunning an enemy

  Health 150
  Speed 6 
  Radius 16
  Height 48
  Mass 400
  Meleedamage 3 
  REACTIONTIME 8 
  MONSTER
  DropItem ClownSouls 100
  +FLOORCLIP +NOCLIP +NOGRAVITY +FLOAT +FloatBob +NORADIUSDMG +NOTARGET
  RENDERSTYLE Translucent
  ALPHA 0.67
  SeeSound ""
  PainSound "GHS2PAN"
  DeathSound "GHS2PAN"
  ActiveSound "GHS2ACT"
  MeleeSound "imp/melee"
  HitObituary "%o got ripped up by a flaming clown ghost." 
  Obituary "%o got incinerated by a flaming clown ghost." 
  MissileHeight 15
  MissileType Ghost2Ball
  States 
  { 
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    GST2 A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    GST2 AB 10 A_Look
    goto Spawn+1
  See: 
    GST2 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    GST2 A 1 A_JumpIfCloser(1500,5)
    GST2 AABB 1 A_Chase 
    Loop
    GST2 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    GST2 A 0 A_CustomMissile("HellFire2", 0, 0, 0)
    GST2 AABB 1 A_Chase
    Goto See
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    GST2 A 4 A_FaceTarget  
    GST2 B 3 A_FaceTarget 
    GST2 C 3 A_MeleeAttack
    GST2 B 3 A_FaceTarget 
    Goto See
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    GST2 B 4 A_FaceTarget 
    GST2 C 6 A_ComboAttack
    GST2 B 4 A_Chase 
    Goto See
  Pain: 
    GST2 B 4 A_Pain 
    Goto See
  Pain.Ice: 
    GST2 B 4 A_Pain 
    GST2 B 24
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,175,0,1)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    GST2 D 1 A_Scream 
    GST2 D 2 A_TossGib
    GST2 E 2 A_CustomMissile("BSplatter", 16, 0,0, 1)
    GST2 E 2 A_TossGib
    GST2 F 2 A_NoBlocking 
    GST2 F 2 A_TossGib
    GST2 G 2 A_CustomMissile("HellFire1", 8, 0, -180)
    GST2 G 2 A_TossGib
    GST2 H 2 A_TossGib
    GST2 H 2 A_TossGib
    Stop   
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,175,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    GST2 B 5 A_GenericFreezeDeath
    GST2 B 1 A_FreezeDeathChunks
    wait
  }
}

actor BulbyNew replaces Bulby 3906
{ 
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Monsters"

  dropitem DoomSpellMana1 24 50
  dropitem DoomSpellMana2 24 125
  dropitem GreenArmor 2
  dropitem BlueArmor 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem RandomPowerupSpawner 1
  dropitem FloraRandomArmor

  DamageFactor "Holy", 2
  DamageFactor "Magic", 1.25
  Painchance "Holy", 255
  Painchance "Magic", 160

  PainChance 128
  Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 192 // Fist attacks have a +50% chance of stunning an enemy

  Health 200 
  Speed 5 
  Radius 16
  Height 32
  Mass 400
  Meleedamage 1 
  Scale .7
  MONSTER
  DropItem ClownSouls 30
  +FLOORCLIP +FLOAT +NOTARGET //+NORADIUSDMG 
  SeeSound "BOTTLE2"
  PainSound "GHS2PAIN"
  DeathSound "BOTTLE2"
  ActiveSound "BULBSEE"  
  MeleeSound "imp/melee"
  HitObituary "%o got electroshocked by Bulby." 
  Obituary "%o got killed by Bulby." 
  MissileType BulbyBall
  States 
  { 
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    LDEM A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    LDEM A 2 A_UnSetShootable
    LDEM A 2 A_Look
    goto Spawn+1
  See: 
    LLLL A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    LLLL A 16  A_UnSetShootable
    LLLL B 7
    LLLL C 7
    LDEM A 6 
    LDEM B 6 
    LDEM C 5
    LDEM D 5 
    LDEM E 4
    LDEM F 2 A_NoGravity 
    LDEM F 2 A_SetShootable
    LDEM G 2 A_Chase
    Goto See + 11
  Melee: 
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    LDEM G 3 A_FaceTarget 
    LDEM H 3 A_FaceTarget 
    LDEM I 3 A_MeleeAttack
    LDEM H 3 A_FaceTarget 
    Goto See + 11
  Missile:  
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    LDEM G 3 A_Jump(88,6)
    LDEM G 3 A_FaceTarget 
    LDEM H 3 A_FaceTarget 
    LDEM I 0 A_PlaySound("BULBEXP2")
    LDEM I 2 Bright A_CustomMissile("BulbyBall", 12, -4, 0, 1)
    LDEM H 4 
    Goto See + 11
    LDEM G 4 A_FaceTarget 
    LDEM H 4 A_FaceTarget 
    LDEM I 1 A_PlaySound("BULBEXP2")
    LDEM I 3 Bright A_CustomMissile("BulbyBall2", 12, -4, 0, 1)
    LDEM H 4 
    Goto See + 11
  Pain: 
    LDEM J 4  A_Pain 
    Goto See + 11
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,230,0,1)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    LDEM J 1 A_Scream 
    LDEM K 1 A_TossGib
    LDEM K 1 A_CustomMissile("BSplatter", 0, 0, 0, 1) 
    LDEM K 1 A_TossGib
    LDEM K 2 A_PlaySound("splat11")
    LDEM K 2 A_CustomMissile("BulbyGib1", 24, 16, 60, 1)
    LDEM K 2 A_TossGib
    LDEM L 2 A_CustomMissile("BSplatter", 40, -16, -32, 1)
    LDEM L 2 A_TossGib
    LDEM L 2 A_CustomMissile("BulbyGib2", 16, 8, -30, 1)
    LDEM L 2 A_TossGib
    LDEM M 4 A_NoBlocking 
    LDEM M 2 A_CustomMissile("BulbyGib3", 32, -16, -60, 1)
    LDEM M 2 A_TossGib
    LDEM N 2 A_CustomMissile("BSplatter", 24, 30, 32, 1)
    LDEM N 2 A_TossGib
    LDEM N 2 A_CustomMissile("BSplatter", 20, 32, 0, 1)
    LDEM N 2 A_TossGib
    LDEM N -1
    Stop   
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,230,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    LDEM J 5 A_GenericFreezeDeath
    LDEM J 1 A_FreezeDeathChunks
    wait
  }    
}

actor MegaBulbyNew replaces MegaBulby 3989
{ 
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Monsters"

  dropitem DoomSpellMana1 24 50
  dropitem DoomSpellMana2 24 125
  dropitem DoomSpellMana3 24 350
  dropitem GreenArmor 2
  dropitem GreenArmor 2
  dropitem BlueArmor 2
  dropitem BlueArmor 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem RandomPowerupSpawner 1
  dropitem RandomPowerupSpawner 1
  dropitem FloraRandomArmor

  DamageFactor "Holy", 2
  DamageFactor "Magic", 1.25
  Painchance "Holy", 128
  Painchance "Magic", 80

  PainChance 64
  Painchance "Fist", 96 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 160 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 96 // Fist attacks have a +50% chance of stunning an enemy

  Health 400 
  Speed 6 
  Radius 32
  Height 64
  Mass 400
  Meleedamage 1 
  Scale 1.5
  MONSTER
  DropItem ClownSouls 200
  +FLOORCLIP +FLOAT +NORADIUSDMG +NOGRAVITY +FloatBob +NOTARGET
  SeeSound "GHSTPAIN"
  PainSound "GHSTPAIN"
  DeathSound "GHSTPAIN"
  ActiveSound "GHSTATT"
  MeleeSound "imp/melee"
  HitObituary "%o got electroshocked by Mega Bulby." 
  Obituary "%o got killed by Mega Bulby." 
  MissileType BulbyBall3
  States 
  { 
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    LDEM G 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    LDEM G 2 A_Look
    goto Spawn+1
  See: 
    LDEM G 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    LDEM G 0 
    LDEM G 0 
    LDEM G 2 A_Chase
    Goto See + 3
  Melee: 
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    LDEM H 3 A_FaceTarget 
    LDEM I 3 A_MeleeAttack
    LDEM H 3 A_FaceTarget 
    Goto See + 3
  Missile:  
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    LDEM G 3 A_Jump(5,5)
    LDEM G 3 A_FaceTarget 
    LDEM H 3 A_FaceTarget 
    LDEM I 0 A_PlaySound("BULBEXP2")
    LDEM I 2 Bright A_CustomMissile("BulbyBall3", 24, -4,0, 1)
    LDEM H 4 
    Goto See + 3
    LDEM G 4 A_FaceTarget 
    LDEM H 4 A_FaceTarget 
    LDEM I 4 Bright A_CustomMissile("BulbyBall3", 24, -4, 0, 1)
    LDEM H 4 
    Goto See + 3 
  Pain: 
    LDEM J 4  A_Pain 
    Goto See + 3
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,460,0,1)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    LDEM J 1 A_Scream 
    LDEM K 1 A_CustomMissile("BSplatter", 0, 0, 0, 1) 
    LDEM K 1 A_TossGib
    LDEM K 1 A_PlaySound("GHSTPAIN")
    LDEM K 1 A_TossGib
    LDEM K 2 A_CustomMissile("BulbyGib1", 24, 20, 60, 1)
    LDEM K 2 A_TossGib
    LDEM L 2 A_CustomMissile("BSplatter", 40, -18, -32, 1)
    LDEM L 2 A_TossGib
    LDEM L 1 A_CustomMissile("BulbyGib2", 16, 8, -30, 1)
    LDEM L 2 A_TossGib
    LDEM L 1 A_CustomMissile("BulbyGib3", 32, -32, -30, 1)
    LDEM L 2 A_TossGib
    LDEM M 2 A_NoBlocking 
    LDEM M 2 A_TossGib
    LDEM M 1 A_CustomMissile("BulbyGib3", 32, -16, -60, 1)
    LDEM M 1 A_TossGib
    LDEM M 1 A_CustomMissile("BulbyGib3", 32, -16, -60, 1)
    LDEM M 1 A_TossGib
    LDEM N 2 A_CustomMissile("BSplatter", 24, 30, 32, 1)
    LDEM N 2 A_TossGib
    LDEM N 1 A_CustomMissile("BSplatter", 20, 32, 0, 1)
    LDEM N 1 A_TossGib
    LDEM N 1 A_CustomMissile("BSplatter", 15, -16, 0, 1)
    LDEM N 1 A_TossGib
    LDEM N 2 A_IceGuyDie 
    Stop   
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,460,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    LDEM J 5 A_GenericFreezeDeath
    LDEM J 1 A_FreezeDeathChunks
    wait
  }    
}

ACTOR BigBertha2New replaces BigBertha2 3192
{ 
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Monsters"

  dropitem DoomSpellMana1 24 50
  dropitem DoomSpellMana1 24 50
  dropitem DoomSpellMana2 24 125
  dropitem DoomSpellMana2 24 125
  dropitem DoomSpellMana3 24 350
  dropitem DoomSpellMana3 24 350
  dropitem GreenArmor 2
  dropitem GreenArmor 2
  dropitem BlueArmor 2
  dropitem BlueArmor 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem HealthBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem ArmorBonus 2
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem MaxHealthBonus 1
  dropitem RandomPowerupSpawner 1
  dropitem RandomPowerupSpawner 1
  dropitem FloraRandomArmor

  DamageFactor "Magic", 1.5
  Painchance "Magic", 192

  PainChance 128
  Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 192 // Fist attacks have a +50% chance of stunning an enemy

  Health 675 
  Speed 6 
  Radius 24
  Height 92
  Mass 500
  Meleedamage 1 
  REACTIONTIME 8 
  MONSTER
  +FLOORCLIP +NOGRAVITY +FLOAT
  scale 1.25
  SeeSound "BIRTHA3"
  PainSound "BIRTHA1"
  DeathSound "BIRTHA1"
  ActiveSound "BIRTHA2"
  Obituary "%o touched big birtha's puke." 
  MissileHeight 12
  MissileType BlackBear
  States 
  { 
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    BRTH A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BRTH A 10 A_Look 
    goto Spawn+1
  See: 
    BRTH A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BRTH AAB 4 A_Chase
    Goto See
  Missile: 
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    BRTH A 0 A_Jump(128,15)  
    BRTH A 4 A_FaceTarget 
    BRTH ABCDH 4 A_FaceTarget 
    BRTH EF 4 A_FaceTarget 
    BRTH G 3 A_CustomMissile("BlackBlob", 12, 0, 0, 1)
    BRTH G 0 A_CustomMissile("BlackBlob", 12, 12, 0, 1)
    BRTH G 0 A_CustomMissile("BlackBlob", 12, -12, 0, 1)
    BRTH DC 4 
    Goto See 
    BRTH ABC 4 A_FaceTarget 
    BRTH D 2 Bright A_CustomMissile("BirthaBall", 48, 0, 0, 1)
    BRTH C 4 A_FaceTarget 
    Goto See 
  Pain: 
    BRTH A 4  A_Pain 
    Goto See 
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,925,0,1)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BRTH I 7 A_Scream 
    BRTH J 6  A_NoBlocking 
    BRTH K 6
    BRTH L 4
    BRTH MN 4
    BRTH N 0 A_CustomMissile("BlackBlob", 12, 0, 0, 1) 
    BRTH N 0 A_CustomMissile("BlackBlob", 12, 12, 0, 1) 
    BRTH N 0 A_CustomMissile("BlackBlob", 12, -13, 0, 1) 
    BRTH N 0 A_CustomMissile("BlackBlob", 12, -16, 0, 1) 
    BRTH N 0 A_CustomMissile("BlackBlob", 12, 18, 0, 1) 
    BRTH O 4     
    Stop    
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,925,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    BRTH A 5 A_GenericFreezeDeath
    BRTH A 1 A_FreezeDeathChunks
    wait
  } 
}

actor SuperBerthaNew replaces SuperBertha 14768
{ 
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Monsters"

  dropitem DoomSpellMana3 24 350
  dropitem DoomSpellMana3 24 350
  dropitem DoomSpellMana3 24 350
  dropitem DoomSpellMana3 24 350
  dropitem GreenArmor 8
  dropitem GreenArmor 8
  dropitem GreenArmor 8
  dropitem GreenArmor 8
  dropitem BlueArmor 8
  dropitem BlueArmor 8
  dropitem BlueArmor 8
  dropitem BlueArmor 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem RandomPowerupSpawner 1
  dropitem RandomPowerupSpawner 1
  dropitem RandomPowerupSpawner 1
  dropitem RandomPowerupSpawner 1
  dropitem FloraRandomArmor

  DamageFactor "Magic", 1.5
  Painchance "Magic", 192

  PainChance 128
  Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 192 // Fist attacks have a +50% chance of stunning an enemy

  Health 6000 
  Speed 7 
  Radius 50
  Height 144
  Mass 40000
  Meleedamage 1 
  REACTIONTIME 8 
  MONSTER
  +FLOORCLIP
  +NOGRAVITY
  +FLOAT 
  +FloatBob
  SeeSound ""
  PainSound "GHSTPAIN"
  DeathSound "GHSTDIE"
  ActiveSound "BCLICK5"
  MeleeSound "imp/melee"
  Obituary "%o got launched into the stratosphere by Super Bertha." 
  Scale 1.25
  DamageFactor "Normal", 0.33
  DamageFactor "Sceptre", 1
  DamageFactor "Holy", 1.5
  DamageFactor "Magic", 0.875
  States
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    BRTH A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BBTH A 2 A_Look // A_SetInvulnerable
    BBTH A 2 A_Look
    goto Spawn+1
  See:
    BRTH A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BBTH A 2 A_Chase // A_SetInvulnerable
    BBTH A 2 A_Chase
    Loop
  Missile:   
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    BBTH A 0 A_JumpIfCloser(200,2)
    BBTH A 0 
    Goto See
    BBTH A 0 A_FaceTarget  
    BBTH B 1 //A_PlaySound("BEAT667")
    BBTH B 0 A_custommissile("SoulAttack", 45, 0, random(-45, 45), 2, random(-20, 20))
    BBTH B 1 A_FaceTarget 
    BBTH B 0 A_custommissile("SoulAttack", 45, 0, random(-45, 45), 2, random(-20, 20))
    BBTH B 1 A_FaceTarget 
    BBTH B 0 A_custommissile("SoulAttack", 45, 0, random(-45, 45), 2, random(-20, 20))
    BBTH B 1 A_FaceTarget 
    BBTH B 0 A_custommissile("SoulAttack", 45, 0, random(-45, 45), 2, random(-20, 20))
    BBTH B 0 A_custommissile("SoulAttack", 45, 0, random(-45, 45), 2, random(-20, 20))
    BBTH B 1 A_FaceTarget 
    BBTH B 0 A_custommissile("SoulAttack", 45, 0, random(-45, 45), 2, random(-20, 20))
    BBTH B 1 A_FaceTarget 
    BBTH B 0 A_custommissile("SoulAttack", 45, 0, random(-45, 45), 2, random(-20, 20))
    BBTH B 1 A_FaceTarget 
    BBTH B 0 A_custommissile("SoulAttack", 45, 0, random(-45, 45), 2, random(-20, 20))
    BBTH B 0 A_custommissile("SoulAttack", 45, 0, random(-45, 45), 2, random(-20, 20))
    BBTH B 1 A_FaceTarget 
    BBTH B 0 A_custommissile("SoulAttack", 45, 0, random(-45, 45), 2, random(-20, 20))
    BBTH B 1 A_FaceTarget 
    BBTH B 0 A_custommissile("SoulAttack", 45, 0, random(-45, 45), 2, random(-20, 20))
    BBTH B 1 A_FaceTarget 
    BBTH B 0 A_custommissile("SoulAttack", 45, 0, random(-45, 45), 2, random(-20, 20))
    BBTH B 1 
    Goto See
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    BBTH BA 1 A_FaceTarget 
    BBTH C 4  A_MeleeAttack
    BBTH AB 4 A_FaceTarget 
    Goto See
  Pain:
    BBTH C 3 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,120000,0,1)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BBTH B 3 A_Scream
    BBTH B 3 
    BBTH B 2 A_CustomMissile("BSplatter", 64, -16, -32, 1)
    BBTH B 2 A_CustomMissile("BSplatter", 32, -32, 0, 1)
    BBTH B 2 A_CustomMissile("BSplatter", 16, 32, 32, 1)
    BBTH B 2 A_CustomMissile("BSplatter", 128, -48, 64, 1)
    BBTH B 2 A_CustomMissile("BSplatter", 144, 48, -16, 1)
    BBTH B 2 A_CustomMissile("BSplatter", 40, 0, 0, 1)
    BBTH B 2 A_CustomMissile("BSplatter", 112, 64, 16, 1)
    BBTH B 2 A_CustomMissile("BSplatter", 64, 128, 72, 1)
    BBTH B 2 A_CustomMissile("BSplatter", 8, 96, -104, 1)
    BBTH C 2 A_CustomMissile("BSplatter", 144, 144, 0, 1)
    BBTH B 2 A_CustomMissile("BSplatter", 64, -16, -32, 1)
    BBTH B 2 A_CustomMissile("BSplatter", 32, -32, 0, 1)
    BBTH B 2 A_CustomMissile("BSplatter", 16, 32, 32, 1)
    BBTH B 2 A_CustomMissile("BSplatter", 128, -48, 64, 1)
    BBTH B 2 A_CustomMissile("BSplatter", 144, 48, -16, 1)
    BBTH B 2 A_CustomMissile("BSplatter", 40, 0, 0, 1)
    BBTH B 2 A_CustomMissile("BSplatter", 112, 64, 16, 1)
    BBTH B 2 A_CustomMissile("BSplatter", 64, 128, 72, 1)
    BBTH B 2 A_CustomMissile("BSplatter", 8, 96, -104, 1)
    BBTH C 2 A_CustomMissile("BSplatter", 144, 144, 0, 1)
    SPL2 ABCDE 4 A_Fall
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,120000,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    BBTH C 5 A_GenericFreezeDeath
    BBTH C 1 A_FreezeDeathChunks
    wait
  }
}

ACTOR EvilDeadHandNew replaces EvilDeadHand 32212
{
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Monsters"

  dropitem DoomSpellMana1 8 50
  dropitem GreenArmor 1
  dropitem BlueArmor 1
  dropitem HealthBonus 1
  dropitem HealthBonus 1
  dropitem ArmorBonus 1
  dropitem ArmorBonus 1
  dropitem MaxHealthBonus 1
  dropitem RandomPowerupSpawner 1
  dropitem FloraRandomArmor

  DamageFactor "Holy", 3
  DamageFactor "Magic", 1.25
  Painchance "Holy", 255
  Painchance "Magic", 250

  PainChance 200
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy

  Health 20
  Radius 8
  Height 16
  Speed 5
  Mass 20
  MONSTER 
  +FLOORCLIP +RANDOMIZE 
  scale 0.75
  MELEEDAMAGE 1
  SeeSound "HSEE"
  PainSound "HAND1"
  DeathSound "HAND3"
  ActiveSound "HAND1"
  MeleeSound "SKULBITE"
  HitObituary "%o was choked to death by the Evil Dead hand." 
  Obituary "%o was choked to death by the Evil Dead hand." 
  States
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    HAND A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HAND A 4 A_Look
    goto Spawn+1
  See:
    HAND A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    HAND A 0 A_Jump(200,5)
    HAND A 0 A_CustomMissile("ZGut2", 0, 0, 180)  
    HAND A 0 A_Jump(250,2)
    HAND A 0 A_CustomMissile("ZGut3", 0, 0, 0)     
    HAND ABCB 2 A_Chase 
    Loop
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    HAND C 6 A_FaceTarget 
    HAND A 6 A_MeleeAttack
    HAND B 6
    Goto See 
  Pain:
    HAND B 8 A_Pain 
    Goto See 
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,25,0,1)
    HAND D 5 A_CustomMissile("ZGut2", 0, 0, 30) 
    HAND E 2 A_PlaySound("splat11")
    HAND E 3 A_Scream 
    HAND F 0 A_CustomMissile("BSplatter", 0, 0, 0, 1)
    HAND F 5 A_CustomMissile("ZGut3", 0, 0, -40)   
    HAND G 5 A_Fall 
    HAND H -1 
    Stop 
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,25,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    HAND B 5 A_GenericFreezeDeath
    HAND B 1 A_FreezeDeathChunks
    wait
  }
}

ACTOR BouncingClownNew replaces BouncingClown 4822
{
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Monsters"

  dropitem DoomSpellMana3 24 350
  dropitem DoomSpellMana3 24 350
  dropitem DoomSpellMana3 24 350
  dropitem DoomSpellMana3 24 350
  dropitem DoomSpellMana3 24 350
  dropitem GreenArmor 8
  dropitem GreenArmor 8
  dropitem GreenArmor 8
  dropitem GreenArmor 8
  dropitem GreenArmor 8
  dropitem BlueArmor 8
  dropitem BlueArmor 8
  dropitem BlueArmor 8
  dropitem BlueArmor 8
  dropitem BlueArmor 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem RandomPowerupSpawner 1
  dropitem RandomPowerupSpawner 1
  dropitem RandomPowerupSpawner 1
  dropitem RandomPowerupSpawner 1
  dropitem RandomPowerupSpawner 1
  dropitem FloraRandomArmor

  DamageFactor "Holy", 2
  DamageFactor "Magic", 1.25
  Painchance "Holy", 50
  Painchance "Magic", 31

  PainChance 25
  Painchance "Fist", 38 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 63 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 38 // Fist attacks have a +50% chance of stunning an enemy

  Health 6000
  Radius 24
  Height 112
  Speed 11
  Mass 2000
  MONSTER 
  +FLOORCLIP +RANDOMIZE +COUNTKILL +CANPASS
  MELEEDAMAGE 3
  SeeSound "GAURD11"
  PainSound "GAURD12"
  DeathSound "GAURD12"
  ActiveSound "GAURD11"
  MeleeSound "BCHOMP"
  HitObituary "%o was eaten by a bouncing popcorn clown."
  Obituary "%o was killed by a bouncing popcorn clown."
  PainChance "Magic", 128
  PainChance "Melee", 128
  PainChance "Sceptre", 256
  PainChance "Holy", 256
  DamageFactor "Sceptre", 1 // Sceptre does full damage
  DamageFactor "Magic", 0.75 // Magic does damage, but not quite a full amount
  DamageFactor "Holy", 2 // Diaris Arrows hurt it like no-one's business
  DamageFactor "Melee", 1.25
  DamageFactor "Normal", 0.125 // Most other damage doesn't work well [1/8th normal damage]
  States
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    BCWN A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BCWN AB 4 A_Look
    goto Spawn+1
  See:
    BCWN A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BCWN A 2
    BCWN A 2 A_Chase
    BCWN B 2
    BCWN B 2 A_Chase
    BCWN CC 2 A_Chase
    BCWN B 4
    BCWN A 0 A_JumpIfCloser(1024,1)
    Loop
    BCWN A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BCWN A 0 A_PlaySound("GAURD13")
    BCWN A 0 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN A 0 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN A 0 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN A 0 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN A 0 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN A 0 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN A 0 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN A 0
    Loop
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    BCWN A 3 A_FaceTarget 
    BCWN B 3 A_FaceTarget 
    BCWN C 4 A_MeleeAttack
    BCWN B 3 A_FaceTarget 
    Goto See
  Pain:
    BCWN D 5 A_Pain
    BCWN E 0 A_SetReflective
    BCWN E 0 A_SetInvulnerable
    BCWN E 4
    BCWN FFFF 2 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN GGGG 1 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN HHHH 1 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN IIII 1 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN JJJJ 1 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN JJJJJ 10 
    BCWN JIHGFED 5
    BCWN D 0 A_UnSetReflective
    BCWN D 0 A_UnSetInvulnerable
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,75000,0,1)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BCWN D 5 A_Scream
    BCWN E 0
    BCWN E 0 
    BCWN E 4
    BCWN FFFF 2 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN GGGG 1 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN HHHH 1 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN IIII 1 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN JJJJ 1 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN JJ 10 
    BCWN J 0 
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,75000,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    BCWN D 5 A_GenericFreezeDeath
    BCWN D 1 A_FreezeDeathChunks
    wait
  }
}

ACTOR BabyClownNew replaces BabyClown 4823
{
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Monsters"

  dropitem DoomSpellMana3 24 350
  dropitem GreenArmor 8
  dropitem BlueArmor 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem RandomPowerupSpawner 1
  dropitem FloraRandomArmor

  DamageFactor "Holy", 2
  DamageFactor "Magic", 1.25
  Painchance "Holy", 255
  Painchance "Magic", 250

  PainChance 200
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy

  Health 88
  Radius 8
  Height 32
  Speed 15
  Mass 60
  MONSTER 
  Scale 0.25
  DropItem ClownSouls 64
  +FLOORCLIP +RANDOMIZE +COUNTKILL +CANPASS   +randomize
  MELEEDAMAGE 3
  SeeSound ""
  PainSound "BYHURT"
  DeathSound "BYHURT"
  ActiveSound "BYCLWN"
  MeleeSound "CLWNBITE"
  HitObituary "%o was eaten by a bouncing popcorn clown."
  Obituary "%o was killed by a bouncing popcorn clown."
  States
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    BCWN A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BCWN AB 4 A_Look
    goto Spawn+1
  See:
    BCWN A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    BCWN A 1
    BCWN A 2 
    BCWN B 1 A_Chase
    BCWN B 2 A_Chase
    BCWN CC 2 A_Chase
    BCWN B 2
    Loop
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    BCWN A 3 A_FaceTarget 
    BCWN B 0 A_PlaySound("CLWNBITE")
    BCWN B 3 A_FaceTarget
    BCWN C 4 A_MeleeAttack
    BCWN B 3 A_FaceTarget
    BCWN B 0 A_PlaySound("CLWNBITE")
    Goto See
  Pain:
    BCWN B 4 A_Pain
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,105,0,1)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BCWN D 5 A_Scream
    BCWN E 4 A_Fall
    BCWN FFFF 2 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN GGGG 1 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN HHHH 1 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN IIII 1 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN JJJJ 1 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN K 8 
    BCWN L 8 A_CustomMissile("cloud1", 12, 0, 0, 1)
    BCWN M 8 A_CustomMissile("cloud1", 12, 0, 1)
    BCWN N -1 A_CustomMissile("cloud1", 12, 0, 0, 1)
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,105,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    BCWN D 5 A_GenericFreezeDeath
    BCWN D 1 A_FreezeDeathChunks
    wait
  }
}

ACTOR BabyClown2New replaces BabyClown2 4825
{
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Monsters"

  dropitem DoomSpellMana3 24 350
  dropitem GreenArmor 8
  dropitem BlueArmor 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem RandomPowerupSpawner 1
  dropitem FloraRandomArmor

  DamageFactor "Holy", 2
  DamageFactor "Magic", 1.25
  Painchance "Holy", 255
  Painchance "Magic", 250

  PainChance 200
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy

  Health 75
  Radius 8
  Height 32
  Speed 15
  Mass 60
  MONSTER 
  Scale 0.25
  DropItem ClownSouls 64
  +FLOORCLIP +RANDOMIZE +COUNTKILL +CANPASS   
  MELEEDAMAGE 3
  SeeSound ""
  PainSound "BYHURT"
  DeathSound "BYHURT"
  ActiveSound "BYCLWN"
  MeleeSound "CLWNBITE"
  HitObituary "%o was eaten by a bouncing popcorn clown."
  Obituary "%o was killed by a bouncing popcorn clown."
  States
  {
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    CRWL A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CRWL A 4 A_Look
    goto Spawn+1
  See:
    PCWN A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    PCWN ABC 5
    BCWN A 1
    BCWN A 2 
    BCWN B 1 A_Chase
    BCWN B 2 A_Chase
    BCWN CC 2 A_Chase
    BCWN B 2
    Goto See + 5
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    BCWN A 3 A_FaceTarget 
    BCWN B 0 A_PlaySound("CLWNBITE")
    BCWN B 3 A_FaceTarget
    BCWN C 4 A_MeleeAttack
    BCWN B 3 A_FaceTarget
    BCWN B 0 A_PlaySound("CLWNBITE")
    Goto See + 5
  Pain:
    BCWN B 4 A_Pain
    Goto See + 5
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,92,0,1)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    BCWN D 5 A_Scream
    BCWN E 4 A_Fall
    BCWN FFFF 2 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN GGGG 1 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN HHHH 1 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN IIII 1 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN JJJJ 1 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), 2, random(0, 90))
    BCWN K 8 
    BCWN L 8 A_CustomMissile("cloud1", 12, 0, 0, 1)
    BCWN M 8 A_CustomMissile("cloud1", 12, 0, 1)
    BCWN N -1 A_CustomMissile("cloud1", 12, 0, 0, 1)
    Stop
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,92,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    BCWN D 5 A_GenericFreezeDeath
    BCWN D 1 A_FreezeDeathChunks
    wait
  }
}

actor PennywiseHead2New replaces PennywiseHead 14421
{ 
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Monsters"

  dropitem DoomSpellMana3 24 350
  dropitem DoomSpellMana3 24 350
  dropitem GreenArmor 8
  dropitem GreenArmor 8
  dropitem BlueArmor 8
  dropitem BlueArmor 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem RandomPowerupSpawner 1
  dropitem RandomPowerupSpawner 1
  dropitem FloraRandomArmor

  DamageFactor "Holy", 2
  DamageFactor "Magic", 1.25
  Painchance "Holy", 255
  Painchance "Magic", 160

  PainChance 128
  Painchance "Fist", 192 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 192 // Fist attacks have a +50% chance of stunning an enemy

  Health 450
  Speed 11 
  Radius 16
  Height 48
  Mass 400
  Meleedamage 3 
  REACTIONTIME 8 
  MONSTER
  DropItem ClownSouls 100
  +FLOORCLIP +NOGRAVITY +FLOAT +FloatBob +NORADIUSDMG +NOTARGET
  SeeSound ""
  PainSound ""
  DeathSound ""
  ActiveSound ""
  MeleeSound "imp/melee"
  Obituary "%o got killed by a floating apparition of Pennywise's head." 
  MissileHeight 15
  MissileType Ghost2Ball
  States 
  { 
  Pain.Charm: TNT1 A 0 { A_PlaySound("Munchies/Charmed"); A_ChangeFlag("FRIENDLY",1); Thing_ChangeTID(0,1000); } Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See
  Spawn:
    CFHD A 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CFHD A 10 A_Look
    goto Spawn+1
  See: 
    CFHD A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    CFHD A 1 A_Chase 
    CFHD A 1 A_Chase 
    CFHD A 1 A_Chase 
    CFHD A 1 A_Chase 
    Goto See
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    CFHD D 4 A_FaceTarget  
    CFHD E 3 A_FaceTarget 
    CFHD D 3 A_MeleeAttack
    CFHD A 3 A_FaceTarget 
    Goto See
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    CFHD D 4 A_FaceTarget 
    CFHD E 6 A_ComboAttack
    CFHD D 4 A_Chase 
    Goto See
  Pain: 
    CFHD E 4 A_Pain 
    Goto See
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,1125,0,1)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    CFHD F 1 A_Scream 
    CFHD G 2 A_TossGib
    CFHD H 2 A_CustomMissile("BSplatter", 16, 0,0, 1)
    CFHD I 2 A_TossGib
    CFHD J 2 A_NoBlocking 
    CFHD K 2 
    CFHD L 2 A_CustomMissile("HellFire1", 8, 0, -180)
    CFHD M 2 
    CFHD N 2
    Stop   
  Ice:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,1125,0,1)
    TNT1 A 0 A_ChangeFlag("CANTSEEK", TRUE)
    CFHD E 5 A_GenericFreezeDeath
    CFHD E 1 A_FreezeDeathChunks
    wait
  }
}

actor PennywiseBoss replaces Pennywise 3672
{
  var int user_theta; var int user_dormant; var int user_isstealth; var int user_basespeed; var int user_baseattack; var int user_basedefense; var int user_basemass; var int user_monsterlevel;
  var int user_MaxHP; var int user_HPLowRange; var int user_HPCritRange; var int user_HPBuffRange; var int user_HPXDeathRange;
  var int user_checkmapskill; var int user_ressurrectstr; // For checking if a monster has been given Skill/Map inventory items yet.

  //$Angled
  //$Color 12
  //$Category "Happy Time Circus/Bosses"

  dropitem DoomSpellMana3 24 350
  dropitem DoomSpellMana3 24 350
  dropitem DoomSpellMana3 24 350
  dropitem DoomSpellMana3 24 350
  dropitem DoomSpellMana3 24 350
  dropitem GreenArmor 8
  dropitem GreenArmor 8
  dropitem GreenArmor 8
  dropitem GreenArmor 8
  dropitem GreenArmor 8
  dropitem BlueArmor 8
  dropitem BlueArmor 8
  dropitem BlueArmor 8
  dropitem BlueArmor 8
  dropitem BlueArmor 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem HealthBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem ArmorBonus 8
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem MaxHealthBonus 4
  dropitem RandomPowerupSpawner 1
  dropitem RandomPowerupSpawner 1
  dropitem RandomPowerupSpawner 1
  dropitem RandomPowerupSpawner 1
  dropitem RandomPowerupSpawner 1
  dropitem RandomPowerupSpawner 1
  dropitem FloraRandomArmor

  PainChance 224
  Painchance "Fist", 255 // Fist attacks have a +50% chance of stunning an enemy
  Painchance "Kick", 255 // Kick attacks have a +150% chance of stunning an enemy
  Painchance "Gauntlets", 255 // Fist attacks have a +50% chance of stunning an enemy

  Health 45000
  Radius 40
  Height 112
  Speed 8
  MONSTER 
  minmissilechance 40
  scale 1.25
  +FLOORCLIP +NORADIUSDMG +FULLVOLACTIVE +NOTARGET
  SeeSound ""
  PainSound "PENHURT"
  DeathSound ""
  ActiveSound "ITACTIVE"
  MeleeSound "imp/melee"
  Obituary "%o was killed by Pennywise the Dancing Clown."
  HitObituary "%o was killed by Pennywise the Dancing Clown."
  MissileHeight 96
  MissileType PennySeeker

  PainChance "Magic", 252
  PainChance "Melee", 252
  PainChance "Sceptre", 256
  PainChance "Holy", 256
  DamageFactor "Sceptre", 2
  DamageFactor "Magic", 1.75
  DamageFactor "Holy", 1.75
  DamageFactor "Melee", 1.5
  DamageFactor "Normal", 0.67

  States
  {
  Pain.Charm: Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See Goto See  Pain.Heal1: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,0); } Goto See  Pain.Heal2: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,1); } Goto See  Pain.Heal3: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,2); } Goto See  Pain.Heal4: TNT1 A 0 { ACS_NamedExecuteAlways("Healing_Actor",0,3); } Goto See
  Spawn:
    PLIT J 0 NoDelay ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    PLIT J 10 A_Look
    goto Spawn+1
  See:
    PLIT Q 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,0)
    PLIT QPONMLJKIHGFEDCB 2
    PENY A 0 A_SetInvulnerable
    PENY AABBCCDD 3 A_Chase
    Goto See + 17
  Melee:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    PENY E 1 A_FaceTarget 
    PENY E 1 A_custommissile("SoulAttack", 80, random(-4, 4), random(-45, 45), 2, random(-20, 20))
    PENY E 1 A_custommissile("SoulAttack", 32, random(-4, 4), random(-45, 45), 2, random(-20, 20))
    Goto See + 17     
  Missile:
    TNT1 A 0 ACS_NamedExecuteAlways("RefreshStealthInfo",0,1) // makes a Stealth Monster become more visible
    PENY A 0 A_ClearShadow 
    PENY E 0 A_UnSetInvulnerable
    PENY A 0 A_Jump (32,4)
    PENY E 9 A_FaceTarget  
    PENY E 4 A_CustomMissile("Deadlight", 96, 0, 0,1) 
    PENY E 9 A_FaceTarget 
    Goto See + 17
    PENY E 9 A_FaceTarget
    PENY E 4 A_CustomMissile("Deadlight", 96, 0, 0,1)
    PENY E 9 A_FaceTarget
    Goto See + 17
  Pain:
    PENY F 0 A_SetInvulnerable
    PENY F 8 A_Pain
    PENY F 5 A_custommissile("SkullSeeker666", 96,0,random(-180, 180),1,random(-20, 20))
    PENY F 5 A_custommissile("SkullSeeker666", 96,0,random(-180, 180),1,random(-20, 20))
    PENY F 5 A_custommissile("SkullSeeker666", 96,0,random(-180, 180),1,random(-20, 20))
    PENY F 5 A_custommissile("SkullSeeker666", 96,0,random(-180, 180),1,random(-20, 20))
    PENY F 10 A_custommissile("SkullSeeker666", 96,0,random(-180, 180),1,random(-20, 20))
    Goto See + 16
  Pain.GravityHP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,0,0,0)
    Goto See
  Pain.GravityMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,1,0,0)
    Goto See
  Pain.GravityHPMP:
    TNT1 A 0 ACS_NamedExecuteAlways("Hand-GravityAttack",0,2,0,0)
    Goto See
  Pain.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,10) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 
    Goto Pain
  Death.Sceptre:
    TNT1 A 0 A_CheckFlag("FRIENDLY",2,AAPTR_DEFAULT)
    TNT1 A 0 ACS_NamedExecuteAlways("AddSceptreEXP",0,0,0,1) // Increase EXP for Sceptre [1+(HP/300)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Pain.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,1,0) // Give some life when hurting a monster [1+(HP/500)]
    Goto Pain
  Death.Gauntlets:
    TNT1 A 0 ACS_NamedExecuteAlways("SauronGauntletsHit",0,0,2,0) // Give some life when killing a monster [3+(HP/100)]
    TNT1 A 0 A_JumpIfHealthLower(user_HPXDeathRange,"XDeath")
    Goto Death
  Death:
    TNT1 A 0 ACS_NamedExecuteAlways("AddEXP",0,540000,0,1)
    TNT1 A 0 ACS_NamedExecuteAlways("MonsterStatsHP_ATK_DEF_SPD",0,1)
    PENY G 8 A_Scream
    PENY GGGG 8
    PENY H 8 
    PENY IJ 8
    PENY K  8 A_Fall 
    PENY L 1 A_CustomMissile("cloud1", random(24, 40), 0, 0, 0, 0)
    PENY L 1 A_CustomMissile("cloud1", random(24, 40), 0, 0, 0, 0)
    PENY L 0 A_CustomMissile("Sparkles", 8, random(-16, 16), random(-180, 180), 2, random(-180, 180))
    PENY L 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY L 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY LLLL 0 A_CustomMissile("cloud1", random(24, 40), random(-4, 4), 0, 0, 0)
    PENY L 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY LLL 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY L 1 A_CustomMissile("cloud1", random(24, 40), random(-16, 16), 0, 0, 0)
    PENY L 0 A_CustomMissile("cloud1", random(24, 40), random(-16, 16), 0, 0, 0)
    PENY LLLL 0 A_CustomMissile("cloud1", random(24, 40), random(-8, 8), 0, 0, 0)
    PENY L 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY L 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY L 1 A_CustomMissile("cloud1", random(24, 40), random(-16, 16), 0, 0, 0)
    PENY L 0 A_CustomMissile("cloud1", random(24, 40), random(-16, 16), 0, 0, 0)
    PENY LLL 0 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY L 1 A_CustomMissile("cloud1", random(24, 40), random(-4, 4), 0, 0, 0)
    PENY LLL 1 A_CustomMissile("cloud1", random(24, 40), random(-2, 2), 0, 0, 0)
    PENY MM 1 A_CustomMissile("cloud1", random(16, 32), random(-2, 2), 0, 0, 0)
    PENY MM 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY MM 1 A_CustomMissile("cloud1", random(16, 32), 0, 0, 0, 0)
    PENY MM 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY MMM 0 A_CustomMissile("cloud1", random(16, 32), random(-4, 4), 0, 0, 0)
    PENY MM 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY MM 0 A_CustomMissile("cloud1", random(16, 32), 0, 0, 0, 0)
    PENY MMM 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY MM 0 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY MM 1 A_CustomMissile("cloud1", random(16, 32), random(-16, 16), 0, 0, 0)
    PENY MM 0 A_CustomMissile("cloud1", random(16, 32), random(-4, 4), 0, 0, 0)
    PENY MM 1 A_CustomMissile("cloud1", random(16, 32), random(-16, 16), 0, 0, 0)
    PENY N 1 A_CustomMissile("cloud1", random(14, 30), random(-2, 2), 0, 0, 0)
    PENY NNN 1 A_CustomMissile("cloud1", random(14, 30), random(-32, 32), 0, 0, 0)
    PENY NNNN 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY N 1 A_CustomMissile("cloud1", random(14, 30), random(-16, 16), 0, 0, 0)
    PENY NN 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY NN 1 A_CustomMissile("cloud1", random(14, 30), random(-16, 16), 0, 0, 0)
    PENY NNN 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY NN 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY N 1 A_CustomMissile("cloud1", random(14, 30), random(-16, 16), 0, 0, 0)
    PENY NN 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY N 1 A_CustomMissile("cloud1", random(14, 30), random(-16, 16), 0, 0, 0)
    PENY O 1 A_CustomMissile("cloud1", random(12, 24), random(-16, 16), 0, 0, 0)
    PENY OOO 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY OOO 1 A_CustomMissile("cloud1", random(12, 24), random(-16, 16), 0, 0, 0)
    PENY OOOO 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY OOO 1  A_CustomMissile("cloud1", random(12, 24), random(-16, 16), 0, 0, 0)
    PENY OOOO 1 A_CustomMissile("cloud1", random(12, 24), random(-16, 16), 0, 0, 0)
    PENY OO 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY OOOO 1 A_CustomMissile("cloud1", random(12, 24), random(-16, 16), 0, 0, 0)
    PENY PPPP 1 A_CustomMissile("cloud1", random(12, 20), random(-16, 16), 0, 0, 0)
    PENY PPPP 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY PPPPP 1 A_CustomMissile("cloud1", random(12, 20), random(-16, 16), 0, 0, 0) 
    PENY PPPP 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY PPPPP 1 A_CustomMissile("cloud1", random(12, 20), random(-16, 16), 0, 0, 0)
    PENY PPPPP 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY PPPP 1 A_CustomMissile("cloud1", random(12, 20), random(-16, 16), 0, 0, 0)
    PENY PPPPP 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY PPPP 1 A_CustomMissile("cloud1", random(12, 20), random(-16, 16), 0, 0, 0)
    PENY QQQQQQ 1 A_CustomMissile("cloud1", random(10, 18), random(-16, 16), 0, 0, 0)
    PENY QQQQQQ 1 A_CustomMissile("cloud1", random(10, 18), random(-16, 16), 0, 0, 0)
    PENY QQQQQQ 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY QQQQQQ 1 A_CustomMissile("cloud1", random(10, 18), random(-16, 16), 0, 0, 0)
    PENY QQQQQQ 1 A_CustomMissile("cloud1", random(10, 18), random(-16, 16), 0, 0, 0)
    PENY QQQQQQ 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY QQQQQQ 1 A_CustomMissile("cloud1", random(10, 18), random(-16, 16), 0, 0, 0)
    PENY QQQQQQ 1 A_CustomMissile("cloud1", random(10, 18), random(-16, 16), 0, 0, 0)
    PENY QQQQQQ 0 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY RRRRRRR 1 A_CustomMissile("cloud1", random(10, 16), random(-16, 16), 0, 0, 0)
    PENY RRRRRRR 1 A_CustomMissile("cloud1", random(10, 16), random(-16, 16), 0, 0, 0)
    PENY RRRRRRR 0 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY RRRRRRR 1 A_CustomMissile("cloud1", random(10, 16), random(-16, 16), 0, 0, 0)
    PENY RRRRRRR 1 A_CustomMissile("cloud1", random(10, 16), random(-16, 16), 0, 0, 0)
    PENY RRRRRRR 0 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY RRRRRRR 1 A_CustomMissile("cloud1", random(10, 16), random(-16, 16), 0, 0, 0)
    PENY RRRRRRR 1 A_CustomMissile("cloud1", random(10, 16), random(-16, 16), 0, 0, 0)
    PENY RRRRRRR 0 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY SSSSSSSS 1 A_CustomMissile("cloud1", random(8, 14), random(-16, 16), 0, 0, 0)
    PENY SSSSSSSS 1 A_CustomMissile("cloud1", random(8, 14), random(-16, 16), 0, 0, 0)
    PENY SSSSSSSS 0 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY SSSSSSSS 1 A_CustomMissile("cloud1", random(8, 14), random(-16, 16), 0, 0, 0)
    PENY SSSSSSSS 1 A_CustomMissile("cloud1", random(8, 14), random(-16, 16), 0, 0, 0)
    PENY SSSSSSSS 1 A_CustomMissile("cloud1", random(8, 14), random(-16, 16), 0, 0, 0)
    PENY SSSSSSSS 0 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY SSSSSSSS 1 A_CustomMissile("cloud1", random(8, 14), random(-16, 16), 0, 0, 0)
    PENY TTTTTTTTT 1 A_CustomMissile("cloud1", random(8, 12), random(-16, 16), 0, 0, 0)
    PENY TTTTTTTTT 1 A_CustomMissile("cloud1", random(8, 12), random(-16, 16), 0, 0, 0)
    PENY TTTTTTTTT 0 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY TTTTTTTTT 1 A_CustomMissile("cloud1", random(8, 12), random(-16, 16), 0, 0, 0)
    PENY TTTTTTTTT 1 A_CustomMissile("cloud1", random(8, 12), random(-16, 16), 0, 0, 0)
    PENY TTTTTTTTT 1 A_CustomMissile("cloud1", random(8, 12), random(-16, 16), 0, 0, 0)
    PENY TTTTTTTTT 0 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY UUUUUUUUUU 1 A_CustomMissile("cloud1", random(6, 10), random(-16, 16), 0, 0, 0)
    PENY UUUUUUUUUU 1 A_CustomMissile("cloud1", random(6, 10), random(-16, 16), 0, 0, 0)
    PENY UUUUUUUUUU 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180)) 
    PENY UUUUUUUUUU 1 A_CustomMissile("cloud1", random(6, 10), random(-16, 16), 0, 0, 0)
    PENY UUUUUUUUUU 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180)) 
    PENY UUUUUUUUUU 1 A_CustomMissile("cloud1", random(6, 10), random(-16, 16), 0, 0, 0)
    PENY UUUUUUUUUU 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180)) 
    PENY VVVVVVVVVVVV 1 A_CustomMissile("cloud1", random(6, 8),random(-16, 16), 0, 0, 0)
    PENY VVVVVVVVVVVV 0 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180)) 
    PENY VVVVVVVVVVVV 1 A_CustomMissile("cloud1", random(6, 8), random(-16, 16), 0, 0, 0) 
    PENY VVVVVVVVVVVV 0 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180)) 
    PENY VVVVVVVVVVVV 1 A_CustomMissile("cloud1", random(6, 8),random(-16, 16), 0, 0, 0)
    PENY VVVVVVVVVVVV 0 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180)) 
    PENY WWWWWWWWWWWWWW 1 A_CustomMissile("cloud1", random(4, 8), random(-16, 16), 0, 0, 0)
    PENY WWWWWWWWWWWWWW 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180)) 
    PENY WWWWWWWWWWWWWW 1 A_CustomMissile("cloud1", random(4, 8), random(-16, 16), 0, 0, 0)
    PENY WWWWWWWWWWWWWW 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180)) 
    PENY WWWWWWWWWWWWWW 1 A_CustomMissile("cloud1", random(4, 8), random(-16, 16), 0, 0, 0)    
    PENY XXXXXXXXXXXXXXXX 1 A_CustomMissile("cloud1", random(2, 8), random(-16, 16), 0, 0, 0)
    PENY XXXXXXXXXXXXXXXX 1 A_CustomMissile("cloud1", random(2, 8), random(-16, 16), 0, 0, 0)
    PENY XXXXXXXXXXXXXXXX 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY XXXXXXXXXXXXXXXX 1 A_CustomMissile("cloud1", random(2, 8), random(-16, 16), 0, 0, 0)
    PENY XXXXXXXXXXXXXXXX 1 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    PENY XXXXXXXXXXXXXXXX 1 A_CustomMissile("cloud1", random(2, 8), random(-16, 16), 0, 0, 0)
    PENY YYYYYYYYYYYYYYYYYYYY 5 A_CustomMissile("cloud1", random(0, 8), random(-16, 16), 0, 0, 0)
    PENY Z -1
    Stop
  Ice:
    goto Death
  }
}


// Weapons
ACTOR PopcornGunNew : PopcornGun replaces PopcornGun 30204
{
  Weapon.SelectionOrder 100
  Inventory.PickupSound "misc/w_pkup" 
  Weapon.AmmoType "PopcornPiece" 
  Weapon.AmmoGive 20 
  Weapon.AmmoUse 1
  Inventory.Pickupmessage "You got the Popcorn Gun! Don't eat the popcorn..." 
  Obituary "%o ate some of %k's popcorn."
  AttackSound "" 
  Scale 0.75
  States 
  { 
  User1:
    TNT1 A 0 
	{ 
	 if (CountInv("FloraInPlay",AAPTR_PLAYER1) <= 0) { return state("Ready"); }
	 return state(""); 
	}
	TNT1 A 0 
	{
	 ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34) A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104)
    FKIC B 1 Offset(24,32) A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104)
    FKIC B 1 Offset(24,34) A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready

  Spawn: 
    PPPG A -1 
    LOOP 
  Ready: 
    PGUN AAACCCDDDEEEFFFGGG 1 A_WeaponReady(WRF_ALLOWUSER1)
    LOOP 
  Deselect: 
    PGUN A 0 A_Lower 
    PGUN A 1 A_Lower 
    LOOP 
  Select: 
    PGUN A 0 A_Raise 
    PGUN A 1 A_Raise 
    LOOP 
  Fire:
    TNT1 A 0 ACS_NamedExecuteAlways("StartTensionCountDown")
    TNT1 A 0 A_JumpIfInventory("SpreaderAura2", 0, "FireSpread7")
    TNT1 A 0 A_JumpIfInventory("SpreaderAura1", 0, "FireSpread3")
    goto FireNormal
  FireNormal:
    PGUN A 0 A_Jump (200,5)
    PGUN A 0 A_PlaySound("POPFIRE")
    PGUN A 4 A_FireCustomMissile("Popcorn1", -1, 1, 4, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 0, 0, 6, 1, 0, 0)
    PGUN B 2 A_FireCustomMissile("Popcorn3", 1, 0, 5, 1, 0, 0)

    PGUN A 0 A_Jump (144,5)
    PGUN A 0 A_PlaySound("POPFIRE")
    PGUN A 2 A_FireCustomMissile("Popcorn11", -1, 0, 4, 2, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", -4, 1, 5, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn1", 2, 0, 4, 1, 0, 0)

    PGUN A 0 A_Jump (128,5)
    PGUN A 0 A_PlaySound("POPFIRE")
    PGUN A 4 A_FireCustomMissile("Popcorn3", -2, 0, 3, 1, 0, 0)
    PGUN B 2 A_FireCustomMissile("Popcorn2", -2, 1, 4, -2, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 4, 0, 0, 1, 0, 0)

    PGUN A 0 A_Jump (96,4)
    PGUN A 0 A_FireCustomMissile("Popcorn2", -3, 0, 4, 1, 0, 0)
    PGUN A 0 A_PlaySound("POPFIRE")
    PGUN A 0 A_FireCustomMissile("Popcorn3", 3, 0, 0, 1, 0, 0)

    PGUN A 0 A_Jump (96,5)
    PGUN A 2 A_FireCustomMissile("Popcorn1", 2, 0, 5, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 0, 0, 0, 1, 0, 0)
    PGUN A 0 A_PlaySound("POPFIRE")
    PGUN B 1 A_FireCustomMissile("Popcorn3", -2, 1, 0, 1, 0, 0)

    PGUN A 0 A_Jump (64,4)
    PGUN A 0 A_PlaySound("POPFIRE")
    PGUN A 4 A_FireCustomMissile("Popcorn3", -1, 0, 4, 1, 0, 0)
    PGUN A 2 A_FireCustomMissile("Popcorn2", 1, 0, 0, 1, 0, 0)

    PGUN A 0 A_Jump (64,4)
    PGUN B 1 A_FireCustomMissile("BurntPopcorn1", 0, 0, 5, 1, 0, 0)

    PGUN A 0 A_Jump (128,2)
    PGUN A 1 A_FireCustomMissile("BurntPopcorn1", 0, 0, 5, 1, 0, 0)
    PGUN A 0 
    goto FireEnd
  FireSpread3:
    PGUN A 0 A_Jump (200,11)
    PGUN A 0 A_PlaySound("POPFIRE")
    PGUN A 0 A_FireCustomMissile("Popcorn1", -1+15, 0, 4, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn1",    -1, 1, 4, 1, 0, 0)
    PGUN A 4 A_FireCustomMissile("Popcorn1", -1-15, 0, 4, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 0+15, 0, 6, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2",    0, 0, 6, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 0-15, 0, 6, 1, 0, 0)
    PGUN B 0 A_FireCustomMissile("Popcorn3", 1+15, 0, 5, 1, 0, 0)
    PGUN B 0 A_FireCustomMissile("Popcorn3",    1, 0, 5, 1, 0, 0)
    PGUN B 2 A_FireCustomMissile("Popcorn3", 1-15, 0, 5, 1, 0, 0)

    PGUN A 0 A_Jump (144,11)
    PGUN A 0 A_PlaySound("POPFIRE")
    PGUN A 0 A_FireCustomMissile("Popcorn11", -1+15, 0, 4, 2, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn11",    -1, 0, 4, 2, 0, 0)
    PGUN A 2 A_FireCustomMissile("Popcorn11", -1-15, 0, 4, 2, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", -4+15, 0, 5, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2",    -4, 1, 5, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", -4-15, 0, 5, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn1", 2+15, 0, 4, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn1",    2, 0, 4, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn1", 2-15, 0, 4, 1, 0, 0)

    PGUN A 0 A_Jump (128,11)
    PGUN A 0 A_PlaySound("POPFIRE")
    PGUN A 0 A_FireCustomMissile("Popcorn3", -2+15, 0, 3, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn3",    -2, 0, 3, 1, 0, 0)
    PGUN A 4 A_FireCustomMissile("Popcorn3", -2-15, 0, 3, 1, 0, 0)
    PGUN B 0 A_FireCustomMissile("Popcorn2", -2+15, 0, 4, -2, 0, 0)
    PGUN B 0 A_FireCustomMissile("Popcorn2",    -2, 1, 4, -2, 0, 0)
    PGUN B 2 A_FireCustomMissile("Popcorn2", -2-15, 0, 4, -2, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 4+15, 0, 0, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2",    4, 0, 0, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 4-15, 0, 0, 1, 0, 0)

    PGUN A 0 A_Jump (96,8)
    PGUN A 0 A_FireCustomMissile("Popcorn2", -3+15, 0, 4, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2",    -3, 0, 4, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", -3-15, 0, 4, 1, 0, 0)
    PGUN A 0 A_PlaySound("POPFIRE")
    PGUN A 0 A_FireCustomMissile("Popcorn3", 3+15, 0, 0, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn3",    3, 0, 0, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn3", 3-15, 0, 0, 1, 0, 0)

    PGUN A 0 A_Jump (96,11)
    PGUN A 0 A_FireCustomMissile("Popcorn1", 2+15, 0, 5, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn1",    2, 0, 5, 1, 0, 0)
    PGUN A 2 A_FireCustomMissile("Popcorn1", 2-15, 0, 5, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 0+15, 0, 0, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2",    0, 0, 0, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 0-15, 0, 0, 1, 0, 0)
    PGUN A 0 A_PlaySound("POPFIRE")
    PGUN B 0 A_FireCustomMissile("Popcorn3", -2+15, 0, 0, 1, 0, 0)
    PGUN B 0 A_FireCustomMissile("Popcorn3",    -2, 1, 0, 1, 0, 0)
    PGUN B 1 A_FireCustomMissile("Popcorn3", -2-15, 0, 0, 1, 0, 0)

    PGUN A 0 A_Jump (64,8)
    PGUN A 0 A_PlaySound("POPFIRE")
    PGUN A 0 A_FireCustomMissile("Popcorn3", -1+15, 0, 4, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn3",    -1, 0, 4, 1, 0, 0)
    PGUN A 4 A_FireCustomMissile("Popcorn3", -1-15, 0, 4, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 1+15, 0, 0, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2",    1, 0, 0, 1, 0, 0)
    PGUN A 2 A_FireCustomMissile("Popcorn2", 1-15, 0, 0, 1, 0, 0)

    PGUN A 0 A_Jump (64,8)
    PGUN B 0 A_FireCustomMissile("BurntPopcorn1", 0+15, 0, 5, 1, 0, 0)
    PGUN B 0 A_FireCustomMissile("BurntPopcorn1",    0, 0, 5, 1, 0, 0)
    PGUN B 1 A_FireCustomMissile("BurntPopcorn1", 0-15, 0, 5, 1, 0, 0)

    PGUN A 0 A_Jump (128,4)
    PGUN A 0 A_FireCustomMissile("BurntPopcorn1", 0+15, 0, 5, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("BurntPopcorn1",    0, 0, 5, 1, 0, 0)
    PGUN A 1 A_FireCustomMissile("BurntPopcorn1", 0-15, 0, 5, 1, 0, 0)
    PGUN A 0 
    goto FireEnd
  FireSpread7:
    PGUN A 0 A_Jump (200,23)
    PGUN A 0 A_PlaySound("POPFIRE")
    PGUN A 0 A_FireCustomMissile("Popcorn1",  -1+15, 0, 4, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn1", -1+7.5, 0, 4, 1, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn1", -1+7.5, 0, 4, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn1",     -1, 1, 4, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn1", -1-7.5, 0, 4, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn1", -1-7.5, 0, 4, 1, 0, 7.5)
    PGUN A 4 A_FireCustomMissile("Popcorn1",  -1-15, 0, 4, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2",  0+15, 0, 6, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 0+7.5, 0, 6, 1, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 0+7.5, 0, 6, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2",     0, 0, 6, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 0-7.5, 0, 6, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 0-7.5, 0, 6, 1, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2",  0-15, 0, 6, 1, 0, 0)
    PGUN B 0 A_FireCustomMissile("Popcorn3",  1+15, 0, 5, 1, 0, 0)
    PGUN B 0 A_FireCustomMissile("Popcorn3", 1+7.5, 0, 5, 1, 0, 7.5)
    PGUN B 0 A_FireCustomMissile("Popcorn3", 1+7.5, 0, 5, 1, 0, -7.5)
    PGUN B 0 A_FireCustomMissile("Popcorn3",     1, 0, 5, 1, 0, 0)
    PGUN B 0 A_FireCustomMissile("Popcorn3", 1-7.5, 0, 5, 1, 0, -7.5)
    PGUN B 0 A_FireCustomMissile("Popcorn3", 1-7.5, 0, 5, 1, 0, 7.5)
    PGUN B 2 A_FireCustomMissile("Popcorn3",  1-15, 0, 5, 1, 0, 0)

    PGUN A 0 A_Jump (144,23)
    PGUN A 0 A_PlaySound("POPFIRE")
    PGUN A 0 A_FireCustomMissile("Popcorn11",  -1+15, 0, 4, 2, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn11", -1+7.5, 0, 4, 2, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn11", -1+7.5, 0, 4, 2, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn11",     -1, 0, 4, 2, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn11", -1-7.5, 0, 4, 2, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn11", -1-7.5, 0, 4, 2, 0, 7.5)
    PGUN A 2 A_FireCustomMissile("Popcorn11",  -1-15, 0, 4, 2, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2",  -4+15, 0, 5, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", -4+7.5, 0, 5, 1, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2", -4+7.5, 0, 5, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2",     -4, 1, 5, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", -4-7.5, 0, 5, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2", -4-7.5, 0, 5, 1, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2",  -4-15, 0, 5, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn1",  2+15, 0, 4, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn1", 2+7.5, 0, 4, 1, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn1", 2+7.5, 0, 4, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn1",     2, 0, 4, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn1", 2-7.5, 0, 4, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn1", 2-7.5, 0, 4, 1, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn1",  2-15, 0, 4, 1, 0, 0)

    PGUN A 0 A_Jump (128,23)
    PGUN A 0 A_PlaySound("POPFIRE")
    PGUN A 0 A_FireCustomMissile("Popcorn3",  -2+15, 0, 3, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn3", -2+7.5, 0, 3, 1, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn3", -2+7.5, 0, 3, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn3",     -2, 0, 3, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn3", -2-7.5, 0, 3, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn3", -2-7.5, 0, 3, 1, 0, 7.5)
    PGUN A 4 A_FireCustomMissile("Popcorn3",  -2-15, 0, 3, 1, 0, 0)
    PGUN B 0 A_FireCustomMissile("Popcorn2",  -2+15, 0, 4, -2, 0, 0)
    PGUN B 0 A_FireCustomMissile("Popcorn2", -2+7.5, 0, 4, -2, 0, 7.5)
    PGUN B 0 A_FireCustomMissile("Popcorn2", -2+7.5, 0, 4, -2, 0, -7.5)
    PGUN B 0 A_FireCustomMissile("Popcorn2",     -2, 1, 4, -2, 0, 0)
    PGUN B 0 A_FireCustomMissile("Popcorn2", -2-7.5, 0, 4, -2, 0, -7.5)
    PGUN B 0 A_FireCustomMissile("Popcorn2", -2-7.5, 0, 4, -2, 0, 7.5)
    PGUN B 2 A_FireCustomMissile("Popcorn2",  -2-15, 0, 4, -2, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2",  4+15, 0, 0, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 4+7.5, 0, 0, 1, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 4+7.5, 0, 0, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2",     4, 0, 0, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 4-7.5, 0, 0, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 4-7.5, 0, 0, 1, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2",  4-15, 0, 0, 1, 0, 0)

    PGUN A 0 A_Jump (96,16)
    PGUN A 0 A_FireCustomMissile("Popcorn2",  -3+15, 0, 4, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", -3+7.5, 0, 4, 1, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2", -3+7.5, 0, 4, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2",     -3, 0, 4, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", -3-7.5, 0, 4, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2", -3-7.5, 0, 4, 1, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2",  -3-15, 0, 4, 1, 0, 0)
    PGUN A 0 A_PlaySound("POPFIRE")
    PGUN A 0 A_FireCustomMissile("Popcorn3",  3+15, 0, 0, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn3", 3+7.5, 0, 0, 1, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn3", 3+7.5, 0, 0, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn3",     3, 0, 0, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn3", 3-7.5, 0, 0, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn3", 3-7.5, 0, 0, 1, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn3",  3-15, 0, 0, 1, 0, 0)

    PGUN A 0 A_Jump (96,23)
    PGUN A 0 A_FireCustomMissile("Popcorn1",  2+15, 0, 5, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn1", 2+7.5, 0, 5, 1, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn1", 2+7.5, 0, 5, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn1",     2, 0, 5, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn1", 2-7.5, 0, 5, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn1", 2-7.5, 0, 5, 1, 0, 7.5)
    PGUN A 2 A_FireCustomMissile("Popcorn1",  2-15, 0, 5, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2",  0+15, 0, 0, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 0+7.5, 0, 0, 1, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 0+7.5, 0, 0, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2",     0, 0, 0, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 0-7.5, 0, 0, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 0-7.5, 0, 0, 1, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2",  0-15, 0, 0, 1, 0, 0)
    PGUN A 0 A_PlaySound("POPFIRE")
    PGUN B 0 A_FireCustomMissile("Popcorn3",  -2+15, 0, 0, 1, 0, 0)
    PGUN B 0 A_FireCustomMissile("Popcorn3", -2+7.5, 0, 0, 1, 0, 7.5)
    PGUN B 0 A_FireCustomMissile("Popcorn3", -2+7.5, 0, 0, 1, 0, -7.5)
    PGUN B 0 A_FireCustomMissile("Popcorn3",     -2, 1, 0, 1, 0, 0)
    PGUN B 0 A_FireCustomMissile("Popcorn3", -2-7.5, 0, 0, 1, 0, -7.5)
    PGUN B 0 A_FireCustomMissile("Popcorn3", -2-7.5, 0, 0, 1, 0, 7.5)
    PGUN B 1 A_FireCustomMissile("Popcorn3",  -2-15, 0, 0, 1, 0, 0)

    PGUN A 0 A_Jump (64,16)
    PGUN A 0 A_PlaySound("POPFIRE")
    PGUN A 0 A_FireCustomMissile("Popcorn3",  -1+15, 0, 4, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn3", -1+7.5, 0, 4, 1, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn3", -1+7.5, 0, 4, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn3",     -1, 0, 4, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn3", -1-7.5, 0, 4, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn3", -1-7.5, 0, 4, 1, 0, 7.5)
    PGUN A 4 A_FireCustomMissile("Popcorn3",  -1-15, 0, 4, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2",  1+15, 0, 0, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 1+7.5, 0, 0, 1, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 1+7.5, 0, 0, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2",     1, 0, 0, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 1-7.5, 0, 0, 1, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("Popcorn2", 1-7.5, 0, 0, 1, 0, -7.5)
    PGUN A 2 A_FireCustomMissile("Popcorn2",  1-15, 0, 0, 1, 0, 0)

    PGUN A 0 A_Jump (64,16)
    PGUN B 0 A_FireCustomMissile("BurntPopcorn1",  0+15, 0, 5, 1, 0, 0)
    PGUN B 0 A_FireCustomMissile("BurntPopcorn1", 0+7.5, 0, 5, 1, 0, 7.5)
    PGUN B 0 A_FireCustomMissile("BurntPopcorn1", 0+7.5, 0, 5, 1, 0, -7.5)
    PGUN B 0 A_FireCustomMissile("BurntPopcorn1",     0, 0, 5, 1, 0, 0)
    PGUN B 0 A_FireCustomMissile("BurntPopcorn1", 0-7.5, 0, 5, 1, 0, -7.5)
    PGUN B 0 A_FireCustomMissile("BurntPopcorn1", 0-7.5, 0, 5, 1, 0, 7.5)
    PGUN B 1 A_FireCustomMissile("BurntPopcorn1",  0-15, 0, 5, 1, 0, 0)
    PGUN A 0 A_Jump (128,8)
    PGUN A 0 A_FireCustomMissile("BurntPopcorn1",  0+15, 0, 5, 1, 0, 0)
    PGUN A 0 A_FireCustomMissile("BurntPopcorn1", 0+7.5, 0, 5, 1, 0, 7.5)
    PGUN A 0 A_FireCustomMissile("BurntPopcorn1", 0+7.5, 0, 5, 1, 0, -7.5)
    PGUN A 0 A_FireCustomMissile("BurntPopcorn1",     0, 0, 5, 1, 0, 0)
    PGUN B 0 A_FireCustomMissile("BurntPopcorn1", 0-7.5, 0, 5, 1, 0, -7.5)
    PGUN B 0 A_FireCustomMissile("BurntPopcorn1", 0-7.5, 0, 5, 1, 0, 7.5)
    PGUN A 1 A_FireCustomMissile("BurntPopcorn1",  0-15, 0, 5, 1, 0, 0)
    PGUN A 0 
    goto FireEnd
  FireEnd:
    Goto Ready 
  } 
}

ACTOR GoreBalloonNew : GoreBalloon replaces GoreBalloon 30030
{
  Weapon.SelectionOrder 1500
  Inventory.PickupSound "misc/w_pkup" 
  Weapon.AmmoType "GoreBalloons" 
  Weapon.AmmoGive 5 
  Weapon.AmmoUse 1
  Inventory.Pickupmessage "You got some gore balloons!" 
  Obituary "%o wanted %k's balloon."
  Scale 0.75
  States 
  { 
  User1:
    TNT1 A 0 
	{ 
	 if (CountInv("FloraInPlay",AAPTR_PLAYER1) <= 0) { return state("Ready"); }
	 return state(""); 
	}
	TNT1 A 0 
	{
	 ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34) A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104)
    FKIC B 1 Offset(24,32) A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104)
    FKIC B 1 Offset(24,34) A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready

  Spawn: 
    BLNN J -1 
    LOOP 
  Ready: 
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCharacterClass") == 2, 6)
    BLNN ABCD 6 A_WeaponReady(WRF_ALLOWUSER1) 
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCharacterClass") != 2, 5)
    BLNF ABCD 6 A_WeaponReady(WRF_ALLOWUSER1)
    TNT1 A 0
    LOOP 
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCharacterClass") == 2, 4)
    BLNN AA 1 
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCharacterClass") != 2, 3)
    BLNF AA 1 
    TNT1 A 0
    Goto Deselect
  Deselect: 
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCharacterClass") == 2, 6)
    BLNN EEEE 1 A_Lower 
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCharacterClass") != 2, 5)
    BLNF EEEE 1 A_Lower 
    TNT1 A 0
    Loop
  Select: 
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCharacterClass") == 2, 6)
    BLNN EEEE 1 A_Raise 
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCharacterClass") != 2, 5)
    BLNF EEEE 1 A_Raise 
    TNT1 A 0
    LOOP 
  Fire: 
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCharacterClass") == 2, 5)
    BLNN A 1 
    BLNN FG 2
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCharacterClass") != 2, 4)
    BLNF A 1 
    BLNF FG 2
    TNT1 A 0
    TNT1 A 0 ACS_NamedExecuteAlways("StartTensionCountDown")
    TNT1 A 0 A_JumpIfInventory("SpreaderAura2", 0, "FireSpread7")
    TNT1 A 0 A_JumpIfInventory("SpreaderAura1", 0, "FireSpread3")
    goto FireNormal
  FireNormal:
    TNT1 A 0 A_FireCustomMissile("GoreBalloon666", 0, 1, 4, 1, 0, 0)
    goto FireEnd
  FireSpread3:
    TNT1 A 0 A_FireCustomMissile("GoreBalloon666NoHurt", 0+15, 0, 4, 1, 0, 0)
    TNT1 A 0 A_FireCustomMissile("GoreBalloon666",      0, 1, 4, 1, 0, 0)
    TNT1 A 0 A_FireCustomMissile("GoreBalloon666NoHurt", 0-15, 0, 4, 1, 0, 0)
    goto FireEnd
  FireSpread7:
    TNT1 A 0 A_FireCustomMissile("GoreBalloon666NoHurt",  0+15, 0, 4, 1, 0, 0)
    TNT1 A 0 A_FireCustomMissile("GoreBalloon666NoHurt", 0+7.5, 0, 4, 1, 0, 7.5)
    TNT1 A 0 A_FireCustomMissile("GoreBalloon666NoHurt", 0+7.5, 0, 4, 1, 0, -7.5)
    TNT1 A 0 A_FireCustomMissile("GoreBalloon666",       0, 1, 4, 1, 0, 0)
    TNT1 A 0 A_FireCustomMissile("GoreBalloon666NoHurt", 0-7.5, 0, 4, 1, 0, -7.5)
    TNT1 A 0 A_FireCustomMissile("GoreBalloon666NoHurt", 0-7.5, 0, 4, 1, 0, 7.5)
    TNT1 A 0 A_FireCustomMissile("GoreBalloon666NoHurt",  0-15, 0, 4, 1, 0, 0)
    goto FireEnd
  FireEnd:
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCharacterClass") == 2, 5)
    BLNN I 6
    BLNN IH 6
    TNT1 A 0 A_JumpIf(ACS_NamedExecuteWithResult("CheckCharacterClass") != 2, 4)
    BLNF I 6
    BLNF IH 6
    TNT1 A 0 
    Goto Select
  } 
}
actor GoreBalloon666NoHurt
{
  Radius 8
  Height 6
  Speed 13
  Damage 6
  scale 1
  +SEEKERMISSILE +FloatBob 
  PROJECTILE
  ALPHA 0.8
  SeeSound ""
  DeathSound "pop1"
  States
  {
  Spawn:
    BOON A 4 A_SeekerMissile (30,40)
    BOON A 4 A_CustomMissile("Blood", 24, 0, 0, CMF_AIMOFFSET)
    Goto Spawn
  Death:
    BOON B 2 A_Scream
    BOON C 2 A_Fall
    BOON C 0 A_custommissile("BloodSpeck2", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    BOON D 1 A_CustomMissile("BSplatter", 0, 0, 45, CMF_AIMOFFSET|CMF_TRACKOWNER)
    BOON D 1 A_TossGib
    BOON E 1 A_CustomMissile("FlyingGutNoHurt", 4, 0, 225, CMF_AIMOFFSET|CMF_TRACKOWNER)
    BOON C 0 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    BOON E 1 A_TossGib
    BOON E 1 A_CustomMissile("FlyingGutNoHurt", 8, 0, 90, CMF_AIMOFFSET|CMF_TRACKOWNER)
    BOON E 0 A_custommissile("BloodSpeck2", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    BOON F 1 A_CustomMissile("FlyingGutNoHurt", 12, 0, 270, CMF_AIMOFFSET|CMF_TRACKOWNER)
    BOON F 1 A_TossGib
    BOON F 0 A_CustomMissile("FlyingGutNoHurt", 12, 0, 30, CMF_AIMOFFSET|CMF_TRACKOWNER)
    BOON C 0 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    BOON F 0 A_CustomMissile("FlyingGutNoHurt", 12, 0, 270, CMF_AIMOFFSET|CMF_TRACKOWNER)
    BOON C 0 A_CustomMissile("FlyingGutNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    BOON C 0 A_CustomMissile("FlyingGutNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    BOON C 0 A_CustomMissile("FlyingGutNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    BOON F 1 A_TossGib
    BOON F 1 A_CustomMissile("BSplatter", 4, 0, -90, CMF_AIMOFFSET|CMF_TRACKOWNER)
    BOON F 0 A_custommissile("BloodSpeck3", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    BOON F 0 A_CustomMissile("FlyingGutNoHurt", 4, 0, -300, CMF_AIMOFFSET|CMF_TRACKOWNER)
    BOON G 1 A_CustomMissile("FlyingGutNoHurt", 8, 0, 180, CMF_AIMOFFSET|CMF_TRACKOWNER)
    BOON G 0 A_custommissile("BloodSpeck2", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    BOON G 1 A_TossGib
    BOON G 0 A_CustomMissile("FlyingGutNoHurt", 8, 0, 300, CMF_AIMOFFSET|CMF_TRACKOWNER)
    BOON G 0 A_custommissile("BloodSpeck3", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    BOON G 0 A_Jump (240,2) 
    BOON G 0 A_CustomMissile("GoreWorm", 16, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)
    BOON C 0 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    BOON G 0 A_TossGib
    BOON G 0 A_TossGib
    BOON G 0 A_TossGib
    BOON G 0 A_TossGib
    BOON G 1 A_TossGib
    BOON G 0 A_custommissile("BloodSpeck2", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    BOON G 1 A_CustomMissile("FlyingGutNoHurt", 0, 0, 45, CMF_AIMOFFSET|CMF_TRACKOWNER)
    BOON G 0 A_custommissile("BloodSpeck1", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    Stop
  }
}

ACTOR ClownGrenadeNew : ClownGrenade replaces ClownGrenade 30029
{
  Weapon.SelectionOrder 1400
  Inventory.PickupSound "misc/w_pkup" 
  Weapon.AmmoType "CGrenadeAmmo" 
  Weapon.AmmoGive 5 
  Weapon.AmmoUse 1
  Inventory.Pickupmessage "You picked up some clown grenades"
  AttackSound "" 
  +FloatBob 
  Scale .3
  States 
  { 
  User1:
    TNT1 A 0 
	{ 
	 if (CountInv("FloraInPlay",AAPTR_PLAYER1) <= 0) { return state("Ready"); }
	 return state(""); 
	}
	TNT1 A 0 
	{
	 ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34) A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104)
    FKIC B 1 Offset(24,32) A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104)
    FKIC B 1 Offset(24,34) A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready

  Spawn: 
    CGRD ABCDEFGHIJKL 3
    LOOP 
  Ready: 
    GHND ABCDEFFFFFEDCBAA 1 A_WeaponReady(WRF_ALLOWUSER1) 
    LOOP 
  Deselect: 
    GHND A 0 A_Lower 
    GHND A 1 A_Lower 
    LOOP 
  Select: 
    GHND A 0 A_Raise 
    GHND A 1 A_Raise 
    LOOP 
  Fire: 
    GHND I 4
    TNT1 A 0 ACS_NamedExecuteAlways("StartTensionCountDown")
    TNT1 A 0 A_JumpIfInventory("SpreaderAura2", 0, "FireSpread7")
    TNT1 A 0 A_JumpIfInventory("SpreaderAura1", 0, "FireSpread3")
    goto FireNormal
  FireNormal:
    GHND G 0 A_FireCustomMissile("CGrenade", 0, 1, 0, 1, 0, 0)
    goto FireEnd
  FireSpread3:
    GHND G 0 A_FireCustomMissile("CGrenadeNoHurt", 0+15, 0, 0, 1, 0, 0)
    GHND G 0 A_FireCustomMissile("CGrenade",    0, 1, 0, 1, 0, 0)
    GHND G 0 A_FireCustomMissile("CGrenadeNoHurt", 0-15, 0, 0, 1, 0, 0)
    goto FireEnd
  FireSpread7:
    GHND G 0 A_FireCustomMissile("CGrenadeNoHurt",  0+15, 0, 0, 1, 0, 0)
    GHND G 0 A_FireCustomMissile("CGrenadeNoHurt", 0+7.5, 0, 0, 1, 0, 7.5)
    GHND G 0 A_FireCustomMissile("CGrenadeNoHurt", 0+7.5, 0, 0, 1, 0, -7.5)
    GHND G 0 A_FireCustomMissile("CGrenade",     0, 1, 0, 1, 0, 0)
    GHND G 0 A_FireCustomMissile("CGrenadeNoHurt", 0-7.5, 0, 0, 1, 0, -7.5)
    GHND G 0 A_FireCustomMissile("CGrenadeNoHurt", 0-7.5, 0, 0, 1, 0, 7.5)
    GHND G 0 A_FireCustomMissile("CGrenadeNoHurt",  0-15, 0, 0, 1, 0, 0)
    goto FireEnd
  FireEnd:
    GHND G 4 
    GHND H 10 
    Goto Ready 
  } 
}
actor CGrenadeNoHurt
{
  Radius 8
  Height 16
  Speed 25
  Damage 2
  Scale .5
  +Missile +NOTELEPORT
  SeeSound ""
  DeathSound ""
  ExplosionRadius 256
  ExplosionDamage 128
  States
  {
  Spawn:
    CGRD ABCDEFGHIJKL 3 A_CustomMissile("cloud", 4, 0, 0, 1)  
    Goto Spawn 
  Death: 
    CGRD M 0 A_Jump (128,12)
    CGRD MMMMMMMMMM 3
    CGRD M 0 A_Jump (255,11)
    CGRD NNNNNNNNNN 3
    PBFF A 0 A_Explode(128,256,0)
    PBFF A 0 A_PlaySound("BULBEXP") 
    GHFF AAAAAAAAAAAAAAAAAAAAAAAAA 0 A_custommissile("GrenadeSparkNoHurt", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    GHFF AAAAAAAAAAAAAAAAAAAAAAAAA 0 A_custommissile("GrenadeSparkNoHurt", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    GHFF A 1
    GHFF AAAAAAAAAAAAAAAAAAAAAAAAA 0 A_custommissile("GrenadeSparkNoHurt", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))    
    GHFF AAAAAAAAAAAAAAAAA 0 A_custommissile("GrenadeSpark2NoHurt", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    GHFF BC 4 A_custommissile("GrenadeSparkNoHurt", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    GHFF DDDDEEEE 1 
    GHFF FFFFGGGG 1 
    GHFF HI 4 
    GHFF J 4 
    Stop
  }
}
Actor GrenadeSparkNoHurt
{
  Radius 2
  Height 2
  Speed 17
  +Missile +NOTELEPORT
  scale 1
  damage 8
  SeeSound ""
  DeathSound ""
  States
  {
  Spawn:
    CRZY R 1 Bright 
    Goto Spawn
   Death:
    PWT2 G 3 Bright 
    PWT2 H 3 Bright 
    PWT2 IIIIIIIII 3 Bright 
    PWH4 JJJJJJJJJKKKKKKKKKLLLLLLLLLLLLL 3 Bright 
    Stop
  }
}

Actor GrenadeSpark2NoHurt
{
  Radius 2
  Height 2
  Speed 17
  +Missile +NOTELEPORT
  scale 1.5
  damage 25
  SeeSound ""
  DeathSound ""
  States
  {
  Spawn:
    CRZY PQR 1 Bright
    Goto Spawn
  Death:
    PWT2 G 3 Bright 
    PWT2 H 3 Bright 
    PWT2 I 3 Bright 
    Stop
  }
}

ACTOR GutFlingerNew : GutFlinger replaces GutFlinger 30028
{
  Weapon.SelectionOrder 1150
  Inventory.PickupSound "misc/w_pkup" 
  Weapon.AmmoType "ClownSouls" 
  Weapon.AmmoGive 5 
  Weapon.AmmoUse 1
  Inventory.Pickupmessage "You got the Gut Flinger!" 
  AttackSound "" 
  Scale 1
  States 
  { 
  User1:
    TNT1 A 0 
	{ 
	 if (CountInv("FloraInPlay",AAPTR_PLAYER1) <= 0) { return state("Ready"); }
	 return state(""); 
	}
	TNT1 A 0 
	{
	 ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34) A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104)
    FKIC B 1 Offset(24,32) A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104)
    FKIC B 1 Offset(24,34) A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready

  Spawn: 
    CCCC F -1 
    LOOP 
  Ready: 
    CCCC A 1 A_WeaponReady(WRF_ALLOWUSER1) 
    LOOP 
  Deselect: 
    CCCC A 0 A_Lower 
    CCCC A 1 A_Lower 
    LOOP 
  Select: 
    CCCC A 0 A_Raise 
    CCCC A 1 A_Raise 
    LOOP 
  Fire:
    CCCC A 1 A_JumpIfNoAmmo("FireNoAmmo") 
    CCCC B 0 A_PlaySound("GUTFIRE") 
    TNT1 A 0 ACS_NamedExecuteAlways("StartTensionCountDown")
    TNT1 A 0 A_JumpIfInventory("SpreaderAura2", 0, "FireSpread7")
    TNT1 A 0 A_JumpIfInventory("SpreaderAura1", 0, "FireSpread3")
    goto FireNormal
  FireNormal:
    CCCC B 0 A_FireCustomMissile("FlyingGut", 0, 1, 5, 1, 0, 0)
    goto FireEnd
  FireSpread3:
    CCCC B 0 A_FireCustomMissile("FlyingGutNoHurt", 0+15, 0, 5, 1, 0, 0)
    CCCC B 0 A_FireCustomMissile("FlyingGut",    0, 1, 5, 1, 0, 0)
    CCCC B 0 A_FireCustomMissile("FlyingGutNoHurt", 0-15, 0, 5, 1, 0, 0)
    goto FireEnd
  FireSpread7:
    CCCC B 0 A_FireCustomMissile("FlyingGutNoHurt",  0+15, 0, 5, 1, 0, 0)
    CCCC B 0 A_FireCustomMissile("FlyingGutNoHurt", 0+7.5, 0, 5, 1, 0, 7.5)
    CCCC B 0 A_FireCustomMissile("FlyingGutNoHurt", 0+7.5, 0, 5, 1, 0, -7.5)
    CCCC B 0 A_FireCustomMissile("FlyingGut",     0, 1, 5, 1, 0, 0)
    CCCC B 0 A_FireCustomMissile("FlyingGutNoHurt", 0-7.5, 0, 5, 1, 0, -7.5)
    CCCC B 0 A_FireCustomMissile("FlyingGutNoHurt", 0-7.5, 0, 5, 1, 0, 7.5)
    CCCC B 0 A_FireCustomMissile("FlyingGutNoHurt",  0-15, 0, 5, 1, 0, 0)
    goto FireEnd
  FireEnd:
    CCCC B 1 
    CCCC E 1
    CCCC EDCB 3
    Goto Ready 
  FireNoAmmo:
    CCCC E 0
    Goto Deselect
  } 
} 

// FlyingGut with no-damage [for player] explosion (for spread aura)
actor FlyingGutNoHurt
{
  Radius 8
  Height 6
  Speed 13
  Damage 5
  Scale .8
  +Missile
  +Lowgravity
  DropItem Blood
  DropItem Blood
  DropItem Blood
  DropItem Blood
  ExplosionRadius 80
  ExplosionDamage 48
  DeathSound "splat11"
  States
  {
  Spawn:
    SPLT ABCDEF 3 
    Loop
  Death:
    BBLD A 2 A_Explode(48,80,0)
    BBLD A 0 A_custommissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
    BBLD A 0 A_custommissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
    BBLD AB 2 A_CustomMissile("ZGut2", 0, 0, 180) 
    BBLD B 0 A_custommissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
    BBLD B 0 A_custommissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
    BBLD BC 2 A_CustomMissile("ZGut3", 0, 0, 180) 
    BBLD C 0 A_custommissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
    BBLD C 0 A_custommissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
    BBLD D 4 
    BBLD D 0 A_custommissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
    BBLD D 0 A_custommissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
    BBLD D 0 A_custommissile("BloodSpeck2", 8,0, random(-180, 180), 2, random(-180, 180))
    BBLD E 2 
    BBLD E 0 A_custommissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
    BBLD E 0 A_custommissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
    BBLD E 0 A_custommissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
    BBLD E 0 A_custommissile("BloodSpeck2", 8, 0, random(-180, 180), 2, random(-180, 180))
    BBLD E 3 
    Stop
  }
}

ACTOR GasRocketLauncherNew : GasRocketLauncher replaces GasRocketLauncher 30203
{
  Weapon.SelectionOrder 1050
  Inventory.PickupSound "misc/w_pkup" 
  Weapon.AmmoType "ClownSouls" 
  Weapon.AmmoGive 20 
  Weapon.AmmoUse 5
  Inventory.Pickupmessage "You got the Gas Rocket Launcher" 
  Obituary "%o choked on %k's gas."
  AttackSound "" 
  Scale 0.75
  States 
  { 
  User1:
    TNT1 A 0 
	{ 
	 if (CountInv("FloraInPlay",AAPTR_PLAYER1) <= 0) { return state("Ready"); }
	 return state(""); 
	}
	TNT1 A 0 
	{
	 ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34) A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104)
    FKIC B 1 Offset(24,32) A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104)
    FKIC B 1 Offset(24,34) A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready

  Spawn: 
    PRCK V -1 
    LOOP 
  Ready: 
    PRCK G 1 A_WeaponReady(WRF_ALLOWUSER1) 
    LOOP 
  Deselect: 
    PRCK G 0 A_Lower 
    PRCK G 1 A_Lower 
    LOOP 
  Select: 
    PRCK D 0 A_Raise 
    PRCK D 1 A_Raise 
    LOOP 
  Fire:
    PRCK G 0 
    TNT1 A 0 ACS_NamedExecuteAlways("StartTensionCountDown")
    TNT1 A 0 A_JumpIfInventory("SpreaderAura2", 0, "FireSpread7")
    TNT1 A 0 A_JumpIfInventory("SpreaderAura1", 0, "FireSpread3")
    goto FireNormal
  FireNormal:
    PRCK W 0 A_FireCustomMissile("RevRocket2", 0, 1, 4, 1, 0, 0)
    goto FireEnd
  FireSpread3:
    PRCK W 0 A_FireCustomMissile("RevRocket2NoHurt", 0+15, 0, 4, 1, 0, 0)
    PRCK W 0 A_FireCustomMissile("RevRocket2",    0, 1, 4, 1, 0, 0)
    PRCK W 0 A_FireCustomMissile("RevRocket2NoHurt", 0-15, 0, 4, 1, 0, 0)
    goto FireEnd
  FireSpread7:
    PRCK W 0 A_FireCustomMissile("RevRocket2NoHurt",  0+15, 0, 4, 1, 0, 0)
    PRCK W 0 A_FireCustomMissile("RevRocket2NoHurt", 0+7.5, 0, 4, 1, 0, 7.5)
    PRCK W 0 A_FireCustomMissile("RevRocket2NoHurt", 0+7.5, 0, 4, 1, 0, -7.5)
    PRCK W 0 A_FireCustomMissile("RevRocket2",     0, 1, 4, 1, 0, 0)
    PRCK W 0 A_FireCustomMissile("RevRocket2NoHurt", 0-7.5, 0, 4, 1, 0, -7.5)
    PRCK W 0 A_FireCustomMissile("RevRocket2NoHurt", 0-7.5, 0, 4, 1, 0, 7.5)
    PRCK W 0 A_FireCustomMissile("RevRocket2NoHurt",  0-15, 0, 4, 1, 0, 0)
    goto FireEnd
  FireEnd:
    PRCK W 4 
    PRCK A 4 A_PlaySound("RRELOAD")
    PRCK BCDE 4
    PRCK F 4 
    PRCK G 4  
    PRCK G 0 
    Goto Ready 
  } 
} 
actor RevRocket2NoHurt
{
  Speed 18
  Damage 5
  Radius 8
  Height 6
  Scale .55
  +SEEKERMISSILE
  PROJECTILE
  SeeSound "REVRCK"
  DeathSound "EXPLODE"
  ExplosionRadius 96
  ExplosionDamage 12
  States
  {
  Spawn:
    RRCK A 1 A_SeekerMissile (30,40)
    RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)
    RRCK A 1 A_PlaySound("HISS")
    RRCK A 0 A_custommissile("ClownSpark", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)  
    RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)
    RRCK A 0 A_custommissile("ClownSpark", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)  
    RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER) 
    RRCK A 0 A_custommissile("ClownSpark", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)  
    RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)  
    RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)
    RRCK A 0 A_custommissile("ClownSpark", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)
    RRCK A 0 A_custommissile("ClownSpark", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    RRCK A 1 A_CustomMissile("RevTrail", 0, 0, 0, CMF_AIMOFFSET|CMF_TRACKOWNER)  
    Loop
  Death:
    GLOB A 4 Bright 
    GLOB B 4 Bright A_Explode(12,96,0)
    GLOB B 2 Bright A_CustomMissile(HappyCloud, 16, 8, 135, CMF_AIMOFFSET|CMF_TRACKOWNER) 
    GLOB BBBBBBB 0 A_CustomMissile("Sparkles", 4,4, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    GLOB B 2 Bright A_CustomMissile(HappyCloud, 12, 0, 90, CMF_AIMOFFSET|CMF_TRACKOWNER) 
    GLOB B 2 Bright A_CustomMissile(HappyCloud, 16, -8, -135, CMF_AIMOFFSET|CMF_TRACKOWNER) 
    GLOB C 2 Bright A_CustomMissile(HappyCloud, 16, 0, -200, CMF_AIMOFFSET|CMF_TRACKOWNER) 
    GLOB CCCCCCC 0 A_CustomMissile("Sparkles", 4, 4, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    GLOB D 2 Bright A_CustomMissile(HappyCloud, 18, 0, 45, CMF_AIMOFFSET|CMF_TRACKOWNER) 
    GLOB E 2 Bright A_CustomMissile(HappyCloud, 16, 8, 300, CMF_AIMOFFSET|CMF_TRACKOWNER) 
    GLOB E 2 Bright A_CustomMissile(HappyCloud, 16, 0, 200, CMF_AIMOFFSET|CMF_TRACKOWNER)
    GLOB EEEEEEE 0 A_CustomMissile("Sparkles", 4, 4, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    GLOB F 2 Bright A_CustomMissile(HappyCloud, 22, -8, 315, CMF_AIMOFFSET|CMF_TRACKOWNER) 
    GLOB G 2 Bright A_CustomMissile(HappyCloud, 16, 0, 270, CMF_AIMOFFSET|CMF_TRACKOWNER) 
    GLOB G 2 Bright A_CustomMissile(HappyCloud, 12, 8, 180, CMF_AIMOFFSET|CMF_TRACKOWNER) 
    GLOB H 4 Bright 
    Stop
  }
}

ACTOR CrazyBall2New : CrazyBall2 replaces CrazyBall2 30205
{
  Weapon.SelectionOrder 3000
  Inventory.PickupSound "misc/w_pkup" 
  Weapon.AmmoType "CzBall" 
  Weapon.AmmoGive 1 
  Weapon.AmmoUse 1
  Inventory.Pickupmessage "You got a crazy ball, use it wisely..." 
  AttackSound "" 
  Scale 0.6
  +Floatbob
  States 
  { 
  User1:
    TNT1 A 0 
	{ 
	 if (CountInv("FloraInPlay",AAPTR_PLAYER1) <= 0) { return state("Ready"); }
	 return state(""); 
	}
	TNT1 A 0 
	{
	 ACS_NamedExecuteAlways("StartTensionCountDown");
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("KickAttackDEFLvl2",1); } else { A_GiveInventory("KickAttackDEFLvl1",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) >= 5) { A_GiveInventory("MartArtsMaster2",1); }
	 if (ACS_NamedExecuteWithResult("MiscVarCheckDECORATE",10035) == 4) { A_GiveInventory("MartArtsMaster1",1); }
	 if (random(1,256) > 64) { A_GiveInventory("KickCritBonus1",1,AAPTR_PLAYER1); } else { A_GiveInventory("KickCritBonus2",1,AAPTR_PLAYER1); }
	}
    FKIC A 1 Offset(48,46)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,42) { if (random(1,256) >= 128) { A_PlaySound("FloraKiaiFull",CHAN_VOICE); } }
    FKIC A 1 Offset(48,40)
    FKIC B 1 Offset(24,38)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,34) A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104)
    FKIC B 1 Offset(24,32) A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuffNoThrust",104)
    FKIC B 1 Offset(24,34) A_CustomPunch(ACS_NamedExecuteWithResult("GetKickDamage",0),1,0,"KickPuff",104)
    FKIC B 1 Offset(24,36)
    FKIC B 1 Offset(24,38)
    FKIC A 1 Offset(48,40)
    FKIC A 1 Offset(48,42)
    FKIC A 1 Offset(48,44)
    FKIC A 1 Offset(48,46)
	{
	 A_TakeInventory("KickCritBonus1",9999);
	 A_TakeInventory("KickCritBonus2",9999);
	 A_TakeInventory("KickAttackDEFLvl1",9999);
	 A_TakeInventory("KickAttackDEFLvl2",9999);
	 A_TakeInventory("MartArtsMaster1",9999);
	 A_TakeInventory("MartArtsMaster2",9999);
	}
    goto Ready

  Spawn: 
    CRZY A 0 A_Jump(240,2)
    CRZY A 0 A_PlaySound("CRZ") 
    CRZY AAAAAA 8
    CRZY BCDODCB 2 
    CRZY A 0 A_Jump(128,3)		//Randomize
    CRZY AAAAAA 8
    LOOP       
  Ready: 
    HCRZ S 1 A_WeaponReady(WRF_ALLOWUSER1) 
    LOOP 
  Deselect: 
    HCRZ S 0 A_Lower 
    HCRZ S 1 A_Lower 
    LOOP 
  Select: 
    HCRZ S 0 A_Raise 
    HCRZ S 1 A_Raise 
    LOOP 
  Fire:
    HCRZ S 1 A_JumpIfNoAmmo(5) 
    HCRZ T 0 
    HCRZ T 6
    HCRZ T 6
    TNT1 A 0 ACS_NamedExecuteAlways("StartTensionCountDown")
    TNT1 A 0 A_JumpIfInventory("SpreaderAura2", 0, "FireSpread7")
    TNT1 A 0 A_JumpIfInventory("SpreaderAura1", 0, "FireSpread3")
    goto FireNormal
  FireNormal:
    HCRZ U 0 A_FireCustomMissile("CrazyBallNew", 0, 1, 5, 5, 0, 0)
    goto FireEnd
  FireSpread3:
    HCRZ U 0 A_FireCustomMissile("CrazyBallNoHurt", 0+15, 0, 5, 5, 0, 0)
    HCRZ U 0 A_FireCustomMissile("CrazyBallNew",    0, 1, 5, 5, 0, 0)
    HCRZ U 0 A_FireCustomMissile("CrazyBallNoHurt", 0-15, 0, 5, 5, 0, 0)
    goto FireEnd
  FireSpread7:
    HCRZ U 0 A_FireCustomMissile("CrazyBallNoHurt",  0+15, 0, 5, 5, 0, 0)
    HCRZ U 0 A_FireCustomMissile("CrazyBallNoHurt", 0+7.5, 0, 5, 5, 0, 7.5)
    HCRZ U 0 A_FireCustomMissile("CrazyBallNoHurt", 0+7.5, 0, 5, 5, 0, -7.5)
    HCRZ U 0 A_FireCustomMissile("CrazyBallNew",     0, 1, 5, 5, 0, 0)
    HCRZ U 0 A_FireCustomMissile("CrazyBallNoHurt", 0-7.5, 0, 5, 5, 0, -7.5)
    HCRZ U 0 A_FireCustomMissile("CrazyBallNoHurt", 0-7.5, 0, 5, 5, 0, 7.5)
    HCRZ U 0 A_FireCustomMissile("CrazyBallNoHurt",  0-15, 0, 5, 5, 0, 0)
    goto FireEnd
  FireEnd:
    HCRZ U 10 
    Goto Select
  FireNoAmmo:
    HCRZ U 0
    GoTo Deselect
  } 
} 
Actor CrazyBallsNoHurt
{
  Radius 8
  Height 6
  Speed 3
  Damage 9
  scale 0.6
  PROJECTILE
  ALPHA 0.8
  SeeSound ""
  DeathSound ""
  States
  {
  Spawn:
    CRZY P 2 Bright ThrustThing( (angle*random(-256,256))/360, 4, 0, 0)
    CRZY Q 2 Bright ThrustThing( (angle*random(-256,256))/360, 4, 0, 0)
    CRZY R 2 Bright ThrustThing( (angle*random(-256,256))/360, 4, 0, 0)
    CRZY S 2 Bright ThrustThing( (angle*random(-256,256))/360, 4, 0, 0)
    CRZY P 2 Bright ThrustThing( (angle*random(-256,256))/360, 4, 0, 0)
    CRZY Q 2 Bright ThrustThing( (angle*random(-256,-128))/360, 4, 0, 0)
    CRZY R 2 Bright ThrustThing( (angle*random(-256,-128))/360, 4, 0, 0)
    CRZY S 2 Bright ThrustThing( (angle*random(-256,256))/360, 4, 0, 0)
    CRZY Q 2 Bright ThrustThing( (angle*random(-256,256))/360, 4, 0, 0)
    CRZY P 2 Bright ThrustThing( (angle*random(-256,256))/360, 4, 0, 0)
    CRZY S 2 Bright ThrustThing( (angle*random(128,256))/360, 4, 0, 0)
    CRZY R 2 Bright ThrustThing( (angle*random(128,256))/360, 4, 0, 0)
    CRZY Q 2 Bright ThrustThing( (angle*random(-256,256))/360, 4, 0, 0)
    CRZY S 2 Bright ThrustThing( (angle*random(-256,256))/360, 4, 0, 0)
    CRZY R 2 Bright ThrustThing( (angle*random(-256,256))/360, 4, 0, 0)
    Goto Spawn
  Death:
    GLOB B 3 Bright 
    GLOB A 3 Bright A_Scream
    GLOB H 3 Bright A_Fall
    Stop
  }
}
actor CrazyBallNoHurt
{
  Radius 8
  Height 16
  Speed 40
  Damage 2
  Scale .6
  +ACTIVATEIMPACT
  +ACTIVATEPCROSS
  +DROPOFF
  +MISSILE
  +NOTELEPORT
  DropItem BloodSplashBase
  DropItem Blood
  DropItem Blood
  SeeSound ""
  DeathSound ""
  ExplosionRadius 128
  ExplosionDamage 64
  States
  {
  Spawn:
    CRZY A 3
    loop
  Death:
    CRZY AAAA 20 A_PlaySound("CRZCLIK3") 
    CRZY BCD 8
    CRZY D 0 A_Explode(64,128,0)
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 70))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY O 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 70))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY O 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY O 0 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_PlaySound("CRZ") 
    CRZY D 0 A_Jump(1, 2)
    GoTo Death + 7
    CRZY D 0 A_Explode(64,128,0)
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 70))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 70))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_Explode(64,128,0)
    CRZY O 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 70))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 70))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_PlaySound("CRZ") 
    CRZY D 0 A_Explode(64,128,0)
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 70))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 2 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 70))
    CRZY D 2 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 2 A_PlaySound("CRZ") 
    CRZY D 0 A_Explode(64,128,0)
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 70))
    CRZY D 0 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 2 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY O 2 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY O 1 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY O 2 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 70))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 2 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 2 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 2 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_Explode(64,128,0)
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 2 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 2 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY O 2 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY O 2 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY O 2 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY O 1 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 2 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 2 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY O 1 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_Jump(32, 2)
    GoTo Death + 80
    CRZY D 0 A_PlaySound("CRZ") 
    CRZY D 0 A_Explode(64,128,0)
    CRZY D 2 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY O 2 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 2 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 2 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY O 3 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY O 2 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY O 4 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY O 2 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY O 2 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 2 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))	    
    CRZY O 5 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 2 A_custommissile("CrazyBallsNoHurt", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY O 3 A_custommissile("CrazyBallsNoHurt", 14, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 3 A_custommissile("CrazyBallsNoHurt", 6, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY O 4 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 2 A_custommissile("CrazyBallsNoHurt", 10, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY O 0 A_PlaySound("CRZ") 
    CRZY D 4 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY O 1 A_custommissile("CrazyBallsNoHurt", 10, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 4 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY O 1 A_custommissile("CrazyBallsNoHurt", 10, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY O 4 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 2 A_custommissile("CrazyBallsNoHurt", 10, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 4 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 2 A_custommissile("CrazyBallsNoHurt", 10, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 4 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 3 A_custommissile("CrazyBallsNoHurt", 10, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 4 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY O 5 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 4 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 5 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 6 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 7 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 8 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 9 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 10 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 11 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 12 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 14 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 17 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 20 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 25 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY D 30 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 35 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY DD 15 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-10, 180))
    CRZY DD 15 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY DDD 15 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY DDDD 15 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY DDDDD 15 A_custommissile("CrazyBallsNoHurt", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 20 A_PlaySound("CRZ6")
    CRZY D 20 A_Explode(64,128,0)
    CRZY C 0 A_PlaySound("CRZCLIK3") 
    CRZY CBBBB 20
    CRZY B 20 A_PlaySound("CRZCLIK3") 
    CRZY B 20
    PBFF B 3 Bright
    CRZY D 0 A_custommissile("CrazyFlash", 12,-2,0,2,0)
    CRZY DDDDDDDDDD 0 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(-180, 180))
    CRZY DD 0 A_custommissile("Popcorn_Shrap1", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY DDDDDDDDDDDDDDDDDDDDDDDDDDDDD 0 A_custommissile("Popcorn_Shrap7", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    PBFF D 0 A_PlaySound("TRANEXP")
    PBFF D 0 
    CRZY D 0 A_custommissile("CrazyBits1", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBits2", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    PBFF C 3 Bright A_custommissile("CrazyFlash", 4,2,0,2,0)
    CRZY CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC 0 A_custommissile("Popcorn_Shrap7", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBits3", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBits4", 12, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    PBFF D 3 Bright A_custommissile("CrazyFlash", 16,-4,0,2,0)
    CRZY DDDDDDDDDDDDDDDDDDDDDDDDDDDDDD 0 A_custommissile("Popcorn_Shrap7", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBits5", 11, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBits6", 11, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    PBFF E 3 Bright A_custommissile("CrazyFlash", 8,4,0,2,0)
    CRZY EEEEEEEEEEEEEEEEEEEEEEE 0 A_custommissile("Popcorn_Shrap7", 2, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBits7", 9, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBits8", 9, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBits9", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBits10", 8, 0, random(-180, 180), CMF_AIMDIRECTION|CMF_TRACKOWNER, random(0, 180))
    PBFF F 3 Bright 
    Stop
  }
}

actor CrazyBallNew
{
  Radius 8
  Height 16
  Speed 40
  Damage 2
  Scale .6
  +ACTIVATEIMPACT
  +ACTIVATEPCROSS
  +MISSILE
  +DROPOFF
  +NOTELEPORT
  DropItem BloodSplashBase
  DropItem Blood
  DropItem Blood
  SeeSound ""
  DeathSound ""
  ExplosionRadius 128
  ExplosionDamage 64
  States
  {
  Spawn:
    CRZY A 3
    loop
  Death:
    CRZY AAAA 20 A_PlaySound("CRZCLIK3") 
    CRZY BCD 8
    CRZY D 0 A_Explode
    CRZY D 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 70))
    CRZY D 0 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(-10, 180))
    CRZY O 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(-10, 70))
    CRZY D 0 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(0, 180))
    CRZY O 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(-10, 180))
    CRZY O 0 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_PlaySound("CRZ") 
    CRZY D 0 A_Jump(1, 2)
    GoTo Death + 7
    CRZY D 0 A_Explode
    CRZY D 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 70))
    CRZY D 0 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(-10, 70))
    CRZY D 0 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_Explode
    CRZY O 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 70))
    CRZY D 0 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(-10, 70))
    CRZY D 1 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_PlaySound("CRZ") 
    CRZY D 0 A_Explode
    CRZY D 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 70))
    CRZY D 0 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 2 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(-10, 70))
    CRZY D 2 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 2 A_PlaySound("CRZ") 
    CRZY D 0 A_Explode
    CRZY D 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 70))
    CRZY D 0 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 2 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY O 2 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(0, 180))
    CRZY O 1 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY O 2 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(-10, 70))
    CRZY D 1 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 2 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 2 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 2 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_Explode
    CRZY D 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 2 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 2 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY O 2 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(-10, 180))
    CRZY O 2 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY O 2 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(0, 180))
    CRZY O 1 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 2 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 2 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY O 1 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_Jump(32, 2)
    GoTo Death + 80
    CRZY D 0 A_PlaySound("CRZ") 
    CRZY D 0 A_Explode
    CRZY D 2 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(-10, 180))
    CRZY O 2 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 2 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 2 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(0, 180))
    CRZY O 3 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY O 2 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 1 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(-10, 180))
    CRZY O 4 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY O 2 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(0, 180))
    CRZY O 2 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 2 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(0, 180))	    
    CRZY O 5 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 2 A_custommissile("CrazyBalls", 12, 0, random(-180, 180), 2, random(-10, 180))
    CRZY O 3 A_custommissile("CrazyBalls", 14, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 3 A_custommissile("CrazyBalls", 6, 0, random(-180, 180), 2, random(-10, 180))
    CRZY O 4 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 2 A_custommissile("CrazyBalls", 10, 0, random(-180, 180), 2, random(0, 180))
    CRZY O 0 A_PlaySound("CRZ") 
    CRZY D 4 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY O 1 A_custommissile("CrazyBalls", 10, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 4 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(-10, 180))
    CRZY O 1 A_custommissile("CrazyBalls", 10, 0, random(-180, 180), 2, random(-10, 180))
    CRZY O 4 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 2 A_custommissile("CrazyBalls", 10, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 4 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 2 A_custommissile("CrazyBalls", 10, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 4 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 3 A_custommissile("CrazyBalls", 10, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 4 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(-10, 180))
    CRZY O 5 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 4 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 5 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 6 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 7 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 8 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 9 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 10 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 11 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 12 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 14 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 17 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 20 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 25 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(-10, 180))
    CRZY D 30 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 35 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY DD 15 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(-10, 180))
    CRZY DD 15 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY DDD 15 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY DDDD 15 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY DDDDD 15 A_custommissile("CrazyBalls", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 20 A_PlaySound("CRZ6")
    CRZY D 20 A_Explode
    CRZY C 0 A_PlaySound("CRZCLIK3") 
    CRZY CBBBB 20
    CRZY B 20 A_PlaySound("CRZCLIK3") 
    CRZY B 20
    PBFF B 3 Bright
    CRZY D 0 A_custommissile("CrazyFlash", 12,-2,0,2,0)
    CRZY DDDDDDDDDD 0 A_CustomMissile("Sparkles", 8, 0, random(-180, 180), 2, random(-180, 180))
    CRZY DD 0 A_custommissile("Popcorn_Shrap1", 2, 0, random(-180, 180), 2, random(0, 180))
    CRZY DDDDDDDDDDDDDDDDDDDDDDDDDDDDD 0 A_custommissile("Popcorn_Shrap7", 2, 0, random(-180, 180), 2, random(0, 180))
    PBFF D 0 A_PlaySound("TRANEXP")
    PBFF D 0 
    CRZY D 0 A_custommissile("CrazyBits1", 12, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBits2", 12, 0, random(-180, 180), 2, random(0, 180))
    PBFF C 3 Bright A_custommissile("CrazyFlash", 4,2,0,2,0)
    CRZY CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC 0 A_custommissile("Popcorn_Shrap7", 2, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBits3", 12, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBits4", 12, 0, random(-180, 180), 2, random(0, 180))
    PBFF D 3 Bright A_custommissile("CrazyFlash", 16,-4,0,2,0)
    CRZY DDDDDDDDDDDDDDDDDDDDDDDDDDDDDD 0 A_custommissile("Popcorn_Shrap7", 2, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBits5", 11, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBits6", 11, 0, random(-180, 180), 2, random(0, 180))
    PBFF E 3 Bright A_custommissile("CrazyFlash", 8,4,0,2,0)
    CRZY EEEEEEEEEEEEEEEEEEEEEEE 0 A_custommissile("Popcorn_Shrap7", 2, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBits7", 9, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBits8", 9, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBits9", 8, 0, random(-180, 180), 2, random(0, 180))
    CRZY D 0 A_custommissile("CrazyBits10", 8, 0, random(-180, 180), 2, random(0, 180))
    PBFF F 3 Bright 
    Stop
  }
}
